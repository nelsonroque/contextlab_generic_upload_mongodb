var t,e,i;!function(t){t.Sequence="Sequence",t.Group="Group",t.Wait="Wait",t.Custom="Custom",t.Move="Move",t.Scale="Scale"}(t||(t={}));class n{}n.none=(t,e,i,n)=>i+e,n.linear=(t,e,i,n)=>i*t/n+e,n.quadraticIn=(t,e,i,n)=>i*(t/=n)*t+e,n.quadraticOut=(t,e,i,n)=>-i*(t/=n)*(t-2)+e,n.quadraticInOut=(t,e,i,n)=>(t/=n/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e,n.cubicIn=(t,e,i,n)=>i*(t/=n)*t*t+e,n.cubicOut=(t,e,i,n)=>(t/=n,i*(--t*t*t+1)+e),n.cubicInOut=(t,e,i,n)=>(t/=n/2)<1?i/2*t*t*t+e:i/2*((t-=2)*t*t+2)+e,n.quarticIn=(t,e,i,n)=>i*(t/=n)*t*t*t+e,n.quarticOut=(t,e,i,n)=>(t/=n,-i*(--t*t*t*t-1)+e),n.quarticInOut=(t,e,i,n)=>(t/=n/2)<1?i/2*t*t*t*t+e:-i/2*((t-=2)*t*t*t-2)+e,n.quinticIn=(t,e,i,n)=>i*(t/=n)*t*t*t*t+e,n.quinticOut=(t,e,i,n)=>(t/=n,i*(--t*t*t*t*t+1)+e),n.quinticInOut=(t,e,i,n)=>(t/=n/2)<1?i/2*t*t*t*t*t+e:i/2*((t-=2)*t*t*t*t+2)+e,n.sinusoidalIn=(t,e,i,n)=>-i*Math.cos(t/n*(Math.PI/2))+i+e,n.sinusoidalOut=(t,e,i,n)=>i*Math.sin(t/n*(Math.PI/2))+e,n.sinusoidalInOut=(t,e,i,n)=>-i/2*(Math.cos(Math.PI*t/n)-1)+e,n.exponentialIn=(t,e,i,n)=>i*Math.pow(2,10*(t/n-1))+e,n.exponentialOut=(t,e,i,n)=>i*(1-Math.pow(2,-10*t/n))+e,n.exponentialInOut=(t,e,i,n)=>(t/=n/2)<1?i/2*Math.pow(2,10*(t-1))+e:(t--,i/2*(2-Math.pow(2,-10*t))+e),n.circularIn=(t,e,i,n)=>(t/=n,-i*(Math.sqrt(1-t*t)-1)+e),n.circularOut=(t,e,i,n)=>(t/=n,t--,i*Math.sqrt(1-t*t)+e),n.circularInOut=(t,e,i,n)=>(t/=n/2)<1?-i/2*(Math.sqrt(1-t*t)-1)+e:(t-=2,i/2*(Math.sqrt(1-t*t)+1)+e);class r{constructor(t=!1){this.startOffset=-1,this.endOffset=-1,this.started=!1,this.running=!1,this.completed=!1,this.runStartTime=-1,this.duration=0,this.isParent=!1,this.isChild=!1,this.runDuringTransition=t}static move(t){var e,i;return new c(t.point,t.duration,null!==(e=t.easing)&&void 0!==e?e:n.linear,null!==(i=t.runDuringTransition)&&void 0!==i&&i)}static wait(t){var e;return new l(t.duration,null!==(e=t.runDuringTransition)&&void 0!==e&&e)}static custom(t){var e;return new s(t.callback,null!==(e=t.runDuringTransition)&&void 0!==e&&e)}static scale(t){return new h(t.scale,t.duration,t.runDuringTransition)}static sequence(t){const e=new a(t);return e.children=t,e}static group(t){const e=new o(t);return e.children=t,e}initialize(e,i){this.assignParents(this,this,i);const n=this.flattenActions(this);return n.forEach((t=>t.duration=this.calculateDuration(t))),this.calculateStartEndOffsets(this),n.filter((e=>e.type!==t.Group&&e.type!==t.Sequence)).map((t=>r.cloneAction(t,i)))}static cloneAction(e,i){let n;switch(e.type){case t.Sequence:{const t=e.children.map((t=>r.cloneAction(t,i)));n=r.sequence(t);break}case t.Group:{const t=e.children.map((t=>r.cloneAction(t,i)));n=r.sequence(t);break}case t.Move:{const t=e;n=r.move({point:t.point,duration:t.duration,easing:t.easing,runDuringTransition:t.runDuringTransition});break}case t.Custom:{const t=e;n=r.custom({callback:t.callback,runDuringTransition:t.runDuringTransition});break}case t.Scale:{const t=e;n=r.scale({scale:t.scale,duration:t.duration,runDuringTransition:t.runDuringTransition});break}case t.Wait:{const t=e;n=r.wait({duration:t.duration,runDuringTransition:t.runDuringTransition});break}default:throw new Error("unknown action")}return void 0!==i&&(n.key=i),n.startOffset=e.startOffset,n.endOffset=e.endOffset,n}static evaluateAction(e,i,n,r){if(n<e.runStartTime+e.startOffset)return;if(n>=e.runStartTime+e.startOffset&&n<=e.runStartTime+e.startOffset+e.duration?e.running=!0:e.running=!1,!1===e.running&&!0===e.completed)return;const a=n-(e.runStartTime+e.startOffset);if(e.type===t.Custom){const t=e;t.callback(),t.running=!1,t.completed=!0}if(e.type===t.Wait){const t=e;n>e.runStartTime+e.startOffset+e.duration&&(t.running=!1,t.completed=!0)}if(e.type===t.Move){const t=e;t.started||(t.dx=t.point.x-i.position.x,t.dy=t.point.y-i.position.y,t.startPoint.x=i.position.x,t.startPoint.y=i.position.y,t.started=!0),a<t.duration?(i.position.x=t.easing(a,t.startPoint.x,t.dx,t.duration),i.position.y=t.easing(a,t.startPoint.y,t.dy,t.duration)):(i.position.x=t.point.x,i.position.y=t.point.y,t.running=!1,t.completed=!0)}if(e.type===t.Scale){const t=e;t.started||(t.delta=t.scale-i.scale,t.started=!0),a<t.duration?i.scale=i.scale+t.delta*(r/t.duration):(i.scale=t.scale,t.running=!1,t.completed=!0)}}calculateDuration(e){return e.type===t.Group?e.children.map((t=>this.calculateDuration(t))).reduce(((t,e)=>Math.max(t,e)),0):e.type===t.Sequence?e.children.map((t=>this.calculateDuration(t))).reduce(((t,e)=>t+e),0):e.duration}calculateStartEndOffsets(e){var i,n,r;let a;if(a=void 0===e.parent?0:e.parent.startOffset,(null===(i=e.parent)||void 0===i?void 0:i.type)===t.Group)e.startOffset=a,e.endOffset=e.startOffset+e.duration;else if((null===(n=e.parent)||void 0===n?void 0:n.type)===t.Sequence){const t=e.parent;let i=0;for(const n of t.children){if(n===e)break;i+=n.duration}e.startOffset=a+i,e.endOffset=e.startOffset+e.duration}else e.startOffset=0,e.endOffset=e.startOffset+e.duration;e.isParent&&(null===(r=e.children)||void 0===r||r.forEach((t=>this.calculateStartEndOffsets(t))))}flattenActions(t,e){if(e||(e=new Array).push(t),t.isParent){const i=t,n=i.children;e.push(...n),i.children.filter((t=>t.isParent)).forEach((t=>this.flattenActions(t,e)))}return e}assignParents(t,e,i){if(void 0!==i&&(t.key=i),t.isParent){const n=t;n.children.forEach((e=>{e.parent=t,e.isChild=!0})),n.children.filter((t=>t.isParent)).forEach((t=>this.assignParents(t,e,i)))}}}class a extends r{constructor(e){super(),this.type=t.Sequence,this.children=e,this.isParent=!0}}class o extends r{constructor(e){super(),this.type=t.Group,this.children=new Array,this.children=e,this.isParent=!0}}class s extends r{constructor(e,i=!1){super(i),this.type=t.Custom,this.callback=e,this.isParent=!1,this.duration=0}}class l extends r{constructor(e,i){super(i),this.type=t.Wait,this.duration=e,this.isParent=!1}}class c extends r{constructor(e,i,n,r){super(r),this.type=t.Move,this.dx=0,this.dy=0,this.duration=i,this.point=e,this.isParent=!1,this.startPoint={x:NaN,y:NaN},this.easing=n}}class h extends r{constructor(e,i,n=!1){super(n),this.type=t.Scale,this.delta=0,this.duration=i,this.scale=e,this.isParent=!1}}function u(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i}!function(t){t.Game="Game",t.Survey="Survey"}(e||(e={}));class d{static Dispose(t){t.filter((t=>!(null==t?void 0:t.isDeleted))).forEach((t=>null==t?void 0:t.delete()))}}!function(t){t.SessionInitialize="SessionInitialize",t.SessionStart="SessionStart",t.SessionEnd="SessionEnd",t.ActivityStart="ActivityStart",t.ActivityEnd="ActivityEnd",t.ActivityCancel="ActivityCancel",t.ActivityData="ActivityData",t.TapDown="TapDown",t.TapUp="TapUp",t.TapUpAny="TapUpAny",t.TapLeave="TapLeave",t.PointerDown="PointerDown",t.PointerUp="PointerUp",t.PointerMove="PointerMove",t.CompositeCustom="CompositeCustom"}(i||(i={}));window.globalThis||(console.log("shimming globalThis"),window.globalThis=window),globalThis.Globals=new class{constructor(){this.now=NaN,this.deltaTime=NaN,this.canvasScale=NaN,this.rootScale=1,this.canvasCssWidth=NaN,this.canvasCssHeight=NaN}};class f{constructor(t,e,i,n){this.name=t,this.image=e,this.width=i,this.height=n}}var p="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function m(t){var e=t.default;if("function"==typeof e){var i=function(){return e.apply(this,arguments)};i.prototype=e.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(t).forEach((function(e){var n=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(i,e,n.get?n:{enumerable:!0,get:function(){return t[e]}})})),i}var g,y,v,b,w,S={exports:{}},_=m(Object.freeze({__proto__:null,path_empty_shim:function(){}})),C=m(Object.freeze({__proto__:null,fs_empty_shim:function(){}}));!function(t,e){var i,n=(i="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,"undefined"!=typeof __filename&&(i=i||__filename),function(t){var e,n,r,a;t=t||{},e||(e=void 0!==t?t:{}),e.ready=new Promise((function(t,e){n=t,r=e})),(a=e).Sd=a.Sd||[],a.Sd.push((function(){a.MakeSWCanvasSurface=function(t){var e=t;if("CANVAS"!==e.tagName&&!(e=document.getElementById(t)))throw"Canvas with id "+t+" was not found";return(t=a.MakeSurface(e.width,e.height))&&(t.Od=e),t},a.MakeCanvasSurface||(a.MakeCanvasSurface=a.MakeSWCanvasSurface),a.MakeSurface=function(t,e){var i={width:t,height:e,colorType:a.ColorType.RGBA_8888,alphaType:a.AlphaType.Unpremul,colorSpace:a.ColorSpace.SRGB},n=t*e*4,r=a._malloc(n);return(i=a.Surface._makeRasterDirect(i,r,4*t))&&(i.Od=null,i.Ff=t,i.Bf=e,i.Df=n,i.af=r,i.getCanvas().clear(a.TRANSPARENT)),i},a.MakeRasterDirectSurface=function(t,e,i){return a.Surface._makeRasterDirect(t,e.byteOffset,i)},a.Surface.prototype.flush=function(t){if(a.Pd(this.Nd),this._flush(),this.Od){var e=new Uint8ClampedArray(a.HEAPU8.buffer,this.af,this.Df);e=new ImageData(e,this.Ff,this.Bf),t?this.Od.getContext("2d").putImageData(e,0,0,t[0],t[1],t[2]-t[0],t[3]-t[1]):this.Od.getContext("2d").putImageData(e,0,0)}},a.Surface.prototype.dispose=function(){this.af&&a._free(this.af),this.delete()},a.Pd=a.Pd||function(){},a.ef=a.ef||function(){return null}})),function(t){t.Sd=t.Sd||[],t.Sd.push((function(){function e(t,e,i){return t&&t.hasOwnProperty(e)?t[e]:i}function i(t){var e=Be(Te);return Te[e]=t,e}function n(t){return t.naturalHeight||t.videoHeight||t.displayHeight||t.height}function r(t){return t.naturalWidth||t.videoWidth||t.displayWidth||t.width}function a(e,i,n,r){return e.bindTexture(e.TEXTURE_2D,i),r||n.alphaType!==t.AlphaType.Premul||e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),i}function o(e,i,n){n||i.alphaType!==t.AlphaType.Premul||e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.bindTexture(e.TEXTURE_2D,null)}t.GetWebGLContext=function(t,i){if(!t)throw"null canvas passed into makeWebGLContext";var n={alpha:e(i,"alpha",1),depth:e(i,"depth",1),stencil:e(i,"stencil",8),antialias:e(i,"antialias",0),premultipliedAlpha:e(i,"premultipliedAlpha",1),preserveDrawingBuffer:e(i,"preserveDrawingBuffer",0),preferLowPowerToHighPerformance:e(i,"preferLowPowerToHighPerformance",0),failIfMajorPerformanceCaveat:e(i,"failIfMajorPerformanceCaveat",0),enableExtensionsByDefault:e(i,"enableExtensionsByDefault",1),explicitSwapControl:e(i,"explicitSwapControl",0),renderViaOffscreenBackBuffer:e(i,"renderViaOffscreenBackBuffer",0)};if(n.majorVersion=i&&i.majorVersion?i.majorVersion:"undefined"!=typeof WebGL2RenderingContext?2:1,n.explicitSwapControl)throw"explicitSwapControl is not supported";return t=function(t,e){t.mf||(t.mf=t.getContext,t.getContext=function(e,i){return"webgl"==e==(i=t.mf(e,i))instanceof WebGLRenderingContext?i:null});var i=1<e.majorVersion?t.getContext("webgl2",e):t.getContext("webgl",e);return i?function(t,e){var i=Be(ke),n={Vf:i,attributes:e,version:e.majorVersion,he:t};return t.canvas&&(t.canvas.zf=n),ke[i]=n,(void 0===e.Lf||e.Lf)&&function(t){if(t||(t=Le),!t.Xf){t.Xf=!0;var e=t.he;!function(t){var e=t.getExtension("ANGLE_instanced_arrays");e&&(t.vertexAttribDivisor=function(t,i){e.vertexAttribDivisorANGLE(t,i)},t.drawArraysInstanced=function(t,i,n,r){e.drawArraysInstancedANGLE(t,i,n,r)},t.drawElementsInstanced=function(t,i,n,r,a){e.drawElementsInstancedANGLE(t,i,n,r,a)})}(e),function(t){var e=t.getExtension("OES_vertex_array_object");e&&(t.createVertexArray=function(){return e.createVertexArrayOES()},t.deleteVertexArray=function(t){e.deleteVertexArrayOES(t)},t.bindVertexArray=function(t){e.bindVertexArrayOES(t)},t.isVertexArray=function(t){return e.isVertexArrayOES(t)})}(e),function(t){var e=t.getExtension("WEBGL_draw_buffers");e&&(t.drawBuffers=function(t,i){e.drawBuffersWEBGL(t,i)})}(e),e.rf=e.getExtension("WEBGL_draw_instanced_base_vertex_base_instance"),e.vf=e.getExtension("WEBGL_multi_draw_instanced_base_vertex_base_instance"),2<=t.version&&(e.sf=e.getExtension("EXT_disjoint_timer_query_webgl2")),(2>t.version||!e.sf)&&(e.sf=e.getExtension("EXT_disjoint_timer_query")),e.tg=e.getExtension("WEBGL_multi_draw"),(e.getSupportedExtensions()||[]).forEach((function(t){t.includes("lose_context")||t.includes("debug")||e.getExtension(t)}))}}(n),i}(i,e):0}(t,n),t?(De(t),Le.he.getExtension("WEBGL_debug_renderer_info"),t):0},t.deleteContext=function(t){Le===ke[t]&&(Le=null),"object"==typeof JSEvents&&JSEvents.vg(ke[t].he.canvas),ke[t]&&ke[t].he.canvas&&(ke[t].he.canvas.zf=void 0),ke[t]=null},t._setTextureCleanup({deleteTexture:function(t,e){var i=Te[e];i&&ke[t].he.deleteTexture(i),Te[e]=null}}),t.MakeWebGLContext=function(t){if(!this.Pd(t))return null;var e=this._MakeGrContext();return e?(e.Nd=t,Le.ff=e):null},t.MakeGrContext=t.MakeWebGLContext,t.MakeOnScreenGLSurface=function(t,e,i,n){return this.Pd(t.Nd)&&(e=this._MakeOnScreenGLSurface(t,e,i,n))?(e.Nd=t.Nd,e):null},t.MakeRenderTarget=function(){var t=arguments[0];if(!this.Pd(t.Nd))return null;if(3===arguments.length){var e=this._MakeRenderTargetWH(t,arguments[1],arguments[2]);if(!e)return null}else{if(2!==arguments.length)return null;if(!(e=this._MakeRenderTargetII(t,arguments[1])))return null}return e.Nd=t.Nd,e},t.MakeWebGLCanvasSurface=function(e,i,n){i=i||null;var r=e,a="undefined"!=typeof OffscreenCanvas&&r instanceof OffscreenCanvas;if(!("undefined"!=typeof HTMLCanvasElement&&r instanceof HTMLCanvasElement||a||(r=document.getElementById(e),r)))throw"Canvas with id "+e+" was not found";if(!(e=this.GetWebGLContext(r,n))||0>e)throw"failed to create webgl context: err "+e;return e=this.MakeWebGLContext(e),(i=this.MakeOnScreenGLSurface(e,r.width,r.height,i))||(i=r.cloneNode(!0),r.parentNode.replaceChild(i,r),i.classList.add("ck-replaced"),t.MakeSWCanvasSurface(i))},t.MakeCanvasSurface=t.MakeWebGLCanvasSurface,t.Surface.prototype.makeImageFromTexture=function(e,n){return t.Pd(this.Nd),e=i(e),(n=this._makeImageFromTexture(this.Nd,e,n))&&(n.Me=e),n},t.Surface.prototype.makeImageFromTextureSource=function(e,i,s){i||(i={height:n(e),width:r(e),colorType:t.ColorType.RGBA_8888,alphaType:s?t.AlphaType.Premul:t.AlphaType.Unpremul}),i.colorSpace||(i.colorSpace=t.ColorSpace.SRGB),t.Pd(this.Nd);var l=Le.he;return s=a(l,l.createTexture(),i,s),2===Le.version?l.texImage2D(l.TEXTURE_2D,0,l.RGBA,i.width,i.height,0,l.RGBA,l.UNSIGNED_BYTE,e):l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,e),o(l,i),this.makeImageFromTexture(s,i)},t.Surface.prototype.updateTextureFromSource=function(e,s,l){if(e.Me){t.Pd(this.Nd);var c=e.getImageInfo(),h=Le.he,u=a(h,Te[e.Me],c,l);2===Le.version?h.texImage2D(h.TEXTURE_2D,0,h.RGBA,r(s),n(s),0,h.RGBA,h.UNSIGNED_BYTE,s):h.texImage2D(h.TEXTURE_2D,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,s),o(h,c,l),this._resetContext(),Te[e.Me]=null,e.Me=i(u),c.colorSpace=e.getColorSpace(),s=this._makeImageFromTexture(this.Nd,e.Me,c),l=e.Md.Vd,h=e.Md.ae,e.Md.Vd=s.Md.Vd,e.Md.ae=s.Md.ae,s.Md.Vd=l,s.Md.ae=h,s.delete(),c.colorSpace.delete()}},t.MakeLazyImageFromTextureSource=function(e,s,l){s||(s={height:n(e),width:r(e),colorType:t.ColorType.RGBA_8888,alphaType:l?t.AlphaType.Premul:t.AlphaType.Unpremul}),s.colorSpace||(s.colorSpace=t.ColorSpace.SRGB);var c={makeTexture:function(){var t=Le,n=t.he,r=a(n,n.createTexture(),s,l);return 2===t.version?n.texImage2D(n.TEXTURE_2D,0,n.RGBA,s.width,s.height,0,n.RGBA,n.UNSIGNED_BYTE,e):n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,e),o(n,s,l),i(r)},freeSrc:function(){}};return"VideoFrame"===e.constructor.name&&(c.freeSrc=function(){e.close()}),t.Image._makeFromGenerator(s,c)},t.Pd=function(t){return!!t&&De(t)},t.ef=function(){return Le&&Le.ff&&!Le.ff.isDeleted()?Le.ff:null}}))}(e),function(t){function i(t,e,i,n,r){for(var a=0;a<t.length;a++)e[a*i+(a*r+n+i)%i]=t[a];return e}function n(t){for(var e=t*t,i=Array(e);e--;)i[e]=0==e%(t+1)?1:0;return i}function r(t){return!!t&&t.constructor===Float32Array&&4===t.length}function a(t){return(l(255*t[3])<<24|l(255*t[0])<<16|l(255*t[1])<<8|l(255*t[2])<<0)>>>0}function o(t){if(t&&t._ck)return t;if(t instanceof Float32Array){for(var e=Math.floor(t.length/4),i=new Uint32Array(e),n=0;n<e;n++)i[n]=a(t.slice(4*n,4*(n+1)));return i}return t instanceof Uint32Array?t:t instanceof Array&&t[0]instanceof Float32Array?t.map(a):void 0}function s(t){if(void 0===t)return 1;var e=parseFloat(t);return t&&-1!==t.indexOf("%")?e/100:e}function l(t){return Math.round(Math.max(0,Math.min(t||0,255)))}function c(e,i){i&&i._ck||t._free(e)}function h(e,i,n){if(!e||!e.length)return $;if(e&&e._ck)return e.byteOffset;var r=t[i].BYTES_PER_ELEMENT;return n||(n=t._malloc(e.length*r)),t[i].set(e,n/r),n}function u(e){var i={de:$,count:e.length,colorType:t.ColorType.RGBA_F32};if(e instanceof Float32Array)i.de=h(e,"HEAPF32"),i.count=e.length/4;else if(e instanceof Uint32Array)i.de=h(e,"HEAPU32"),i.colorType=t.ColorType.RGBA_8888;else{if(!(e instanceof Array))throw"Invalid argument to copyFlexibleColorArray, Not a color array "+typeof e;if(e&&e.length){for(var n=t._malloc(16*e.length),r=0,a=n/4,o=0;o<e.length;o++)for(var s=0;4>s;s++)t.HEAPF32[a+r]=e[o][s],r++;e=n}else e=$;i.de=e}return i}function d(e){if(!e)return $;var i=S.toTypedArray();if(e.length){if(6===e.length||9===e.length)return h(e,"HEAPF32",F),6===e.length&&t.HEAPF32.set(H,6+F/4),F;if(16===e.length)return i[0]=e[0],i[1]=e[1],i[2]=e[3],i[3]=e[4],i[4]=e[5],i[5]=e[7],i[6]=e[12],i[7]=e[13],i[8]=e[15],F;throw"invalid matrix size"}if(void 0===e.m11)throw"invalid matrix argument";return i[0]=e.m11,i[1]=e.m21,i[2]=e.m41,i[3]=e.m12,i[4]=e.m22,i[5]=e.m42,i[6]=e.m14,i[7]=e.m24,i[8]=e.m44,F}function f(t,e){return h(t,"HEAPF32",e||B)}function p(t,e,i,n){var r=C.toTypedArray();return r[0]=t,r[1]=e,r[2]=i,r[3]=n,B}function m(e){for(var i=new Float32Array(4),n=0;4>n;n++)i[n]=t.HEAPF32[e/4+n];return i}function g(t,e){return h(t,"HEAPF32",e||L)}function y(t,e){return h(t,"HEAPF32",e||z)}function v(){for(var t=0,e=0;e<arguments.length-1;e+=2)t+=arguments[e]*arguments[e+1];return t}function b(t,e,i){for(var n=Array(t.length),r=0;r<i;r++)for(var a=0;a<i;a++){for(var o=0,s=0;s<i;s++)o+=t[i*r+s]*e[i*s+a];n[r*i+a]=o}return n}function w(t,e){for(var i=b(e[0],e[1],t),n=2;n<e.length;)i=b(i,e[n],t),n++;return i}t.Color=function(e,i,n,r){return void 0===r&&(r=1),t.Color4f(l(e)/255,l(i)/255,l(n)/255,r)},t.ColorAsInt=function(t,e,i,n){return void 0===n&&(n=255),(l(n)<<24|l(t)<<16|l(e)<<8|l(i)<<0&268435455)>>>0},t.Color4f=function(t,e,i,n){return void 0===n&&(n=1),Float32Array.of(t,e,i,n)},Object.defineProperty(t,"TRANSPARENT",{get:function(){return t.Color4f(0,0,0,0)}}),Object.defineProperty(t,"BLACK",{get:function(){return t.Color4f(0,0,0,1)}}),Object.defineProperty(t,"WHITE",{get:function(){return t.Color4f(1,1,1,1)}}),Object.defineProperty(t,"RED",{get:function(){return t.Color4f(1,0,0,1)}}),Object.defineProperty(t,"GREEN",{get:function(){return t.Color4f(0,1,0,1)}}),Object.defineProperty(t,"BLUE",{get:function(){return t.Color4f(0,0,1,1)}}),Object.defineProperty(t,"YELLOW",{get:function(){return t.Color4f(1,1,0,1)}}),Object.defineProperty(t,"CYAN",{get:function(){return t.Color4f(0,1,1,1)}}),Object.defineProperty(t,"MAGENTA",{get:function(){return t.Color4f(1,0,1,1)}}),t.getColorComponents=function(t){return[Math.floor(255*t[0]),Math.floor(255*t[1]),Math.floor(255*t[2]),t[3]]},t.parseColorString=function(e,i){if((e=e.toLowerCase()).startsWith("#")){switch(i=255,e.length){case 9:i=parseInt(e.slice(7,9),16);case 7:var n=parseInt(e.slice(1,3),16),r=parseInt(e.slice(3,5),16),a=parseInt(e.slice(5,7),16);break;case 5:i=17*parseInt(e.slice(4,5),16);case 4:n=17*parseInt(e.slice(1,2),16),r=17*parseInt(e.slice(2,3),16),a=17*parseInt(e.slice(3,4),16)}return t.Color(n,r,a,i/255)}return e.startsWith("rgba")?(e=(e=e.slice(5,-1)).split(","),t.Color(+e[0],+e[1],+e[2],s(e[3]))):e.startsWith("rgb")?(e=(e=e.slice(4,-1)).split(","),t.Color(+e[0],+e[1],+e[2],s(e[3]))):e.startsWith("gray(")||e.startsWith("hsl")||!i||void 0===(e=i[e])?t.BLACK:e},t.multiplyByAlpha=function(t,e){return(t=t.slice())[3]=Math.max(0,Math.min(t[3]*e,1)),t},t.Malloc=function(e,i){var n=t._malloc(i*e.BYTES_PER_ELEMENT);return{_ck:!0,length:i,byteOffset:n,se:null,subarray:function(t,e){return(t=this.toTypedArray().subarray(t,e))._ck=!0,t},toTypedArray:function(){return this.se&&this.se.length||(this.se=new e(t.HEAPU8.buffer,n,i),this.se._ck=!0),this.se}}},t.Free=function(e){t._free(e.byteOffset),e.byteOffset=$,e.toTypedArray=null,e.se=null};var S,_,C,A,T,P,E,k,M,x,F=$,R=$,B=$,L=$,N=$,G=$,U=$,W=$,z=$,j=$,H=Float32Array.of(0,0,1),$=0;t.onRuntimeInitialized=function(){function e(e,i,n,r,a,o,s){o||(o=4*r.width,r.colorType===t.ColorType.RGBA_F16?o*=2:r.colorType===t.ColorType.RGBA_F32&&(o*=4));var l=o*r.height,c=a?a.byteOffset:t._malloc(l);if(s?!e._readPixels(r,c,o,i,n,s):!e._readPixels(r,c,o,i,n))return a||t._free(c),null;if(a)return a.toTypedArray();switch(r.colorType){case t.ColorType.RGBA_8888:case t.ColorType.RGBA_F16:e=new Uint8Array(t.HEAPU8.buffer,c,l).slice();break;case t.ColorType.RGBA_F32:e=new Float32Array(t.HEAPU8.buffer,c,l).slice();break;default:return null}return t._free(c),e}C=t.Malloc(Float32Array,4),B=C.byteOffset,_=t.Malloc(Float32Array,16),R=_.byteOffset,S=t.Malloc(Float32Array,9),F=S.byteOffset,M=t.Malloc(Float32Array,12),z=M.byteOffset,x=t.Malloc(Float32Array,12),j=x.byteOffset,A=t.Malloc(Float32Array,4),L=A.byteOffset,T=t.Malloc(Float32Array,4),N=T.byteOffset,P=t.Malloc(Float32Array,3),G=P.byteOffset,E=t.Malloc(Float32Array,3),U=E.byteOffset,k=t.Malloc(Int32Array,4),W=k.byteOffset,t.ColorSpace.SRGB=t.ColorSpace._MakeSRGB(),t.ColorSpace.DISPLAY_P3=t.ColorSpace._MakeDisplayP3(),t.ColorSpace.ADOBE_RGB=t.ColorSpace._MakeAdobeRGB(),t.GlyphRunFlags={IsWhiteSpace:t._GlyphRunFlags_isWhiteSpace},t.Path.MakeFromCmds=function(e){var i=h(e,"HEAPF32"),n=t.Path._MakeFromCmds(i,e.length);return c(i,e),n},t.Path.MakeFromVerbsPointsWeights=function(e,i,n){var r=h(e,"HEAPU8"),a=h(i,"HEAPF32"),o=h(n,"HEAPF32"),s=t.Path._MakeFromVerbsPointsWeights(r,e.length,a,i.length,o,n&&n.length||0);return c(r,e),c(a,i),c(o,n),s},t.Path.prototype.addArc=function(t,e,i){return t=g(t),this._addArc(t,e,i),this},t.Path.prototype.addCircle=function(t,e,i,n){return this._addCircle(t,e,i,!!n),this},t.Path.prototype.addOval=function(t,e,i){return void 0===i&&(i=1),t=g(t),this._addOval(t,!!e,i),this},t.Path.prototype.addPath=function(){var t=Array.prototype.slice.call(arguments),e=t[0],i=!1;if("boolean"==typeof t[t.length-1]&&(i=t.pop()),1===t.length)this._addPath(e,1,0,0,0,1,0,0,0,1,i);else if(2===t.length)t=t[1],this._addPath(e,t[0],t[1],t[2],t[3],t[4],t[5],t[6]||0,t[7]||0,t[8]||1,i);else{if(7!==t.length&&10!==t.length)return null;this._addPath(e,t[1],t[2],t[3],t[4],t[5],t[6],t[7]||0,t[8]||0,t[9]||1,i)}return this},t.Path.prototype.addPoly=function(t,e){var i=h(t,"HEAPF32");return this._addPoly(i,t.length/2,e),c(i,t),this},t.Path.prototype.addRect=function(t,e){return t=g(t),this._addRect(t,!!e),this},t.Path.prototype.addRRect=function(t,e){return t=y(t),this._addRRect(t,!!e),this},t.Path.prototype.addVerbsPointsWeights=function(t,e,i){var n=h(t,"HEAPU8"),r=h(e,"HEAPF32"),a=h(i,"HEAPF32");this._addVerbsPointsWeights(n,t.length,r,e.length,a,i&&i.length||0),c(n,t),c(r,e),c(a,i)},t.Path.prototype.arc=function(e,i,n,r,a,o){return e=t.LTRBRect(e-n,i-n,e+n,i+n),a=(a-r)/Math.PI*180-360*!!o,(o=new t.Path).addArc(e,r/Math.PI*180,a),this.addPath(o,!0),o.delete(),this},t.Path.prototype.arcToOval=function(t,e,i,n){return t=g(t),this._arcToOval(t,e,i,n),this},t.Path.prototype.arcToRotated=function(t,e,i,n,r,a,o){return this._arcToRotated(t,e,i,!!n,!!r,a,o),this},t.Path.prototype.arcToTangent=function(t,e,i,n,r){return this._arcToTangent(t,e,i,n,r),this},t.Path.prototype.close=function(){return this._close(),this},t.Path.prototype.conicTo=function(t,e,i,n,r){return this._conicTo(t,e,i,n,r),this},t.Path.prototype.computeTightBounds=function(t){this._computeTightBounds(L);var e=A.toTypedArray();return t?(t.set(e),t):e.slice()},t.Path.prototype.cubicTo=function(t,e,i,n,r,a){return this._cubicTo(t,e,i,n,r,a),this},t.Path.prototype.dash=function(t,e,i){return this._dash(t,e,i)?this:null},t.Path.prototype.getBounds=function(t){this._getBounds(L);var e=A.toTypedArray();return t?(t.set(e),t):e.slice()},t.Path.prototype.lineTo=function(t,e){return this._lineTo(t,e),this},t.Path.prototype.moveTo=function(t,e){return this._moveTo(t,e),this},t.Path.prototype.offset=function(t,e){return this._transform(1,0,t,0,1,e,0,0,1),this},t.Path.prototype.quadTo=function(t,e,i,n){return this._quadTo(t,e,i,n),this},t.Path.prototype.rArcTo=function(t,e,i,n,r,a,o){return this._rArcTo(t,e,i,n,r,a,o),this},t.Path.prototype.rConicTo=function(t,e,i,n,r){return this._rConicTo(t,e,i,n,r),this},t.Path.prototype.rCubicTo=function(t,e,i,n,r,a){return this._rCubicTo(t,e,i,n,r,a),this},t.Path.prototype.rLineTo=function(t,e){return this._rLineTo(t,e),this},t.Path.prototype.rMoveTo=function(t,e){return this._rMoveTo(t,e),this},t.Path.prototype.rQuadTo=function(t,e,i,n){return this._rQuadTo(t,e,i,n),this},t.Path.prototype.stroke=function(e){return(e=e||{}).width=e.width||1,e.miter_limit=e.miter_limit||4,e.cap=e.cap||t.StrokeCap.Butt,e.join=e.join||t.StrokeJoin.Miter,e.precision=e.precision||1,this._stroke(e)?this:null},t.Path.prototype.transform=function(){if(1===arguments.length){var t=arguments[0];this._transform(t[0],t[1],t[2],t[3],t[4],t[5],t[6]||0,t[7]||0,t[8]||1)}else{if(6!==arguments.length&&9!==arguments.length)throw"transform expected to take 1 or 9 arguments. Got "+arguments.length;t=arguments,this._transform(t[0],t[1],t[2],t[3],t[4],t[5],t[6]||0,t[7]||0,t[8]||1)}return this},t.Path.prototype.trim=function(t,e,i){return this._trim(t,e,!!i)?this:null},t.Image.prototype.makeShaderCubic=function(t,e,i,n,r){return r=d(r),this._makeShaderCubic(t,e,i,n,r)},t.Image.prototype.makeShaderOptions=function(t,e,i,n,r){return r=d(r),this._makeShaderOptions(t,e,i,n,r)},t.Image.prototype.readPixels=function(i,n,r,a,o){return e(this,i,n,r,a,o,t.ef())},t.Canvas.prototype.clear=function(e){t.Pd(this.Nd),e=f(e),this._clear(e)},t.Canvas.prototype.clipRRect=function(e,i,n){t.Pd(this.Nd),e=y(e),this._clipRRect(e,i,n)},t.Canvas.prototype.clipRect=function(e,i,n){t.Pd(this.Nd),e=g(e),this._clipRect(e,i,n)},t.Canvas.prototype.concat=function(e){t.Pd(this.Nd),e=function(t){if(!t)return $;var e=_.toTypedArray();if(t.length){if(16!==t.length&&6!==t.length&&9!==t.length)throw"invalid matrix size";return 16===t.length?h(t,"HEAPF32",R):(e.fill(0),e[0]=t[0],e[1]=t[1],e[3]=t[2],e[4]=t[3],e[5]=t[4],e[7]=t[5],e[10]=1,e[12]=t[6],e[13]=t[7],e[15]=t[8],6===t.length&&(e[12]=0,e[13]=0,e[15]=1),R)}if(void 0===t.m11)throw"invalid matrix argument";return e[0]=t.m11,e[1]=t.m21,e[2]=t.m31,e[3]=t.m41,e[4]=t.m12,e[5]=t.m22,e[6]=t.m32,e[7]=t.m42,e[8]=t.m13,e[9]=t.m23,e[10]=t.m33,e[11]=t.m43,e[12]=t.m14,e[13]=t.m24,e[14]=t.m34,e[15]=t.m44,R}(e),this._concat(e)},t.Canvas.prototype.drawArc=function(e,i,n,r,a){t.Pd(this.Nd),e=g(e),this._drawArc(e,i,n,r,a)},t.Canvas.prototype.drawAtlas=function(e,i,n,r,a,s,l){if(e&&r&&i&&n&&i.length===n.length){t.Pd(this.Nd),a||(a=t.BlendMode.SrcOver);var u=h(i,"HEAPF32"),d=h(n,"HEAPF32"),f=n.length/4,p=h(o(s),"HEAPU32");if(l&&"B"in l&&"C"in l)this._drawAtlasCubic(e,d,u,p,f,a,l.B,l.C,r);else{let i=t.FilterMode.Linear,n=t.MipmapMode.None;l&&(i=l.filter,"mipmap"in l&&(n=l.mipmap)),this._drawAtlasOptions(e,d,u,p,f,a,i,n,r)}c(u,i),c(d,n),c(p,s)}},t.Canvas.prototype.drawCircle=function(e,i,n,r){t.Pd(this.Nd),this._drawCircle(e,i,n,r)},t.Canvas.prototype.drawColor=function(e,i){t.Pd(this.Nd),e=f(e),void 0!==i?this._drawColor(e,i):this._drawColor(e)},t.Canvas.prototype.drawColorInt=function(e,i){t.Pd(this.Nd),this._drawColorInt(e,i||t.BlendMode.SrcOver)},t.Canvas.prototype.drawColorComponents=function(e,i,n,r,a){t.Pd(this.Nd),e=p(e,i,n,r),void 0!==a?this._drawColor(e,a):this._drawColor(e)},t.Canvas.prototype.drawDRRect=function(e,i,n){t.Pd(this.Nd),e=y(e,z),i=y(i,j),this._drawDRRect(e,i,n)},t.Canvas.prototype.drawImage=function(e,i,n,r){t.Pd(this.Nd),this._drawImage(e,i,n,r||null)},t.Canvas.prototype.drawImageCubic=function(e,i,n,r,a,o){t.Pd(this.Nd),this._drawImageCubic(e,i,n,r,a,o||null)},t.Canvas.prototype.drawImageOptions=function(e,i,n,r,a,o){t.Pd(this.Nd),this._drawImageOptions(e,i,n,r,a,o||null)},t.Canvas.prototype.drawImageNine=function(e,i,n,r,a){t.Pd(this.Nd),i=h(i,"HEAP32",W),n=g(n),this._drawImageNine(e,i,n,r,a||null)},t.Canvas.prototype.drawImageRect=function(e,i,n,r,a){t.Pd(this.Nd),g(i,L),g(n,N),this._drawImageRect(e,L,N,r,!!a)},t.Canvas.prototype.drawImageRectCubic=function(e,i,n,r,a,o){t.Pd(this.Nd),g(i,L),g(n,N),this._drawImageRectCubic(e,L,N,r,a,o||null)},t.Canvas.prototype.drawImageRectOptions=function(e,i,n,r,a,o){t.Pd(this.Nd),g(i,L),g(n,N),this._drawImageRectOptions(e,L,N,r,a,o||null)},t.Canvas.prototype.drawLine=function(e,i,n,r,a){t.Pd(this.Nd),this._drawLine(e,i,n,r,a)},t.Canvas.prototype.drawOval=function(e,i){t.Pd(this.Nd),e=g(e),this._drawOval(e,i)},t.Canvas.prototype.drawPaint=function(e){t.Pd(this.Nd),this._drawPaint(e)},t.Canvas.prototype.drawParagraph=function(e,i,n){t.Pd(this.Nd),this._drawParagraph(e,i,n)},t.Canvas.prototype.drawPatch=function(e,i,n,r,a){if(24>e.length)throw"Need 12 cubic points";if(i&&4>i.length)throw"Need 4 colors";if(n&&8>n.length)throw"Need 4 shader coordinates";t.Pd(this.Nd);const s=h(e,"HEAPF32"),l=i?h(o(i),"HEAPU32"):$,u=n?h(n,"HEAPF32"):$;r||(r=t.BlendMode.Modulate),this._drawPatch(s,l,u,r,a),c(u,n),c(l,i),c(s,e)},t.Canvas.prototype.drawPath=function(e,i){t.Pd(this.Nd),this._drawPath(e,i)},t.Canvas.prototype.drawPicture=function(e){t.Pd(this.Nd),this._drawPicture(e)},t.Canvas.prototype.drawPoints=function(e,i,n){t.Pd(this.Nd);var r=h(i,"HEAPF32");this._drawPoints(e,r,i.length/2,n),c(r,i)},t.Canvas.prototype.drawRRect=function(e,i){t.Pd(this.Nd),e=y(e),this._drawRRect(e,i)},t.Canvas.prototype.drawRect=function(e,i){t.Pd(this.Nd),e=g(e),this._drawRect(e,i)},t.Canvas.prototype.drawRect4f=function(e,i,n,r,a){t.Pd(this.Nd),this._drawRect4f(e,i,n,r,a)},t.Canvas.prototype.drawShadow=function(e,i,n,r,a,o,s){t.Pd(this.Nd);var l=h(a,"HEAPF32"),u=h(o,"HEAPF32");i=h(i,"HEAPF32",G),n=h(n,"HEAPF32",U),this._drawShadow(e,i,n,r,l,u,s),c(l,a),c(u,o)},t.getShadowLocalBounds=function(t,e,i,n,r,a,o){return t=d(t),i=h(i,"HEAPF32",G),n=h(n,"HEAPF32",U),this._getShadowLocalBounds(t,e,i,n,r,a,L)?(e=A.toTypedArray(),o?(o.set(e),o):e.slice()):null},t.Canvas.prototype.drawTextBlob=function(e,i,n,r){t.Pd(this.Nd),this._drawTextBlob(e,i,n,r)},t.Canvas.prototype.drawVertices=function(e,i,n){t.Pd(this.Nd),this._drawVertices(e,i,n)},t.Canvas.prototype.getDeviceClipBounds=function(t){this._getDeviceClipBounds(W);var e=k.toTypedArray();return t?t.set(e):t=e.slice(),t},t.Canvas.prototype.getLocalToDevice=function(){this._getLocalToDevice(R);for(var e=R,i=Array(16),n=0;16>n;n++)i[n]=t.HEAPF32[e/4+n];return i},t.Canvas.prototype.getTotalMatrix=function(){this._getTotalMatrix(F);for(var e=Array(9),i=0;9>i;i++)e[i]=t.HEAPF32[F/4+i];return e},t.Canvas.prototype.makeSurface=function(t){return(t=this._makeSurface(t)).Nd=this.Nd,t},t.Canvas.prototype.readPixels=function(i,n,r,a,o){return t.Pd(this.Nd),e(this,i,n,r,a,o)},t.Canvas.prototype.saveLayer=function(t,e,i,n){return e=g(e),this._saveLayer(t||null,e,i||null,n||0)},t.Canvas.prototype.writePixels=function(e,i,n,r,a,o,s,l){if(e.byteLength%(i*n))throw"pixels length must be a multiple of the srcWidth * srcHeight";t.Pd(this.Nd);var u=e.byteLength/(i*n);o=o||t.AlphaType.Unpremul,s=s||t.ColorType.RGBA_8888,l=l||t.ColorSpace.SRGB;var d=u*i;return u=h(e,"HEAPU8"),i=this._writePixels({width:i,height:n,colorType:s,alphaType:o,colorSpace:l},u,d,r,a),c(u,e),i},t.ColorFilter.MakeBlend=function(e,i,n){return e=f(e),n=n||t.ColorSpace.SRGB,t.ColorFilter._MakeBlend(e,i,n)},t.ColorFilter.MakeMatrix=function(e){if(!e||20!==e.length)throw"invalid color matrix";var i=h(e,"HEAPF32"),n=t.ColorFilter._makeMatrix(i);return c(i,e),n},t.ContourMeasure.prototype.getPosTan=function(t,e){return this._getPosTan(t,L),t=A.toTypedArray(),e?(e.set(t),e):t.slice()},t.ImageFilter.MakeDropShadow=function(e,i,n,r,a,o){return a=f(a,B),t.ImageFilter._MakeDropShadow(e,i,n,r,a,o)},t.ImageFilter.MakeDropShadowOnly=function(e,i,n,r,a,o){return a=f(a,B),t.ImageFilter._MakeDropShadowOnly(e,i,n,r,a,o)},t.ImageFilter.MakeImage=function(e,i,n,r){if(n=g(n,L),r=g(r,N),"B"in i&&"C"in i)return t.ImageFilter._MakeImageCubic(e,i.B,i.C,n,r);const a=i.filter;let o=t.MipmapMode.None;return"mipmap"in i&&(o=i.mipmap),t.ImageFilter._MakeImageOptions(e,a,o,n,r)},t.ImageFilter.MakeMatrixTransform=function(e,i,n){if(e=d(e),"B"in i&&"C"in i)return t.ImageFilter._MakeMatrixTransformCubic(e,i.B,i.C,n);const r=i.filter;let a=t.MipmapMode.None;return"mipmap"in i&&(a=i.mipmap),t.ImageFilter._MakeMatrixTransformOptions(e,r,a,n)},t.Paint.prototype.getColor=function(){return this._getColor(B),m(B)},t.Paint.prototype.setColor=function(t,e){e=e||null,t=f(t),this._setColor(t,e)},t.Paint.prototype.setColorComponents=function(t,e,i,n,r){r=r||null,t=p(t,e,i,n),this._setColor(t,r)},t.Path.prototype.getPoint=function(t,e){return this._getPoint(t,L),t=A.toTypedArray(),e?(e[0]=t[0],e[1]=t[1],e):t.slice(0,2)},t.Picture.prototype.makeShader=function(t,e,i,n,r){return n=d(n),r=g(r),this._makeShader(t,e,i,n,r)},t.PictureRecorder.prototype.beginRecording=function(t){return t=g(t),this._beginRecording(t)},t.Surface.prototype.getCanvas=function(){var t=this._getCanvas();return t.Nd=this.Nd,t},t.Surface.prototype.makeImageSnapshot=function(e){return t.Pd(this.Nd),e=h(e,"HEAP32",W),this._makeImageSnapshot(e)},t.Surface.prototype.makeSurface=function(e){return t.Pd(this.Nd),(e=this._makeSurface(e)).Nd=this.Nd,e},t.Surface.prototype.Ef=function(e,i){this.Ie||(this.Ie=this.getCanvas()),requestAnimationFrame(function(){t.Pd(this.Nd),e(this.Ie),this.flush(i)}.bind(this))},t.Surface.prototype.requestAnimationFrame||(t.Surface.prototype.requestAnimationFrame=t.Surface.prototype.Ef),t.Surface.prototype.Af=function(e,i){this.Ie||(this.Ie=this.getCanvas()),requestAnimationFrame(function(){t.Pd(this.Nd),e(this.Ie),this.flush(i),this.dispose()}.bind(this))},t.Surface.prototype.drawOnce||(t.Surface.prototype.drawOnce=t.Surface.prototype.Af),t.PathEffect.MakeDash=function(e,i){if(i||(i=0),!e.length||1==e.length%2)throw"Intervals array must have even length";var n=h(e,"HEAPF32");return i=t.PathEffect._MakeDash(n,e.length,i),c(n,e),i},t.PathEffect.MakeLine2D=function(e,i){return i=d(i),t.PathEffect._MakeLine2D(e,i)},t.PathEffect.MakePath2D=function(e,i){return e=d(e),t.PathEffect._MakePath2D(e,i)},t.Shader.MakeColor=function(e,i){return i=i||null,e=f(e),t.Shader._MakeColor(e,i)},t.Shader.Blend=t.Shader.MakeBlend,t.Shader.Color=t.Shader.MakeColor,t.Shader.MakeLinearGradient=function(e,i,n,r,a,o,s,l){l=l||null;var f=u(n),p=h(r,"HEAPF32");s=s||0,o=d(o);var m=A.toTypedArray();return m.set(e),m.set(i,2),e=t.Shader._MakeLinearGradient(L,f.de,f.colorType,p,f.count,a,s,o,l),c(f.de,n),r&&c(p,r),e},t.Shader.MakeRadialGradient=function(e,i,n,r,a,o,s,l){l=l||null;var f=u(n),p=h(r,"HEAPF32");return s=s||0,o=d(o),e=t.Shader._MakeRadialGradient(e[0],e[1],i,f.de,f.colorType,p,f.count,a,s,o,l),c(f.de,n),r&&c(p,r),e},t.Shader.MakeSweepGradient=function(e,i,n,r,a,o,s,l,f,p){p=p||null;var m=u(n),g=h(r,"HEAPF32");return s=s||0,l=l||0,f=f||360,o=d(o),e=t.Shader._MakeSweepGradient(e,i,m.de,m.colorType,g,m.count,a,l,f,s,o,p),c(m.de,n),r&&c(g,r),e},t.Shader.MakeTwoPointConicalGradient=function(e,i,n,r,a,o,s,l,f,p){p=p||null;var m=u(a),g=h(o,"HEAPF32");f=f||0,l=d(l);var y=A.toTypedArray();return y.set(e),y.set(n,2),e=t.Shader._MakeTwoPointConicalGradient(L,i,r,m.de,m.colorType,g,m.count,s,f,l,p),c(m.de,a),o&&c(g,o),e},t.Vertices.prototype.bounds=function(t){this._bounds(L);var e=A.toTypedArray();return t?(t.set(e),t):e.slice()},t.Sd&&t.Sd.forEach((function(t){t()}))},t.computeTonalColors=function(t){var e=h(t.ambient,"HEAPF32"),i=h(t.spot,"HEAPF32");this._computeTonalColors(e,i);var n={ambient:m(e),spot:m(i)};return c(e,t.ambient),c(i,t.spot),n},t.LTRBRect=function(t,e,i,n){return Float32Array.of(t,e,i,n)},t.XYWHRect=function(t,e,i,n){return Float32Array.of(t,e,t+i,e+n)},t.LTRBiRect=function(t,e,i,n){return Int32Array.of(t,e,i,n)},t.XYWHiRect=function(t,e,i,n){return Int32Array.of(t,e,t+i,e+n)},t.RRectXY=function(t,e,i){return Float32Array.of(t[0],t[1],t[2],t[3],e,i,e,i,e,i,e,i)},t.MakeAnimatedImageFromEncoded=function(e){e=new Uint8Array(e);var i=t._malloc(e.byteLength);return t.HEAPU8.set(e,i),(e=t._decodeAnimatedImage(i,e.byteLength))?e:null},t.MakeImageFromEncoded=function(e){e=new Uint8Array(e);var i=t._malloc(e.byteLength);return t.HEAPU8.set(e,i),(e=t._decodeImage(i,e.byteLength))?e:null};var V=null;t.MakeImageFromCanvasImageSource=function(e){var i=e.width,n=e.height;V||(V=document.createElement("canvas")),V.width=i,V.height=n;var r=V.getContext("2d",{xg:!0});return r.drawImage(e,0,0),e=r.getImageData(0,0,i,n),t.MakeImage({width:i,height:n,alphaType:t.AlphaType.Unpremul,colorType:t.ColorType.RGBA_8888,colorSpace:t.ColorSpace.SRGB},e.data,4*i)},t.MakeImage=function(e,i,n){var r=t._malloc(i.length);return t.HEAPU8.set(i,r),t._MakeImage(e,r,i.length,n)},t.MakeVertices=function(e,i,n,r,a,s){var l=a&&a.length||0,c=0;return n&&n.length&&(c|=1),r&&r.length&&(c|=2),void 0===s||s||(c|=4),h(i,"HEAPF32",(e=new t._VerticesBuilder(e,i.length/2,l,c)).positions()),e.texCoords()&&h(n,"HEAPF32",e.texCoords()),e.colors()&&h(o(r),"HEAPU32",e.colors()),e.indices()&&h(a,"HEAPU16",e.indices()),e.detach()},t.Matrix={},t.Matrix.identity=function(){return n(3)},t.Matrix.invert=function(t){var e=t[0]*t[4]*t[8]+t[1]*t[5]*t[6]+t[2]*t[3]*t[7]-t[2]*t[4]*t[6]-t[1]*t[3]*t[8]-t[0]*t[5]*t[7];return e?[(t[4]*t[8]-t[5]*t[7])/e,(t[2]*t[7]-t[1]*t[8])/e,(t[1]*t[5]-t[2]*t[4])/e,(t[5]*t[6]-t[3]*t[8])/e,(t[0]*t[8]-t[2]*t[6])/e,(t[2]*t[3]-t[0]*t[5])/e,(t[3]*t[7]-t[4]*t[6])/e,(t[1]*t[6]-t[0]*t[7])/e,(t[0]*t[4]-t[1]*t[3])/e]:null},t.Matrix.mapPoints=function(t,e){for(var i=0;i<e.length;i+=2){var n=e[i],r=e[i+1],a=t[6]*n+t[7]*r+t[8],o=t[3]*n+t[4]*r+t[5];e[i]=(t[0]*n+t[1]*r+t[2])/a,e[i+1]=o/a}return e},t.Matrix.multiply=function(){return w(3,arguments)},t.Matrix.rotated=function(t,e,i){e=e||0,i=i||0;var n=Math.sin(t);return[t=Math.cos(t),-n,v(n,i,1-t,e),n,t,v(-n,e,1-t,i),0,0,1]},t.Matrix.scaled=function(t,e,r,a){r=r||0,a=a||0;var o=i([t,e],n(3),3,0,1);return i([r-t*r,a-e*a],o,3,2,0)},t.Matrix.skewed=function(t,e,r,a){r=r||0,a=a||0;var o=i([t,e],n(3),3,1,-1);return i([-t*r,-e*a],o,3,2,0)},t.Matrix.translated=function(t,e){return i(arguments,n(3),3,2,0)},t.Vector={},t.Vector.dot=function(t,e){return t.map((function(t,i){return t*e[i]})).reduce((function(t,e){return t+e}))},t.Vector.lengthSquared=function(e){return t.Vector.dot(e,e)},t.Vector.length=function(e){return Math.sqrt(t.Vector.lengthSquared(e))},t.Vector.mulScalar=function(t,e){return t.map((function(t){return t*e}))},t.Vector.add=function(t,e){return t.map((function(t,i){return t+e[i]}))},t.Vector.sub=function(t,e){return t.map((function(t,i){return t-e[i]}))},t.Vector.dist=function(e,i){return t.Vector.length(t.Vector.sub(e,i))},t.Vector.normalize=function(e){return t.Vector.mulScalar(e,1/t.Vector.length(e))},t.Vector.cross=function(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]},t.M44={},t.M44.identity=function(){return n(4)},t.M44.translated=function(t){return i(t,n(4),4,3,0)},t.M44.scaled=function(t){return i(t,n(4),4,0,1)},t.M44.rotated=function(e,i){return t.M44.rotatedUnitSinCos(t.Vector.normalize(e),Math.sin(i),Math.cos(i))},t.M44.rotatedUnitSinCos=function(t,e,i){var n=t[0],r=t[1],a=1-i;return[a*n*n+i,a*n*r-e*(t=t[2]),a*n*t+e*r,0,a*n*r+e*t,a*r*r+i,a*r*t-e*n,0,a*n*t-e*r,a*r*t+e*n,a*t*t+i,0,0,0,0,1]},t.M44.lookat=function(e,n,r){n=t.Vector.normalize(t.Vector.sub(n,e)),r=t.Vector.normalize(r),r=t.Vector.normalize(t.Vector.cross(n,r));var a=t.M44.identity();return i(r,a,4,0,0),i(t.Vector.cross(r,n),a,4,1,0),i(t.Vector.mulScalar(n,-1),a,4,2,0),i(e,a,4,3,0),null===(e=t.M44.invert(a))?t.M44.identity():e},t.M44.perspective=function(t,e,i){var n=1/(e-t);return i/=2,[i=Math.cos(i)/Math.sin(i),0,0,0,0,i,0,0,0,0,(e+t)*n,2*e*t*n,0,0,-1,1]},t.M44.rc=function(t,e,i){return t[4*e+i]},t.M44.multiply=function(){return w(4,arguments)},t.M44.invert=function(t){var e=t[0],i=t[4],n=t[8],r=t[12],a=t[1],o=t[5],s=t[9],l=t[13],c=t[2],h=t[6],u=t[10],d=t[14],f=t[3],p=t[7],m=t[11],g=e*o-i*a,y=e*s-n*a,v=e*l-r*a,b=i*s-n*o,w=i*l-r*o,S=n*l-r*s,_=c*p-h*f,C=c*m-u*f,A=c*(t=t[15])-d*f,T=h*m-u*p,P=h*t-d*p,E=u*t-d*m,k=g*E-y*P+v*T+b*A-w*C+S*_,M=1/k;return 0===k||1/0===M?null:(e=[o*(E*=M)-s*(P*=M)+l*(T*=M),s*(A*=M)-a*E-l*(C*=M),a*P-o*A+l*(_*=M),o*C-a*T-s*_,n*P-i*E-r*T,e*E-n*A+r*C,i*A-e*P-r*_,e*T-i*C+n*_,p*(S*=M)-m*(w*=M)+t*(b*=M),m*(v*=M)-f*S-t*(y*=M),f*w-p*v+t*(g*=M),p*y-f*b-m*g,u*w-h*S-d*b,c*S-u*v+d*y,h*v-c*w-d*g,c*b-h*y+u*g]).every((function(t){return!isNaN(t)&&1/0!==t&&-1/0!==t}))?e:null},t.M44.transpose=function(t){return[t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15]]},t.M44.mustInvert=function(e){if(null===(e=t.M44.invert(e)))throw"Matrix not invertible";return e},t.M44.setupCamera=function(e,i,n){var r=t.M44.lookat(n.eye,n.coa,n.up);return n=t.M44.perspective(n.near,n.far,n.angle),i=[(e[2]-e[0])/2,(e[3]-e[1])/2,i],e=t.M44.multiply(t.M44.translated([(e[0]+e[2])/2,(e[1]+e[3])/2,0]),t.M44.scaled(i)),t.M44.multiply(e,n,r,t.M44.mustInvert(e))},t.ColorMatrix={},t.ColorMatrix.identity=function(){var t=new Float32Array(20);return t[0]=1,t[6]=1,t[12]=1,t[18]=1,t},t.ColorMatrix.scaled=function(t,e,i,n){var r=new Float32Array(20);return r[0]=t,r[6]=e,r[12]=i,r[18]=n,r};var q,Y=[[6,7,11,12],[0,10,2,12],[0,1,5,6]];t.ColorMatrix.rotated=function(e,i,n){var r=t.ColorMatrix.identity();return r[(e=Y[e])[0]]=n,r[e[1]]=i,r[e[2]]=-i,r[e[3]]=n,r},t.ColorMatrix.postTranslate=function(t,e,i,n,r){return t[4]+=e,t[9]+=i,t[14]+=n,t[19]+=r,t},t.ColorMatrix.concat=function(t,e){for(var i=new Float32Array(20),n=0,r=0;20>r;r+=5){for(var a=0;4>a;a++)i[n++]=t[r]*e[a]+t[r+1]*e[a+5]+t[r+2]*e[a+10]+t[r+3]*e[a+15];i[n++]=t[r]*e[4]+t[r+1]*e[9]+t[r+2]*e[14]+t[r+3]*e[19]+t[r+4]}return i},(q=e).Sd=q.Sd||[],q.Sd.push((function(){function t(t){if(!t||!t.length)return[];for(var e=[],i=0;i<t.length;i+=5){var n=q.LTRBRect(t[i],t[i+1],t[i+2],t[i+3]);n.direction=0===t[i+4]?q.TextDirection.RTL:q.TextDirection.LTR,e.push(n)}return q._free(t.byteOffset),e}function e(t){return void 0===(t=t||{}).weight&&(t.weight=q.FontWeight.Normal),t.width=t.width||q.FontWidth.Normal,t.slant=t.slant||q.FontSlant.Upright,t}function i(t){if(!t||!t.length)return $;for(var e=[],i=0;i<t.length;i++){var r=n(t[i]);e.push(r)}return h(e,"HEAPU32")}function n(t){if(o[t])return o[t];var e=I(t)+1,i=q._malloc(e);return O(t,D,i,e),o[t]=i}function r(t){if(t._colorPtr=f(t.color),t._foregroundColorPtr=$,t._backgroundColorPtr=$,t._decorationColorPtr=$,t.foregroundColor&&(t._foregroundColorPtr=f(t.foregroundColor,s)),t.backgroundColor&&(t._backgroundColorPtr=f(t.backgroundColor,l)),t.decorationColor&&(t._decorationColorPtr=f(t.decorationColor,d)),Array.isArray(t.fontFamilies)&&t.fontFamilies.length?(t._fontFamiliesPtr=i(t.fontFamilies),t._fontFamiliesLen=t.fontFamilies.length):(t._fontFamiliesPtr=$,t._fontFamiliesLen=0),t.locale){var e=t.locale;t._localePtr=n(e),t._localeLen=I(e)+1}else t._localePtr=$,t._localeLen=0;if(Array.isArray(t.shadows)&&t.shadows.length){var r=(e=t.shadows).map((function(t){return t.color||q.BLACK})),a=e.map((function(t){return t.blurRadius||0}));t._shadowLen=e.length;for(var o=q._malloc(8*e.length),c=o/4,p=0;p<e.length;p++){var m=e[p].offset||[0,0];q.HEAPF32[c]=m[0],q.HEAPF32[c+1]=m[1],c+=2}t._shadowColorsPtr=u(r).de,t._shadowOffsetsPtr=o,t._shadowBlurRadiiPtr=h(a,"HEAPF32")}else t._shadowLen=0,t._shadowColorsPtr=$,t._shadowOffsetsPtr=$,t._shadowBlurRadiiPtr=$;Array.isArray(t.fontFeatures)&&t.fontFeatures.length?(r=(e=t.fontFeatures).map((function(t){return t.name})),a=e.map((function(t){return t.value})),t._fontFeatureLen=e.length,t._fontFeatureNamesPtr=i(r),t._fontFeatureValuesPtr=h(a,"HEAPU32")):(t._fontFeatureLen=0,t._fontFeatureNamesPtr=$,t._fontFeatureValuesPtr=$),Array.isArray(t.fontVariations)&&t.fontVariations.length?(r=(e=t.fontVariations).map((function(t){return t.axis})),a=e.map((function(t){return t.value})),t._fontVariationLen=e.length,t._fontVariationAxesPtr=i(r),t._fontVariationValuesPtr=h(a,"HEAPF32")):(t._fontVariationLen=0,t._fontVariationAxesPtr=$,t._fontVariationValuesPtr=$)}function a(t){q._free(t._fontFamiliesPtr),q._free(t._shadowColorsPtr),q._free(t._shadowOffsetsPtr),q._free(t._shadowBlurRadiiPtr),q._free(t._fontFeatureNamesPtr),q._free(t._fontFeatureValuesPtr)}q.Paragraph.prototype.getRectsForRange=function(e,i,n,r){return t(e=this._getRectsForRange(e,i,n,r))},q.Paragraph.prototype.getRectsForPlaceholders=function(){return t(this._getRectsForPlaceholders())},q.TypefaceFontProvider.prototype.registerFont=function(t,e){if(!(t=q.Typeface.MakeFreeTypeFaceFromData(t)))return null;e=n(e),this._registerFont(t,e)},q.ParagraphStyle=function(t){if(t.disableHinting=t.disableHinting||!1,t.ellipsis){var r=t.ellipsis;t._ellipsisPtr=n(r),t._ellipsisLen=I(r)+1}else t._ellipsisPtr=$,t._ellipsisLen=0;return t.heightMultiplier=t.heightMultiplier||0,t.maxLines=t.maxLines||0,t.replaceTabCharacters=t.replaceTabCharacters||!1,(r=(r=t.strutStyle)||{}).strutEnabled=r.strutEnabled||!1,r.strutEnabled&&Array.isArray(r.fontFamilies)&&r.fontFamilies.length?(r._fontFamiliesPtr=i(r.fontFamilies),r._fontFamiliesLen=r.fontFamilies.length):(r._fontFamiliesPtr=$,r._fontFamiliesLen=0),r.fontStyle=e(r.fontStyle),r.fontSize=r.fontSize||0,r.heightMultiplier=r.heightMultiplier||0,r.halfLeading=r.halfLeading||!1,r.leading=r.leading||0,r.forceStrutHeight=r.forceStrutHeight||!1,t.strutStyle=r,t.textAlign=t.textAlign||q.TextAlign.Start,t.textDirection=t.textDirection||q.TextDirection.LTR,t.textHeightBehavior=t.textHeightBehavior||q.TextHeightBehavior.All,t.textStyle=q.TextStyle(t.textStyle),t},q.TextStyle=function(t){return t.color||(t.color=q.BLACK),t.decoration=t.decoration||0,t.decorationThickness=t.decorationThickness||0,t.decorationStyle=t.decorationStyle||q.DecorationStyle.Solid,t.textBaseline=t.textBaseline||q.TextBaseline.Alphabetic,t.fontSize=t.fontSize||0,t.letterSpacing=t.letterSpacing||0,t.wordSpacing=t.wordSpacing||0,t.heightMultiplier=t.heightMultiplier||0,t.halfLeading=t.halfLeading||!1,t.fontStyle=e(t.fontStyle),t};var o={},s=q._malloc(16),l=q._malloc(16),d=q._malloc(16);q.ParagraphBuilder.Make=function(t,e){return r(t.textStyle),e=q.ParagraphBuilder._Make(t,e),a(t.textStyle),e},q.ParagraphBuilder.MakeFromFontProvider=function(t,e){return r(t.textStyle),e=q.ParagraphBuilder._MakeFromFontProvider(t,e),a(t.textStyle),e},q.ParagraphBuilder.ShapeText=function(t,e,i){let n=0;for(const t of e)n+=t.length;if(n!==t.length)throw"Accumulated block lengths must equal text.length";return q.ParagraphBuilder._ShapeText(t,e,i)},q.ParagraphBuilder.prototype.pushStyle=function(t){r(t),this._pushStyle(t),a(t)},q.ParagraphBuilder.prototype.pushPaintStyle=function(t,e,i){r(t),this._pushPaintStyle(t,e,i),a(t)},q.ParagraphBuilder.prototype.addPlaceholder=function(t,e,i,n,r){i=i||q.PlaceholderAlignment.Baseline,n=n||q.TextBaseline.Alphabetic,this._addPlaceholder(t||0,e||0,i,n,r||0)},q.ParagraphBuilder.prototype.buildWithClientInfo=function(t,e,i,n,r){var a=h(t,"HEAPU32"),o=h(e,"HEAPU32"),s=h(i,"HEAPU32"),l=h(n,"HEAPU32"),u=h(r,"HEAPU32"),d=this._buildWithClientInfo(a,t&&t.length||0,o,e&&e.length||0,s,i&&i.length||0,l,n&&n.length||0,u,r&&r.length||0);return c(a,t),c(o,e),c(s,i),c(l,n),c(u,r),d}})),t.MakeManagedAnimation=function(e,i,n,r,a){if(!t._MakeManagedAnimation)throw"Not compiled with MakeManagedAnimation";if(n||(n=""),!i)return t._MakeManagedAnimation(e,0,$,$,$,n,r,a);for(var o=[],s=[],l=[],c=Object.keys(i||{}),u=0;u<c.length;u++){var d=c[u],f=new Uint8Array(i[d]),p=t._malloc(f.byteLength);t.HEAPU8.set(f,p),s.push(p),l.push(f.byteLength),f=I(d)+1,p=t._malloc(f),O(d,D,p,f),o.push(p)}return i=h(o,"HEAPU32"),s=h(s,"HEAPU32"),l=h(l,"HEAPU32"),e=t._MakeManagedAnimation(e,c.length,i,s,l,n,r,a),t._free(i),t._free(s),t._free(l),e},function(t){t.Sd=t.Sd||[],t.Sd.push((function(){t.Animation.prototype.render=function(t,e){g(e,L),this._render(t,L)},t.Animation.prototype.size=function(t){this._size(L);var e=A.toTypedArray();return t?(t[0]=e[0],t[1]=e[1],t):e.slice(0,2)},t.ManagedAnimation&&(t.ManagedAnimation.prototype.render=function(t,e){g(e,L),this._render(t,L)},t.ManagedAnimation.prototype.seek=function(t,e){return this._seek(t,L),t=A.toTypedArray(),e?(e.set(t),e):t.slice()},t.ManagedAnimation.prototype.seekFrame=function(t,e){return this._seekFrame(t,L),t=A.toTypedArray(),e?(e.set(t),e):t.slice()},t.ManagedAnimation.prototype.setColor=function(t,e){return e=f(e),this._setColor(t,e)},t.ManagedAnimation.prototype.size=function(t){this._size(L);var e=A.toTypedArray();return t?(t[0]=e[0],t[1]=e[1],t):e.slice(0,2)})}))}(e),t.MakeParticles=function(e,i){if(!t._MakeParticles)throw"Not compiled with MakeParticles";if(!i)return t._MakeParticles(e,0,$,$,$);for(var n=[],r=[],a=[],o=Object.keys(i||{}),s=0;s<o.length;s++){var l=o[s],c=new Uint8Array(i[l]),u=t._malloc(c.byteLength);t.HEAPU8.set(c,u),r.push(u),a.push(c.byteLength),c=I(l)+1,u=t._malloc(c),O(l,D,u,c),n.push(u)}return i=h(n,"HEAPU32"),r=h(r,"HEAPU32"),a=h(a,"HEAPU32"),e=t._MakeParticles(e,o.length,i,r,a),t._free(i),t._free(r),t._free(a),e},t.Sd=t.Sd||[],t.Sd.push((function(){t.ParticleEffect.prototype.uniforms=function(){var e=this._uniformPtr(),i=this.getUniformFloatCount();return!e||0>=i?new Float32Array:new Float32Array(t.HEAPU8.buffer,e,i)},t.ParticleEffect.prototype.setPosition=function(t){this._setPosition(t[0],t[1])}})),t.Sd=t.Sd||[],t.Sd.push((function(){t.Path.prototype.op=function(t,e){return this._op(t,e)?this:null},t.Path.prototype.simplify=function(){return this._simplify()?this:null}})),t.Sd=t.Sd||[],t.Sd.push((function(){t.Canvas.prototype.drawText=function(e,i,n,r,a){var o=I(e),s=t._malloc(o+1);O(e,D,s,o+1),this._drawSimpleText(s,o,i,n,a,r),t._free(s)},t.Canvas.prototype.drawGlyphs=function(e,i,n,r,a,o){if(!(2*e.length<=i.length))throw"Not enough positions for the array of gyphs";t.Pd(this.Nd);const s=h(e,"HEAPU16"),l=h(i,"HEAPF32");this._drawGlyphs(e.length,s,l,n,r,a,o),c(l,i),c(s,e)},t.Font.prototype.getGlyphBounds=function(e,i,n){var r=h(e,"HEAPU16"),a=t._malloc(16*e.length);return this._getGlyphWidthBounds(r,e.length,$,a,i||null),i=new Float32Array(t.HEAPU8.buffer,a,4*e.length),c(r,e),n?(n.set(i),t._free(a),n):(e=Float32Array.from(i),t._free(a),e)},t.Font.prototype.getGlyphIDs=function(e,i,n){i||(i=e.length);var r=I(e)+1,a=t._malloc(r);return O(e,D,a,r),e=t._malloc(2*i),i=this._getGlyphIDs(a,r-1,i,e),t._free(a),0>i?(t._free(e),null):(a=new Uint16Array(t.HEAPU8.buffer,e,i),n?(n.set(a),t._free(e),n):(n=Uint16Array.from(a),t._free(e),n))},t.Font.prototype.getGlyphIntercepts=function(t,e,i,n){var r=h(t,"HEAPU16"),a=h(e,"HEAPF32");return this._getGlyphIntercepts(r,t.length,!(t&&t._ck),a,e.length,!(e&&e._ck),i,n)},t.Font.prototype.getGlyphWidths=function(e,i,n){var r=h(e,"HEAPU16"),a=t._malloc(4*e.length);return this._getGlyphWidthBounds(r,e.length,a,$,i||null),i=new Float32Array(t.HEAPU8.buffer,a,e.length),c(r,e),n?(n.set(i),t._free(a),n):(e=Float32Array.from(i),t._free(a),e)},t.FontMgr.FromData=function(){if(!arguments.length)return null;var e=arguments;if(1===e.length&&Array.isArray(e[0])&&(e=arguments[0]),!e.length)return null;for(var i=[],n=[],r=0;r<e.length;r++){var a=new Uint8Array(e[r]),o=h(a,"HEAPU8");i.push(o),n.push(a.byteLength)}return i=h(i,"HEAPU32"),n=h(n,"HEAPU32"),e=t.FontMgr._fromData(i,n,e.length),t._free(i),t._free(n),e},t.Typeface.MakeFreeTypeFaceFromData=function(e){var i=h(e=new Uint8Array(e),"HEAPU8");return(e=t.Typeface._MakeFreeTypeFaceFromData(i,e.byteLength))?e:null},t.Typeface.prototype.getGlyphIDs=function(e,i,n){i||(i=e.length);var r=I(e)+1,a=t._malloc(r);return O(e,D,a,r),e=t._malloc(2*i),i=this._getGlyphIDs(a,r-1,i,e),t._free(a),0>i?(t._free(e),null):(a=new Uint16Array(t.HEAPU8.buffer,e,i),n?(n.set(a),t._free(e),n):(n=Uint16Array.from(a),t._free(e),n))},t.TextBlob.MakeOnPath=function(e,i,n,r){if(e&&e.length&&i&&i.countPoints()){if(1===i.countPoints())return this.MakeFromText(e,n);r||(r=0);var a=n.getGlyphIDs(e);a=n.getGlyphWidths(a);for(var o=[],s=(i=new t.ContourMeasureIter(i,!1,1)).next(),l=new Float32Array(4),c=0;c<e.length&&s;c++){var h=a[c];if((r+=h/2)>s.length()){if(s.delete(),!(s=i.next())){e=e.substring(0,c);break}r=h/2}s.getPosTan(r,l);var u=l[2],d=l[3];o.push(u,d,l[0]-h/2*u,l[1]-h/2*d),r+=h/2}return e=this.MakeFromRSXform(e,o,n),s&&s.delete(),i.delete(),e}},t.TextBlob.MakeFromRSXform=function(e,i,n){var r=I(e)+1,a=t._malloc(r);return O(e,D,a,r),e=h(i,"HEAPF32"),n=t.TextBlob._MakeFromRSXform(a,r-1,e,n),t._free(a),n||null},t.TextBlob.MakeFromRSXformGlyphs=function(e,i,n){var r=h(e,"HEAPU16");return i=h(i,"HEAPF32"),n=t.TextBlob._MakeFromRSXformGlyphs(r,2*e.length,i,n),c(r,e),n||null},t.TextBlob.MakeFromGlyphs=function(e,i){var n=h(e,"HEAPU16");return i=t.TextBlob._MakeFromGlyphs(n,2*e.length,i),c(n,e),i||null},t.TextBlob.MakeFromText=function(e,i){var n=I(e)+1,r=t._malloc(n);return O(e,D,r,n),e=t.TextBlob._MakeFromText(r,n-1,i),t._free(r),e||null},t.MallocGlyphIDs=function(e){return t.Malloc(Uint16Array,e)}})),t.Sd=t.Sd||[],t.Sd.push((function(){t.MakePicture=function(e){e=new Uint8Array(e);var i=t._malloc(e.byteLength);return t.HEAPU8.set(e,i),(e=t._MakePicture(i,e.byteLength))?e:null}})),t.Sd=t.Sd||[],t.Sd.push((function(){t.RuntimeEffect.Make=function(e,i){return t.RuntimeEffect._Make(e,{onError:i||function(t){console.log("RuntimeEffect error",t)}})},t.RuntimeEffect.prototype.makeShader=function(t,e){var i=!t._ck,n=h(t,"HEAPF32");return e=d(e),this._makeShader(n,4*t.length,i,e)},t.RuntimeEffect.prototype.makeShaderWithChildren=function(t,e,i){var n=!t._ck,r=h(t,"HEAPF32");i=d(i);for(var a=[],o=0;o<e.length;o++)a.push(e[o].Md.Vd);return e=h(a,"HEAPU32"),this._makeShaderWithChildren(r,4*t.length,n,e,a.length,i)}})),function(){function e(t){for(var e=0;e<t.length;e++)if(void 0!==t[e]&&!Number.isFinite(t[e]))return!1;return!0}function i(e){var i=t.getColorComponents(e);e=i[0];var n=i[1],r=i[2];return 1===(i=i[3])?(e=e.toString(16).toLowerCase(),n=n.toString(16).toLowerCase(),r=r.toString(16).toLowerCase(),"#"+(e=1===e.length?"0"+e:e)+(n=1===n.length?"0"+n:n)+(r=1===r.length?"0"+r:r)):"rgba("+e+", "+n+", "+r+", "+(i=0===i||1===i?i:i.toFixed(8))+")"}function n(e){return t.parseColorString(e,b)}function a(t){if(!(t=w.exec(t)))return null;var e=parseFloat(t[4]),i=16;switch(t[5]){case"em":case"rem":case"pc":i=16*e;break;case"pt":i=4*e/3;break;case"px":i=e;break;case"in":i=96*e;break;case"cm":i=96*e/2.54;break;case"mm":i=96/25.4*e;break;case"q":i=96/25.4/4*e;break;case"%":i=16/75*e}return{style:t[1],variant:t[2],weight:t[3],sizePx:i,family:t[6].trim()}}function o(o){this.Od=o,this.Rd=new t.Paint,this.Rd.setAntiAlias(!0),this.Rd.setStrokeMiter(10),this.Rd.setStrokeCap(t.StrokeCap.Butt),this.Rd.setStrokeJoin(t.StrokeJoin.Miter),this.Re="10px monospace",this.oe=new t.Font(null,10),this.oe.setSubpixel(!0),this.ce=this.ie=t.BLACK,this.xe=0,this.Ke=t.TRANSPARENT,this.ze=this.ye=0,this.Le=this.le=1,this.Je=0,this.we=[],this.Qd=t.BlendMode.SrcOver,this.Rd.setStrokeWidth(this.Le),this.Rd.setBlendMode(this.Qd),this.Ud=new t.Path,this.Wd=t.Matrix.identity(),this.nf=[],this.De=[],this.ne=function(){this.Ud.delete(),this.Rd.delete(),this.oe.delete(),this.De.forEach((function(t){t.ne()}))},Object.defineProperty(this,"currentTransform",{enumerable:!0,get:function(){return{a:this.Wd[0],c:this.Wd[1],e:this.Wd[2],b:this.Wd[3],d:this.Wd[4],f:this.Wd[5]}},set:function(t){t.a&&this.setTransform(t.a,t.b,t.c,t.d,t.e,t.f)}}),Object.defineProperty(this,"fillStyle",{enumerable:!0,get:function(){return r(this.ce)?i(this.ce):this.ce},set:function(t){"string"==typeof t?this.ce=n(t):t.ve&&(this.ce=t)}}),Object.defineProperty(this,"font",{enumerable:!0,get:function(){return this.Re},set:function(t){var e=a(t),i=e.family;e.typeface=S[i]?S[i][(e.style||"normal")+"|"+(e.variant||"normal")+"|"+(e.weight||"normal")]||S[i]["*"]:null,e&&(this.oe.setSize(e.sizePx),this.oe.setTypeface(e.typeface),this.Re=t)}}),Object.defineProperty(this,"globalAlpha",{enumerable:!0,get:function(){return this.le},set:function(t){!isFinite(t)||0>t||1<t||(this.le=t)}}),Object.defineProperty(this,"globalCompositeOperation",{enumerable:!0,get:function(){switch(this.Qd){case t.BlendMode.SrcOver:return"source-over";case t.BlendMode.DstOver:return"destination-over";case t.BlendMode.Src:return"copy";case t.BlendMode.Dst:return"destination";case t.BlendMode.Clear:return"clear";case t.BlendMode.SrcIn:return"source-in";case t.BlendMode.DstIn:return"destination-in";case t.BlendMode.SrcOut:return"source-out";case t.BlendMode.DstOut:return"destination-out";case t.BlendMode.SrcATop:return"source-atop";case t.BlendMode.DstATop:return"destination-atop";case t.BlendMode.Xor:return"xor";case t.BlendMode.Plus:return"lighter";case t.BlendMode.Multiply:return"multiply";case t.BlendMode.Screen:return"screen";case t.BlendMode.Overlay:return"overlay";case t.BlendMode.Darken:return"darken";case t.BlendMode.Lighten:return"lighten";case t.BlendMode.ColorDodge:return"color-dodge";case t.BlendMode.ColorBurn:return"color-burn";case t.BlendMode.HardLight:return"hard-light";case t.BlendMode.SoftLight:return"soft-light";case t.BlendMode.Difference:return"difference";case t.BlendMode.Exclusion:return"exclusion";case t.BlendMode.Hue:return"hue";case t.BlendMode.Saturation:return"saturation";case t.BlendMode.Color:return"color";case t.BlendMode.Luminosity:return"luminosity"}},set:function(e){switch(e){case"source-over":this.Qd=t.BlendMode.SrcOver;break;case"destination-over":this.Qd=t.BlendMode.DstOver;break;case"copy":this.Qd=t.BlendMode.Src;break;case"destination":this.Qd=t.BlendMode.Dst;break;case"clear":this.Qd=t.BlendMode.Clear;break;case"source-in":this.Qd=t.BlendMode.SrcIn;break;case"destination-in":this.Qd=t.BlendMode.DstIn;break;case"source-out":this.Qd=t.BlendMode.SrcOut;break;case"destination-out":this.Qd=t.BlendMode.DstOut;break;case"source-atop":this.Qd=t.BlendMode.SrcATop;break;case"destination-atop":this.Qd=t.BlendMode.DstATop;break;case"xor":this.Qd=t.BlendMode.Xor;break;case"lighter":case"plus-lighter":this.Qd=t.BlendMode.Plus;break;case"plus-darker":throw"plus-darker is not supported";case"multiply":this.Qd=t.BlendMode.Multiply;break;case"screen":this.Qd=t.BlendMode.Screen;break;case"overlay":this.Qd=t.BlendMode.Overlay;break;case"darken":this.Qd=t.BlendMode.Darken;break;case"lighten":this.Qd=t.BlendMode.Lighten;break;case"color-dodge":this.Qd=t.BlendMode.ColorDodge;break;case"color-burn":this.Qd=t.BlendMode.ColorBurn;break;case"hard-light":this.Qd=t.BlendMode.HardLight;break;case"soft-light":this.Qd=t.BlendMode.SoftLight;break;case"difference":this.Qd=t.BlendMode.Difference;break;case"exclusion":this.Qd=t.BlendMode.Exclusion;break;case"hue":this.Qd=t.BlendMode.Hue;break;case"saturation":this.Qd=t.BlendMode.Saturation;break;case"color":this.Qd=t.BlendMode.Color;break;case"luminosity":this.Qd=t.BlendMode.Luminosity;break;default:return}this.Rd.setBlendMode(this.Qd)}}),Object.defineProperty(this,"imageSmoothingEnabled",{enumerable:!0,get:function(){return!0},set:function(){}}),Object.defineProperty(this,"imageSmoothingQuality",{enumerable:!0,get:function(){return"high"},set:function(){}}),Object.defineProperty(this,"lineCap",{enumerable:!0,get:function(){switch(this.Rd.getStrokeCap()){case t.StrokeCap.Butt:return"butt";case t.StrokeCap.Round:return"round";case t.StrokeCap.Square:return"square"}},set:function(e){switch(e){case"butt":this.Rd.setStrokeCap(t.StrokeCap.Butt);break;case"round":this.Rd.setStrokeCap(t.StrokeCap.Round);break;case"square":this.Rd.setStrokeCap(t.StrokeCap.Square)}}}),Object.defineProperty(this,"lineDashOffset",{enumerable:!0,get:function(){return this.Je},set:function(t){isFinite(t)&&(this.Je=t)}}),Object.defineProperty(this,"lineJoin",{enumerable:!0,get:function(){switch(this.Rd.getStrokeJoin()){case t.StrokeJoin.Miter:return"miter";case t.StrokeJoin.Round:return"round";case t.StrokeJoin.Bevel:return"bevel"}},set:function(e){switch(e){case"miter":this.Rd.setStrokeJoin(t.StrokeJoin.Miter);break;case"round":this.Rd.setStrokeJoin(t.StrokeJoin.Round);break;case"bevel":this.Rd.setStrokeJoin(t.StrokeJoin.Bevel)}}}),Object.defineProperty(this,"lineWidth",{enumerable:!0,get:function(){return this.Rd.getStrokeWidth()},set:function(t){0>=t||!t||(this.Le=t,this.Rd.setStrokeWidth(t))}}),Object.defineProperty(this,"miterLimit",{enumerable:!0,get:function(){return this.Rd.getStrokeMiter()},set:function(t){0>=t||!t||this.Rd.setStrokeMiter(t)}}),Object.defineProperty(this,"shadowBlur",{enumerable:!0,get:function(){return this.xe},set:function(t){0>t||!isFinite(t)||(this.xe=t)}}),Object.defineProperty(this,"shadowColor",{enumerable:!0,get:function(){return i(this.Ke)},set:function(t){this.Ke=n(t)}}),Object.defineProperty(this,"shadowOffsetX",{enumerable:!0,get:function(){return this.ye},set:function(t){isFinite(t)&&(this.ye=t)}}),Object.defineProperty(this,"shadowOffsetY",{enumerable:!0,get:function(){return this.ze},set:function(t){isFinite(t)&&(this.ze=t)}}),Object.defineProperty(this,"strokeStyle",{enumerable:!0,get:function(){return i(this.ie)},set:function(t){"string"==typeof t?this.ie=n(t):t.ve&&(this.ie=t)}}),this.arc=function(t,e,i,n,r,a){p(this.Ud,t,e,i,i,0,n,r,a)},this.arcTo=function(t,e,i,n,r){u(this.Ud,t,e,i,n,r)},this.beginPath=function(){this.Ud.delete(),this.Ud=new t.Path},this.bezierCurveTo=function(t,i,n,r,a,o){var s=this.Ud;e([t,i,n,r,a,o])&&(s.isEmpty()&&s.moveTo(t,i),s.cubicTo(t,i,n,r,a,o))},this.clearRect=function(e,i,n,r){this.Rd.setStyle(t.PaintStyle.Fill),this.Rd.setBlendMode(t.BlendMode.Clear),this.Od.drawRect(t.XYWHRect(e,i,n,r),this.Rd),this.Rd.setBlendMode(this.Qd)},this.clip=function(e,i){"string"==typeof e?(i=e,e=this.Ud):e&&e.$e&&(e=e.Xd),e||(e=this.Ud),e=e.copy(),i&&"evenodd"===i.toLowerCase()?e.setFillType(t.FillType.EvenOdd):e.setFillType(t.FillType.Winding),this.Od.clipPath(e,t.ClipOp.Intersect,!0),e.delete()},this.closePath=function(){d(this.Ud)},this.createImageData=function(){if(1===arguments.length){var t=arguments[0];return new c(new Uint8ClampedArray(4*t.width*t.height),t.width,t.height)}if(2===arguments.length){t=arguments[0];var e=arguments[1];return new c(new Uint8ClampedArray(4*t*e),t,e)}throw"createImageData expects 1 or 2 arguments, got "+arguments.length},this.createLinearGradient=function(t,i,n,r){if(e(arguments)){var a=new h(t,i,n,r);return this.De.push(a),a}},this.createPattern=function(t,e){return t=new y(t,e),this.De.push(t),t},this.createRadialGradient=function(t,i,n,r,a,o){if(e(arguments)){var s=new v(t,i,n,r,a,o);return this.De.push(s),s}},this.drawImage=function(e){e instanceof l&&(e=e.uf());var i=this.Qe();if(3===arguments.length||5===arguments.length)var n=t.XYWHRect(arguments[1],arguments[2],arguments[3]||e.width(),arguments[4]||e.height()),r=t.XYWHRect(0,0,e.width(),e.height());else{if(9!==arguments.length)throw"invalid number of args for drawImage, need 3, 5, or 9; got "+arguments.length;n=t.XYWHRect(arguments[5],arguments[6],arguments[7],arguments[8]),r=t.XYWHRect(arguments[1],arguments[2],arguments[3],arguments[4])}this.Od.drawImageRect(e,r,n,i,!1),i.dispose()},this.ellipse=function(t,e,i,n,r,a,o,s){p(this.Ud,t,e,i,n,r,a,o,s)},this.Qe=function(){var e=this.Rd.copy();if(e.setStyle(t.PaintStyle.Fill),r(this.ce)){var i=t.multiplyByAlpha(this.ce,this.le);e.setColor(i)}else i=this.ce.ve(this.Wd),e.setColor(t.Color(0,0,0,this.le)),e.setShader(i);return e.dispose=function(){this.delete()},e},this.fill=function(e,i){if("string"==typeof e?(i=e,e=this.Ud):e&&e.$e&&(e=e.Xd),"evenodd"===i)this.Ud.setFillType(t.FillType.EvenOdd);else{if("nonzero"!==i&&i)throw"invalid fill rule";this.Ud.setFillType(t.FillType.Winding)}e||(e=this.Ud),i=this.Qe();var n=this.Ae(i);n&&(this.Od.save(),this.te(),this.Od.drawPath(e,n),this.Od.restore(),n.dispose()),this.Od.drawPath(e,i),i.dispose()},this.fillRect=function(e,i,n,r){var a=this.Qe(),o=this.Ae(a);o&&(this.Od.save(),this.te(),this.Od.drawRect(t.XYWHRect(e,i,n,r),o),this.Od.restore(),o.dispose()),this.Od.drawRect(t.XYWHRect(e,i,n,r),a),a.dispose()},this.fillText=function(e,i,n){var r=this.Qe();e=t.TextBlob.MakeFromText(e,this.oe);var a=this.Ae(r);a&&(this.Od.save(),this.te(),this.Od.drawTextBlob(e,i,n,a),this.Od.restore(),a.dispose()),this.Od.drawTextBlob(e,i,n,r),e.delete(),r.dispose()},this.getImageData=function(e,i,n,r){return(e=this.Od.readPixels(e,i,{width:n,height:r,colorType:t.ColorType.RGBA_8888,alphaType:t.AlphaType.Unpremul,colorSpace:t.ColorSpace.SRGB}))?new c(new Uint8ClampedArray(e.buffer),n,r):null},this.getLineDash=function(){return this.we.slice()},this.pf=function(e){var i=t.Matrix.invert(this.Wd);return t.Matrix.mapPoints(i,e),e},this.isPointInPath=function(e,i,n){var r=arguments;if(3===r.length)var a=this.Ud;else{if(4!==r.length)throw"invalid arg count, need 3 or 4, got "+r.length;a=r[0],e=r[1],i=r[2],n=r[3]}return!(!isFinite(e)||!isFinite(i))&&("nonzero"===(n=n||"nonzero")||"evenodd"===n)&&(e=(r=this.pf([e,i]))[0],i=r[1],a.setFillType("nonzero"===n?t.FillType.Winding:t.FillType.EvenOdd),a.contains(e,i))},this.isPointInStroke=function(e,i){var n=arguments;if(2===n.length)var r=this.Ud;else{if(3!==n.length)throw"invalid arg count, need 2 or 3, got "+n.length;r=n[0],e=n[1],i=n[2]}return!(!isFinite(e)||!isFinite(i))&&(e=(n=this.pf([e,i]))[0],i=n[1],(r=r.copy()).setFillType(t.FillType.Winding),r.stroke({width:this.lineWidth,miter_limit:this.miterLimit,cap:this.Rd.getStrokeCap(),join:this.Rd.getStrokeJoin(),precision:.3}),n=r.contains(e,i),r.delete(),n)},this.lineTo=function(t,e){m(this.Ud,t,e)},this.measureText=function(t){t=this.oe.getGlyphIDs(t),t=this.oe.getGlyphWidths(t);let e=0;for(const i of t)e+=i;return{width:e}},this.moveTo=function(t,i){var n=this.Ud;e([t,i])&&n.moveTo(t,i)},this.putImageData=function(i,n,r,a,o,s,l){if(e([n,r,a,o,s,l]))if(void 0===a)this.Od.writePixels(i.data,i.width,i.height,n,r);else if(a=a||0,o=o||0,s=s||i.width,l=l||i.height,0>s&&(a+=s,s=Math.abs(s)),0>l&&(o+=l,l=Math.abs(l)),0>a&&(s+=a,a=0),0>o&&(l+=o,o=0),!(0>=s||0>=l)){i=t.MakeImage({width:i.width,height:i.height,alphaType:t.AlphaType.Unpremul,colorType:t.ColorType.RGBA_8888,colorSpace:t.ColorSpace.SRGB},i.data,4*i.width);var c=t.XYWHRect(a,o,s,l);n=t.XYWHRect(n+a,r+o,s,l),r=t.Matrix.invert(this.Wd),this.Od.save(),this.Od.concat(r),this.Od.drawImageRect(i,c,n,null,!1),this.Od.restore(),i.delete()}},this.quadraticCurveTo=function(t,i,n,r){var a=this.Ud;e([t,i,n,r])&&(a.isEmpty()&&a.moveTo(t,i),a.quadTo(t,i,n,r))},this.rect=function(i,n,r,a){var o=this.Ud;e(i=t.XYWHRect(i,n,r,a))&&o.addRect(i)},this.resetTransform=function(){this.Ud.transform(this.Wd);var e=t.Matrix.invert(this.Wd);this.Od.concat(e),this.Wd=this.Od.getTotalMatrix()},this.restore=function(){var e=this.nf.pop();if(e){var i=t.Matrix.multiply(this.Wd,t.Matrix.invert(e.Hf));this.Ud.transform(i),this.Rd.delete(),this.Rd=e.ag,this.we=e.Zf,this.Le=e.ng,this.ie=e.mg,this.ce=e.fs,this.ye=e.kg,this.ze=e.lg,this.xe=e.eg,this.Ke=e.jg,this.le=e.Of,this.Qd=e.Pf,this.Je=e.$f,this.Re=e.Nf,this.Od.restore(),this.Wd=this.Od.getTotalMatrix()}},this.rotate=function(e){if(isFinite(e)){var i=t.Matrix.rotated(-e);this.Ud.transform(i),this.Od.rotate(e/Math.PI*180,0,0),this.Wd=this.Od.getTotalMatrix()}},this.save=function(){if(this.ce.ue){var t=this.ce.ue();this.De.push(t)}else t=this.ce;if(this.ie.ue){var e=this.ie.ue();this.De.push(e)}else e=this.ie;this.nf.push({Hf:this.Wd.slice(),Zf:this.we.slice(),ng:this.Le,mg:e,fs:t,kg:this.ye,lg:this.ze,eg:this.xe,jg:this.Ke,Of:this.le,$f:this.Je,Pf:this.Qd,ag:this.Rd.copy(),Nf:this.Re}),this.Od.save()},this.scale=function(i,n){if(e(arguments)){var r=t.Matrix.scaled(1/i,1/n);this.Ud.transform(r),this.Od.scale(i,n),this.Wd=this.Od.getTotalMatrix()}},this.setLineDash=function(t){for(var e=0;e<t.length;e++)if(!isFinite(t[e])||0>t[e])return;1==t.length%2&&Array.prototype.push.apply(t,t),this.we=t},this.setTransform=function(t,i,n,r,a,o){e(arguments)&&(this.resetTransform(),this.transform(t,i,n,r,a,o))},this.te=function(){var e=t.Matrix.invert(this.Wd);this.Od.concat(e),this.Od.concat(t.Matrix.translated(this.ye,this.ze)),this.Od.concat(this.Wd)},this.Ae=function(e){var i=t.multiplyByAlpha(this.Ke,this.le);if(!t.getColorComponents(i)[3]||!(this.xe||this.ze||this.ye))return null;(e=e.copy()).setColor(i);var n=t.MaskFilter.MakeBlur(t.BlurStyle.Normal,this.xe/2,!1);return e.setMaskFilter(n),e.dispose=function(){n.delete(),this.delete()},e},this.bf=function(){var e=this.Rd.copy();if(e.setStyle(t.PaintStyle.Stroke),r(this.ie)){var i=t.multiplyByAlpha(this.ie,this.le);e.setColor(i)}else i=this.ie.ve(this.Wd),e.setColor(t.Color(0,0,0,this.le)),e.setShader(i);if(e.setStrokeWidth(this.Le),this.we.length){var n=t.PathEffect.MakeDash(this.we,this.Je);e.setPathEffect(n)}return e.dispose=function(){n&&n.delete(),this.delete()},e},this.stroke=function(t){t=t?t.Xd:this.Ud;var e=this.bf(),i=this.Ae(e);i&&(this.Od.save(),this.te(),this.Od.drawPath(t,i),this.Od.restore(),i.dispose()),this.Od.drawPath(t,e),e.dispose()},this.strokeRect=function(e,i,n,r){var a=this.bf(),o=this.Ae(a);o&&(this.Od.save(),this.te(),this.Od.drawRect(t.XYWHRect(e,i,n,r),o),this.Od.restore(),o.dispose()),this.Od.drawRect(t.XYWHRect(e,i,n,r),a),a.dispose()},this.strokeText=function(e,i,n){var r=this.bf();e=t.TextBlob.MakeFromText(e,this.oe);var a=this.Ae(r);a&&(this.Od.save(),this.te(),this.Od.drawTextBlob(e,i,n,a),this.Od.restore(),a.dispose()),this.Od.drawTextBlob(e,i,n,r),e.delete(),r.dispose()},this.translate=function(i,n){if(e(arguments)){var r=t.Matrix.translated(-i,-n);this.Ud.transform(r),this.Od.translate(i,n),this.Wd=this.Od.getTotalMatrix()}},this.transform=function(e,i,n,r,a,o){e=[e,n,a,i,r,o,0,0,1],i=t.Matrix.invert(e),this.Ud.transform(i),this.Od.concat(e),this.Wd=this.Od.getTotalMatrix()},this.addHitRegion=function(){},this.clearHitRegions=function(){},this.drawFocusIfNeeded=function(){},this.removeHitRegion=function(){},this.scrollPathIntoView=function(){},Object.defineProperty(this,"canvas",{value:null,writable:!1})}function s(e){this.cf=e,this.Nd=new o(e.getCanvas()),this.Se=[],this.decodeImage=function(e){if(!(e=t.MakeImageFromEncoded(e)))throw"Invalid input";return this.Se.push(e),new l(e)},this.loadFont=function(e,i){if(!(e=t.Typeface.MakeFreeTypeFaceFromData(e)))return null;this.Se.push(e);var n=(i.style||"normal")+"|"+(i.variant||"normal")+"|"+(i.weight||"normal");i=i.family,S[i]||(S[i]={"*":e}),S[i][n]=e},this.makePath2D=function(t){return t=new g(t),this.Se.push(t.Xd),t},this.getContext=function(t){return"2d"===t?this.Nd:null},this.toDataURL=function(e,i){this.cf.flush();var n=this.cf.makeImageSnapshot();if(n){e=e||"image/png";var r=t.ImageFormat.PNG;if("image/jpeg"===e&&(r=t.ImageFormat.JPEG),i=n.encodeToBytes(r,i||.92)){if(n.delete(),e="data:"+e+";base64,","undefined"!=typeof Buffer)i=Buffer.from(i).toString("base64");else{n=0,r=i.length;for(var a,o="";n<r;)a=i.slice(n,Math.min(n+32768,r)),o+=String.fromCharCode.apply(null,a),n+=32768;i=btoa(o)}return e+i}}},this.dispose=function(){this.Nd.ne(),this.Se.forEach((function(t){t.delete()})),this.cf.dispose()}}function l(t){this.width=t.width(),this.height=t.height(),this.naturalWidth=this.width,this.naturalHeight=this.height,this.uf=function(){return t}}function c(t,e,i){if(!e||0===i)throw"invalid dimensions, width and height must be non-zero";if(t.length%4)throw"arr must be a multiple of 4";i=i||t.length/(4*e),Object.defineProperty(this,"data",{value:t,writable:!1}),Object.defineProperty(this,"height",{value:i,writable:!1}),Object.defineProperty(this,"width",{value:e,writable:!1})}function h(e,i,r,a){this.Zd=null,this.ee=[],this.be=[],this.addColorStop=function(t,e){if(0>t||1<t||!isFinite(t))throw"offset must be between 0 and 1 inclusively";e=n(e);var i=this.be.indexOf(t);if(-1!==i)this.ee[i]=e;else{for(i=0;i<this.be.length&&!(this.be[i]>t);i++);this.be.splice(i,0,t),this.ee.splice(i,0,e)}},this.ue=function(){var t=new h(e,i,r,a);return t.ee=this.ee.slice(),t.be=this.be.slice(),t},this.ne=function(){this.Zd&&(this.Zd.delete(),this.Zd=null)},this.ve=function(n){var o=[e,i,r,a];t.Matrix.mapPoints(n,o),n=o[0];var s=o[1],l=o[2];return o=o[3],this.ne(),this.Zd=t.Shader.MakeLinearGradient([n,s],[l,o],this.ee,this.be,t.TileMode.Clamp)}}function u(t,i,n,r,a,o){if(e([i,n,r,a,o])){if(0>o)throw"radii cannot be negative";t.isEmpty()&&t.moveTo(i,n),t.arcToTangent(i,n,r,a,o)}}function d(t){if(!t.isEmpty()){var e=t.getBounds();(e[3]-e[1]||e[2]-e[0])&&t.close()}}function f(e,i,n,r,a,o,s){s=(s-o)/Math.PI*180,o=o/Math.PI*180,i=t.LTRBRect(i-r,n-a,i+r,n+a),1e-5>Math.abs(Math.abs(s)-360)?(n=s/2,e.arcToOval(i,o,n,!1),e.arcToOval(i,o+n,n,!1)):e.arcToOval(i,o,s,!1)}function p(i,n,r,a,o,s,l,c,h){if(e([n,r,a,o,s,l,c])){if(0>a||0>o)throw"radii cannot be negative";var u=2*Math.PI,d=l%u;0>d&&(d+=u);var p=d-l;l=d,c+=p,!h&&c-l>=u?c=l+u:h&&l-c>=u?c=l-u:!h&&l>c?c=l+(u-(l-c)%u):h&&l<c&&(c=l-(u-(c-l)%u)),s?(h=t.Matrix.rotated(s,n,r),s=t.Matrix.rotated(-s,n,r),i.transform(s),f(i,n,r,a,o,l,c),i.transform(h)):f(i,n,r,a,o,l,c)}}function m(t,i,n){e([i,n])&&(t.isEmpty()&&t.moveTo(i,n),t.lineTo(i,n))}function g(i){this.Xd=null,this.Xd="string"==typeof i?t.Path.MakeFromSVGString(i):i&&i.$e?i.Xd.copy():new t.Path,this.$e=function(){return this.Xd},this.addPath=function(t,e){e||(e={a:1,c:0,e:0,b:0,d:1,f:0}),this.Xd.addPath(t.Xd,[e.a,e.c,e.e,e.b,e.d,e.f])},this.arc=function(t,e,i,n,r,a){p(this.Xd,t,e,i,i,0,n,r,a)},this.arcTo=function(t,e,i,n,r){u(this.Xd,t,e,i,n,r)},this.bezierCurveTo=function(t,i,n,r,a,o){var s=this.Xd;e([t,i,n,r,a,o])&&(s.isEmpty()&&s.moveTo(t,i),s.cubicTo(t,i,n,r,a,o))},this.closePath=function(){d(this.Xd)},this.ellipse=function(t,e,i,n,r,a,o,s){p(this.Xd,t,e,i,n,r,a,o,s)},this.lineTo=function(t,e){m(this.Xd,t,e)},this.moveTo=function(t,i){var n=this.Xd;e([t,i])&&n.moveTo(t,i)},this.quadraticCurveTo=function(t,i,n,r){var a=this.Xd;e([t,i,n,r])&&(a.isEmpty()&&a.moveTo(t,i),a.quadTo(t,i,n,r))},this.rect=function(i,n,r,a){var o=this.Xd;e(i=t.XYWHRect(i,n,r,a))&&o.addRect(i)}}function y(i,n){switch(this.Zd=null,i instanceof l&&(i=i.uf()),this.Cf=i,this._transform=t.Matrix.identity(),""===n&&(n="repeat"),n){case"repeat-x":this.Be=t.TileMode.Repeat,this.Ce=t.TileMode.Decal;break;case"repeat-y":this.Be=t.TileMode.Decal,this.Ce=t.TileMode.Repeat;break;case"repeat":this.Ce=this.Be=t.TileMode.Repeat;break;case"no-repeat":this.Ce=this.Be=t.TileMode.Decal;break;default:throw"invalid repetition mode "+n}this.setTransform=function(t){e(t=[t.a,t.c,t.e,t.b,t.d,t.f,0,0,1])&&(this._transform=t)},this.ue=function(){var t=new y;return t.Be=this.Be,t.Ce=this.Ce,t},this.ne=function(){this.Zd&&(this.Zd.delete(),this.Zd=null)},this.ve=function(){return this.ne(),this.Zd=this.Cf.makeShaderCubic(this.Be,this.Ce,1/3,1/3,this._transform)}}function v(e,i,r,a,o,s){this.Zd=null,this.ee=[],this.be=[],this.addColorStop=function(t,e){if(0>t||1<t||!isFinite(t))throw"offset must be between 0 and 1 inclusively";e=n(e);var i=this.be.indexOf(t);if(-1!==i)this.ee[i]=e;else{for(i=0;i<this.be.length&&!(this.be[i]>t);i++);this.be.splice(i,0,t),this.ee.splice(i,0,e)}},this.ue=function(){var t=new v(e,i,r,a,o,s);return t.ee=this.ee.slice(),t.be=this.be.slice(),t},this.ne=function(){this.Zd&&(this.Zd.delete(),this.Zd=null)},this.ve=function(n){var l=[e,i,a,o];t.Matrix.mapPoints(n,l);var c=l[0],h=l[1],u=l[2];l=l[3];var d=(Math.abs(n[0])+Math.abs(n[4]))/2;return n=r*d,d*=s,this.ne(),this.Zd=t.Shader.MakeTwoPointConicalGradient([c,h],n,[u,l],d,this.ee,this.be,t.TileMode.Clamp)}}t._testing={};var b={aliceblue:Float32Array.of(.941,.973,1,1),antiquewhite:Float32Array.of(.98,.922,.843,1),aqua:Float32Array.of(0,1,1,1),aquamarine:Float32Array.of(.498,1,.831,1),azure:Float32Array.of(.941,1,1,1),beige:Float32Array.of(.961,.961,.863,1),bisque:Float32Array.of(1,.894,.769,1),black:Float32Array.of(0,0,0,1),blanchedalmond:Float32Array.of(1,.922,.804,1),blue:Float32Array.of(0,0,1,1),blueviolet:Float32Array.of(.541,.169,.886,1),brown:Float32Array.of(.647,.165,.165,1),burlywood:Float32Array.of(.871,.722,.529,1),cadetblue:Float32Array.of(.373,.62,.627,1),chartreuse:Float32Array.of(.498,1,0,1),chocolate:Float32Array.of(.824,.412,.118,1),coral:Float32Array.of(1,.498,.314,1),cornflowerblue:Float32Array.of(.392,.584,.929,1),cornsilk:Float32Array.of(1,.973,.863,1),crimson:Float32Array.of(.863,.078,.235,1),cyan:Float32Array.of(0,1,1,1),darkblue:Float32Array.of(0,0,.545,1),darkcyan:Float32Array.of(0,.545,.545,1),darkgoldenrod:Float32Array.of(.722,.525,.043,1),darkgray:Float32Array.of(.663,.663,.663,1),darkgreen:Float32Array.of(0,.392,0,1),darkgrey:Float32Array.of(.663,.663,.663,1),darkkhaki:Float32Array.of(.741,.718,.42,1),darkmagenta:Float32Array.of(.545,0,.545,1),darkolivegreen:Float32Array.of(.333,.42,.184,1),darkorange:Float32Array.of(1,.549,0,1),darkorchid:Float32Array.of(.6,.196,.8,1),darkred:Float32Array.of(.545,0,0,1),darksalmon:Float32Array.of(.914,.588,.478,1),darkseagreen:Float32Array.of(.561,.737,.561,1),darkslateblue:Float32Array.of(.282,.239,.545,1),darkslategray:Float32Array.of(.184,.31,.31,1),darkslategrey:Float32Array.of(.184,.31,.31,1),darkturquoise:Float32Array.of(0,.808,.82,1),darkviolet:Float32Array.of(.58,0,.827,1),deeppink:Float32Array.of(1,.078,.576,1),deepskyblue:Float32Array.of(0,.749,1,1),dimgray:Float32Array.of(.412,.412,.412,1),dimgrey:Float32Array.of(.412,.412,.412,1),dodgerblue:Float32Array.of(.118,.565,1,1),firebrick:Float32Array.of(.698,.133,.133,1),floralwhite:Float32Array.of(1,.98,.941,1),forestgreen:Float32Array.of(.133,.545,.133,1),fuchsia:Float32Array.of(1,0,1,1),gainsboro:Float32Array.of(.863,.863,.863,1),ghostwhite:Float32Array.of(.973,.973,1,1),gold:Float32Array.of(1,.843,0,1),goldenrod:Float32Array.of(.855,.647,.125,1),gray:Float32Array.of(.502,.502,.502,1),green:Float32Array.of(0,.502,0,1),greenyellow:Float32Array.of(.678,1,.184,1),grey:Float32Array.of(.502,.502,.502,1),honeydew:Float32Array.of(.941,1,.941,1),hotpink:Float32Array.of(1,.412,.706,1),indianred:Float32Array.of(.804,.361,.361,1),indigo:Float32Array.of(.294,0,.51,1),ivory:Float32Array.of(1,1,.941,1),khaki:Float32Array.of(.941,.902,.549,1),lavender:Float32Array.of(.902,.902,.98,1),lavenderblush:Float32Array.of(1,.941,.961,1),lawngreen:Float32Array.of(.486,.988,0,1),lemonchiffon:Float32Array.of(1,.98,.804,1),lightblue:Float32Array.of(.678,.847,.902,1),lightcoral:Float32Array.of(.941,.502,.502,1),lightcyan:Float32Array.of(.878,1,1,1),lightgoldenrodyellow:Float32Array.of(.98,.98,.824,1),lightgray:Float32Array.of(.827,.827,.827,1),lightgreen:Float32Array.of(.565,.933,.565,1),lightgrey:Float32Array.of(.827,.827,.827,1),lightpink:Float32Array.of(1,.714,.757,1),lightsalmon:Float32Array.of(1,.627,.478,1),lightseagreen:Float32Array.of(.125,.698,.667,1),lightskyblue:Float32Array.of(.529,.808,.98,1),lightslategray:Float32Array.of(.467,.533,.6,1),lightslategrey:Float32Array.of(.467,.533,.6,1),lightsteelblue:Float32Array.of(.69,.769,.871,1),lightyellow:Float32Array.of(1,1,.878,1),lime:Float32Array.of(0,1,0,1),limegreen:Float32Array.of(.196,.804,.196,1),linen:Float32Array.of(.98,.941,.902,1),magenta:Float32Array.of(1,0,1,1),maroon:Float32Array.of(.502,0,0,1),mediumaquamarine:Float32Array.of(.4,.804,.667,1),mediumblue:Float32Array.of(0,0,.804,1),mediumorchid:Float32Array.of(.729,.333,.827,1),mediumpurple:Float32Array.of(.576,.439,.859,1),mediumseagreen:Float32Array.of(.235,.702,.443,1),mediumslateblue:Float32Array.of(.482,.408,.933,1),mediumspringgreen:Float32Array.of(0,.98,.604,1),mediumturquoise:Float32Array.of(.282,.82,.8,1),mediumvioletred:Float32Array.of(.78,.082,.522,1),midnightblue:Float32Array.of(.098,.098,.439,1),mintcream:Float32Array.of(.961,1,.98,1),mistyrose:Float32Array.of(1,.894,.882,1),moccasin:Float32Array.of(1,.894,.71,1),navajowhite:Float32Array.of(1,.871,.678,1),navy:Float32Array.of(0,0,.502,1),oldlace:Float32Array.of(.992,.961,.902,1),olive:Float32Array.of(.502,.502,0,1),olivedrab:Float32Array.of(.42,.557,.137,1),orange:Float32Array.of(1,.647,0,1),orangered:Float32Array.of(1,.271,0,1),orchid:Float32Array.of(.855,.439,.839,1),palegoldenrod:Float32Array.of(.933,.91,.667,1),palegreen:Float32Array.of(.596,.984,.596,1),paleturquoise:Float32Array.of(.686,.933,.933,1),palevioletred:Float32Array.of(.859,.439,.576,1),papayawhip:Float32Array.of(1,.937,.835,1),peachpuff:Float32Array.of(1,.855,.725,1),peru:Float32Array.of(.804,.522,.247,1),pink:Float32Array.of(1,.753,.796,1),plum:Float32Array.of(.867,.627,.867,1),powderblue:Float32Array.of(.69,.878,.902,1),purple:Float32Array.of(.502,0,.502,1),rebeccapurple:Float32Array.of(.4,.2,.6,1),red:Float32Array.of(1,0,0,1),rosybrown:Float32Array.of(.737,.561,.561,1),royalblue:Float32Array.of(.255,.412,.882,1),saddlebrown:Float32Array.of(.545,.271,.075,1),salmon:Float32Array.of(.98,.502,.447,1),sandybrown:Float32Array.of(.957,.643,.376,1),seagreen:Float32Array.of(.18,.545,.341,1),seashell:Float32Array.of(1,.961,.933,1),sienna:Float32Array.of(.627,.322,.176,1),silver:Float32Array.of(.753,.753,.753,1),skyblue:Float32Array.of(.529,.808,.922,1),slateblue:Float32Array.of(.416,.353,.804,1),slategray:Float32Array.of(.439,.502,.565,1),slategrey:Float32Array.of(.439,.502,.565,1),snow:Float32Array.of(1,.98,.98,1),springgreen:Float32Array.of(0,1,.498,1),steelblue:Float32Array.of(.275,.51,.706,1),tan:Float32Array.of(.824,.706,.549,1),teal:Float32Array.of(0,.502,.502,1),thistle:Float32Array.of(.847,.749,.847,1),tomato:Float32Array.of(1,.388,.278,1),transparent:Float32Array.of(0,0,0,0),turquoise:Float32Array.of(.251,.878,.816,1),violet:Float32Array.of(.933,.51,.933,1),wheat:Float32Array.of(.961,.871,.702,1),white:Float32Array.of(1,1,1,1),whitesmoke:Float32Array.of(.961,.961,.961,1),yellow:Float32Array.of(1,1,0,1),yellowgreen:Float32Array.of(.604,.804,.196,1)};t._testing.parseColor=n,t._testing.colorToString=i;var w=RegExp("(italic|oblique|normal|)\\s*(small-caps|normal|)\\s*(bold|bolder|lighter|[1-9]00|normal|)\\s*([\\d\\.]+)(px|pt|pc|in|cm|mm|%|em|ex|ch|rem|q)(.+)"),S={"Noto Mono":{"*":null},monospace:{"*":null}};t._testing.parseFontString=a,t.MakeCanvas=function(e,i){return(e=t.MakeSurface(e,i))?new s(e):null},t.ImageData=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return new c(new Uint8ClampedArray(4*t*e),t,e)}if(3===arguments.length){var i=arguments[0];if(i.prototype.constructor!==Uint8ClampedArray)throw"bytes must be given as a Uint8ClampedArray";if(i%4)throw"bytes must be given in a multiple of 4";if(i%(t=arguments[1]))throw"bytes must divide evenly by width";if((e=arguments[2])&&e!==i/(4*t))throw"invalid height given";return new c(i,t,i/(4*t))}throw"invalid number of arguments - takes 2 or 3, saw "+arguments.length}}()}(e);var o,s,l,c,h,u,d=Object.assign({},e),f="./this.program",m=(t,e)=>{throw e},g="object"==typeof window,y="function"==typeof importScripts,v="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,b="";v?(b=y?_.dirname(b)+"/":__dirname+"/",u=()=>{h||(c=C,h=_)},o=function(t,e){return u(),t=h.normalize(t),c.readFileSync(t,e?void 0:"utf8")},l=t=>((t=o(t,!0)).buffer||(t=new Uint8Array(t)),t),s=(t,e,i)=>{u(),t=h.normalize(t),c.readFile(t,(function(t,n){t?i(t):e(n.buffer)}))},1<process.argv.length&&(f=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),process.on("unhandledRejection",(function(t){throw t})),m=(t,e)=>{if(P)throw process.exitCode=t,e;e instanceof gi||S("exiting due to exception: "+e),process.exit(t)},e.inspect=function(){return"[Emscripten Module object]"}):(g||y)&&(y?b=self.location.href:"undefined"!=typeof document&&document.currentScript&&(b=document.currentScript.src),i&&(b=i),b=0!==b.indexOf("blob:")?b.substr(0,b.replace(/[?#].*/,"").lastIndexOf("/")+1):"",o=t=>{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(null),e.responseText},y&&(l=t=>{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)}),s=(t,e,i)=>{var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="arraybuffer",n.onload=()=>{200==n.status||0==n.status&&n.response?e(n.response):i()},n.onerror=i,n.send(null)});var w=e.print||console.log.bind(console),S=e.printErr||console.warn.bind(console);Object.assign(e,d),d=null,e.thisProgram&&(f=e.thisProgram),e.quit&&(m=e.quit);var A,T=0;e.wasmBinary&&(A=e.wasmBinary);var P=e.noExitRuntime||!0;"object"!=typeof WebAssembly&&at("no native wasm support detected");var E,k=!1,M="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function x(t,e,i){var n=e+i;for(i=e;t[i]&&!(i>=n);)++i;if(16<i-e&&t.buffer&&M)return M.decode(t.subarray(e,i));for(n="";e<i;){var r=t[e++];if(128&r){var a=63&t[e++];if(192==(224&r))n+=String.fromCharCode((31&r)<<6|a);else{var o=63&t[e++];65536>(r=224==(240&r)?(15&r)<<12|a<<6|o:(7&r)<<18|a<<12|o<<6|63&t[e++])?n+=String.fromCharCode(r):(r-=65536,n+=String.fromCharCode(55296|r>>10,56320|1023&r))}}else n+=String.fromCharCode(r)}return n}function F(t,e){return t?x(D,t,e):""}function O(t,e,i,n){if(!(0<n))return 0;var r=i;n=i+n-1;for(var a=0;a<t.length;++a){var o=t.charCodeAt(a);if(55296<=o&&57343>=o&&(o=65536+((1023&o)<<10)|1023&t.charCodeAt(++a)),127>=o){if(i>=n)break;e[i++]=o}else{if(2047>=o){if(i+1>=n)break;e[i++]=192|o>>6}else{if(65535>=o){if(i+2>=n)break;e[i++]=224|o>>12}else{if(i+3>=n)break;e[i++]=240|o>>18,e[i++]=128|o>>12&63}e[i++]=128|o>>6&63}e[i++]=128|63&o}}return e[i]=0,i-r}function I(t){for(var e=0,i=0;i<t.length;++i){var n=t.charCodeAt(i);55296<=n&&57343>=n&&(n=65536+((1023&n)<<10)|1023&t.charCodeAt(++i)),127>=n?++e:e=2047>=n?e+2:65535>=n?e+3:e+4}return e}var R,B,D,L,N,G,U,W,z,j="undefined"!=typeof TextDecoder?new TextDecoder("utf-16le"):void 0;function H(t,e){for(var i=t>>1,n=i+e/2;!(i>=n)&&N[i];)++i;if(32<(i<<=1)-t&&j)return j.decode(D.subarray(t,i));for(i="",n=0;!(n>=e/2);++n){var r=L[t+2*n>>1];if(0==r)break;i+=String.fromCharCode(r)}return i}function $(t,e,i){if(void 0===i&&(i=2147483647),2>i)return 0;var n=e;i=(i-=2)<2*t.length?i/2:t.length;for(var r=0;r<i;++r)L[e>>1]=t.charCodeAt(r),e+=2;return L[e>>1]=0,e-n}function V(t){return 2*t.length}function q(t,e){for(var i=0,n="";!(i>=e/4);){var r=G[t+4*i>>2];if(0==r)break;++i,65536<=r?(r-=65536,n+=String.fromCharCode(55296|r>>10,56320|1023&r)):n+=String.fromCharCode(r)}return n}function Y(t,e,i){if(void 0===i&&(i=2147483647),4>i)return 0;var n=e;i=n+i-4;for(var r=0;r<t.length;++r){var a=t.charCodeAt(r);if(55296<=a&&57343>=a&&(a=65536+((1023&a)<<10)|1023&t.charCodeAt(++r)),G[e>>2]=a,(e+=4)+4>i)break}return G[e>>2]=0,e-n}function X(t){for(var e=0,i=0;i<t.length;++i){var n=t.charCodeAt(i);55296<=n&&57343>=n&&++i,e+=4}return e}function K(){var t=E.buffer;R=t,e.HEAP8=B=new Int8Array(t),e.HEAP16=L=new Int16Array(t),e.HEAP32=G=new Int32Array(t),e.HEAPU8=D=new Uint8Array(t),e.HEAPU16=N=new Uint16Array(t),e.HEAPU32=U=new Uint32Array(t),e.HEAPF32=W=new Float32Array(t),e.HEAPF64=z=new Float64Array(t)}var Q,J=[],Z=[],tt=[];function et(){var t=e.preRun.shift();J.unshift(t)}var it,nt=0,rt=null;function at(t){throw e.onAbort&&e.onAbort(t),S(t="Aborted("+t+")"),k=!0,t=new WebAssembly.RuntimeError(t+". Build with -sASSERTIONS for more info."),r(t),t}function ot(){return it.startsWith("data:application/octet-stream;base64,")}if(it="canvaskit.wasm",!ot()){var st=it;it=e.locateFile?e.locateFile(st,b):b+st}function lt(){var t=it;try{if(t==it&&A)return new Uint8Array(A);if(l)return l(t);throw"both async and sync fetching of the wasm failed"}catch(t){at(t)}}function ct(t){for(;0<t.length;)t.shift()(e)}function ht(t){return Q.get(t)}var ut={};function dt(t){for(;t.length;){var e=t.pop();t.pop()(e)}}function ft(t){return this.fromWireType(G[t>>2])}var pt={},mt={},gt={};function yt(t){if(void 0===t)return"_unknown";var e=(t=t.replace(/[^a-zA-Z0-9_]/g,"$")).charCodeAt(0);return 48<=e&&57>=e?"_"+t:t}function vt(t,e){return t=yt(t),function(){return e.apply(this,arguments)}}function bt(t){var e=Error,i=vt(t,(function(e){this.name=t,this.message=e,void 0!==(e=Error(e).stack)&&(this.stack=this.toString()+"\n"+e.replace(/^Error(:[^\n]*)?\n/,""))}));return i.prototype=Object.create(e.prototype),i.prototype.constructor=i,i.prototype.toString=function(){return void 0===this.message?this.name:this.name+": "+this.message},i}var wt=void 0;function St(t){throw new wt(t)}function _t(t,e,i){function n(e){(e=i(e)).length!==t.length&&St("Mismatched type converter count");for(var n=0;n<t.length;++n)kt(t[n],e[n])}t.forEach((function(t){gt[t]=e}));var r=Array(e.length),a=[],o=0;e.forEach(((t,e)=>{mt.hasOwnProperty(t)?r[e]=mt[t]:(a.push(t),pt.hasOwnProperty(t)||(pt[t]=[]),pt[t].push((()=>{r[e]=mt[t],++o===a.length&&n(r)})))})),0===a.length&&n(r)}function Ct(t){switch(t){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+t)}}var At=void 0;function Tt(t){for(var e="";D[t];)e+=At[D[t++]];return e}var Pt=void 0;function Et(t){throw new Pt(t)}function kt(t,e,i={}){if(!("argPackAdvance"in e))throw new TypeError("registerType registeredInstance requires argPackAdvance");var n=e.name;if(t||Et('type "'+n+'" must have a positive integer typeid pointer'),mt.hasOwnProperty(t)){if(i.Wf)return;Et("Cannot register type '"+n+"' twice")}mt[t]=e,delete gt[t],pt.hasOwnProperty(t)&&(e=pt[t],delete pt[t],e.forEach((t=>t())))}function Mt(t){Et(t.Md.Yd.Td.name+" instance already deleted")}var xt=!1;function Ft(){}function Ot(t){--t.count.value,0===t.count.value&&(t.ae?t.ge.me(t.ae):t.Yd.Td.me(t.Vd))}function It(t,e,i){return e===i?t:void 0===i.je||null===(t=It(t,e,i.je))?null:i.Kf(t)}var Rt={},Bt=[];function Dt(){for(;Bt.length;){var t=Bt.pop();t.Md.Ge=!1,t.delete()}}var Lt=void 0,Nt={};function Gt(t,e){return e.Yd&&e.Vd||St("makeClassHandle requires ptr and ptrType"),!!e.ge!=!!e.ae&&St("Both smartPtrType and smartPtr must be specified"),e.count={value:1},Ut(Object.create(t,{Md:{value:e}}))}function Ut(t){return"undefined"==typeof FinalizationRegistry?(Ut=t=>t,t):(xt=new FinalizationRegistry((t=>{Ot(t.Md)})),Ft=t=>{xt.unregister(t)},(Ut=t=>{var e=t.Md;return e.ae&&xt.register(t,{Md:e},t),t})(t))}function Wt(){}function zt(t,e,i){if(void 0===t[e].$d){var n=t[e];t[e]=function(){return t[e].$d.hasOwnProperty(arguments.length)||Et("Function '"+i+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+t[e].$d+")!"),t[e].$d[arguments.length].apply(this,arguments)},t[e].$d=[],t[e].$d[n.Ee]=n}}function jt(t,i,n){e.hasOwnProperty(t)?((void 0===n||void 0!==e[t].$d&&void 0!==e[t].$d[n])&&Et("Cannot register public name '"+t+"' twice"),zt(e,t,t),e.hasOwnProperty(n)&&Et("Cannot register multiple overloads of a function with the same number of arguments ("+n+")!"),e[t].$d[n]=i):(e[t]=i,void 0!==n&&(e[t].ug=n))}function Ht(t,e,i,n,r,a,o,s){this.name=t,this.constructor=e,this.He=i,this.me=n,this.je=r,this.Qf=a,this.Pe=o,this.Kf=s,this.cg=[]}function $t(t,e,i){for(;e!==i;)e.Pe||Et("Expected null or instance of "+i.name+", got an instance of "+e.name),t=e.Pe(t),e=e.je;return t}function Vt(t,e){return null===e?(this.gf&&Et("null is not a valid "+this.name),0):(e.Md||Et('Cannot pass "'+he(e)+'" as a '+this.name),e.Md.Vd||Et("Cannot pass deleted object as a pointer of type "+this.name),$t(e.Md.Vd,e.Md.Yd.Td,this.Td))}function qt(t,e){if(null===e){if(this.gf&&Et("null is not a valid "+this.name),this.Ue){var i=this.hf();return null!==t&&t.push(this.me,i),i}return 0}if(e.Md||Et('Cannot pass "'+he(e)+'" as a '+this.name),e.Md.Vd||Et("Cannot pass deleted object as a pointer of type "+this.name),!this.Te&&e.Md.Yd.Te&&Et("Cannot convert argument of type "+(e.Md.ge?e.Md.ge.name:e.Md.Yd.name)+" to parameter type "+this.name),i=$t(e.Md.Vd,e.Md.Yd.Td,this.Td),this.Ue)switch(void 0===e.Md.ae&&Et("Passing raw pointer to smart pointer is illegal"),this.ig){case 0:e.Md.ge===this?i=e.Md.ae:Et("Cannot convert argument of type "+(e.Md.ge?e.Md.ge.name:e.Md.Yd.name)+" to parameter type "+this.name);break;case 1:i=e.Md.ae;break;case 2:if(e.Md.ge===this)i=e.Md.ae;else{var n=e.clone();i=this.dg(i,se((function(){n.delete()}))),null!==t&&t.push(this.me,i)}break;default:Et("Unsupporting sharing policy")}return i}function Yt(t,e){return null===e?(this.gf&&Et("null is not a valid "+this.name),0):(e.Md||Et('Cannot pass "'+he(e)+'" as a '+this.name),e.Md.Vd||Et("Cannot pass deleted object as a pointer of type "+this.name),e.Md.Yd.Te&&Et("Cannot convert argument of type "+e.Md.Yd.name+" to parameter type "+this.name),$t(e.Md.Vd,e.Md.Yd.Td,this.Td))}function Xt(t,e,i,n,r,a,o,s,l,c,h){this.name=t,this.Td=e,this.gf=i,this.Te=n,this.Ue=r,this.bg=a,this.ig=o,this.wf=s,this.hf=l,this.dg=c,this.me=h,r||void 0!==e.je?this.toWireType=qt:(this.toWireType=n?Vt:Yt,this.fe=null)}function Kt(t,i,n){e.hasOwnProperty(t)||St("Replacing nonexistant public symbol"),void 0!==e[t].$d&&void 0!==n?e[t].$d[n]=i:(e[t]=i,e[t].Ee=n)}function Qt(t,i){var n=(t=Tt(t)).includes("j")?function(t,i){var n=[];return function(){if(n.length=0,Object.assign(n,arguments),t.includes("j")){var r=e["dynCall_"+t];r=n&&n.length?r.apply(null,[i].concat(n)):r.call(null,i)}else r=ht(i).apply(null,n);return r}}(t,i):ht(i);return"function"!=typeof n&&Et("unknown function pointer with signature "+t+": "+i),n}var Jt=void 0;function Zt(t){var e=Tt(t=ui(t));return hi(t),e}function te(t,e){var i=[],n={};throw e.forEach((function t(e){n[e]||mt[e]||(gt[e]?gt[e].forEach(t):(i.push(e),n[e]=!0))})),new Jt(t+": "+i.map(Zt).join([", "]))}function ee(t,e,i,n,r){var a=e.length;2>a&&Et("argTypes array size mismatch! Must at least get return value and 'this' types!");var o=null!==e[1]&&null!==i,s=!1;for(i=1;i<e.length;++i)if(null!==e[i]&&void 0===e[i].fe){s=!0;break}var l="void"!==e[0].name,c=a-2,h=Array(c),u=[],d=[];return function(){if(arguments.length!==c&&Et("function "+t+" called with "+arguments.length+" arguments, expected "+c+" args!"),d.length=0,u.length=o?2:1,u[0]=r,o){var i=e[1].toWireType(d,this);u[1]=i}for(var a=0;a<c;++a)h[a]=e[a+2].toWireType(d,arguments[a]),u.push(h[a]);if(a=n.apply(null,u),s)dt(d);else for(var f=o?1:2;f<e.length;f++){var p=1===f?i:h[f-2];null!==e[f].fe&&e[f].fe(p)}return l?e[0].fromWireType(a):void 0}}function ie(t,e){for(var i=[],n=0;n<t;n++)i.push(U[e+4*n>>2]);return i}var ne=[],re=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function ae(t){4<t&&0==--re[t].jf&&(re[t]=void 0,ne.push(t))}var oe=t=>(t||Et("Cannot use deleted val. handle = "+t),re[t].value),se=t=>{switch(t){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:var e=ne.length?ne.pop():re.length;return re[e]={jf:1,value:t},e}};function le(t,e,i){switch(e){case 0:return function(t){return this.fromWireType((i?B:D)[t])};case 1:return function(t){return this.fromWireType((i?L:N)[t>>1])};case 2:return function(t){return this.fromWireType((i?G:U)[t>>2])};default:throw new TypeError("Unknown integer type: "+t)}}function ce(t,e){var i=mt[t];return void 0===i&&Et(e+" has unknown type "+Zt(t)),i}function he(t){if(null===t)return"null";var e=typeof t;return"object"===e||"array"===e||"function"===e?t.toString():""+t}function ue(t,e){switch(e){case 2:return function(t){return this.fromWireType(W[t>>2])};case 3:return function(t){return this.fromWireType(z[t>>3])};default:throw new TypeError("Unknown float type: "+t)}}function de(t,e,i){switch(e){case 0:return i?function(t){return B[t]}:function(t){return D[t]};case 1:return i?function(t){return L[t>>1]}:function(t){return N[t>>1]};case 2:return i?function(t){return G[t>>2]}:function(t){return U[t>>2]};default:throw new TypeError("Unknown integer type: "+t)}}var fe={};function pe(t){var e=fe[t];return void 0===e?Tt(t):e}var me=[];function ge(){function t(t){t.$$$embind_global$$$=t;var e="object"==typeof $$$embind_global$$$&&t.$$$embind_global$$$==t;return e||delete t.$$$embind_global$$$,e}if("object"==typeof globalThis)return globalThis;if("object"==typeof $$$embind_global$$$)return $$$embind_global$$$;if("object"==typeof p&&t(p)?$$$embind_global$$$=p:"object"==typeof self&&t(self)&&($$$embind_global$$$=self),"object"==typeof $$$embind_global$$$)return $$$embind_global$$$;throw Error("unable to get global object.")}var ye,ve=[],be={};ye=v?()=>{var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}:()=>performance.now();var we=1,Se=[],_e=[],Ce=[],Ae=[],Te=[],Pe=[],Ee=[],ke=[],Me=[],xe=[],Fe={},Oe={},Ie=4;function Re(t){Ne||(Ne=t)}function Be(t){for(var e=we++,i=t.length;i<e;i++)t[i]=null;return e}function De(t){return Le=ke[t],e.sg=ri=Le&&Le.he,!(t&&!ri)}var Le,Ne,Ge=[];function Ue(t,e,i,n){for(var r=0;r<t;r++){var a=ri[i](),o=a&&Be(n);a?(a.name=o,n[o]=a):Re(1282),G[e+4*r>>2]=o}}function We(t,e,i){if(e){var n=void 0;switch(t){case 36346:n=1;break;case 36344:return void(0!=i&&1!=i&&Re(1280));case 34814:case 36345:n=0;break;case 34466:var r=ri.getParameter(34467);n=r?r.length:0;break;case 33309:if(2>Le.version)return void Re(1282);n=2*(ri.getSupportedExtensions()||[]).length;break;case 33307:case 33308:if(2>Le.version)return void Re(1280);n=33307==t?3:0}if(void 0===n)switch(r=ri.getParameter(t),typeof r){case"number":n=r;break;case"boolean":n=r?1:0;break;case"string":return void Re(1280);case"object":if(null===r)switch(t){case 34964:case 35725:case 34965:case 36006:case 36007:case 32873:case 34229:case 36662:case 36663:case 35053:case 35055:case 36010:case 35097:case 35869:case 32874:case 36389:case 35983:case 35368:case 34068:n=0;break;default:return void Re(1280)}else{if(r instanceof Float32Array||r instanceof Uint32Array||r instanceof Int32Array||r instanceof Array){for(t=0;t<r.length;++t)switch(i){case 0:G[e+4*t>>2]=r[t];break;case 2:W[e+4*t>>2]=r[t];break;case 4:B[e+t>>0]=r[t]?1:0}return}try{n=0|r.name}catch(e){return Re(1280),void S("GL_INVALID_ENUM in glGet"+i+"v: Unknown object returned from WebGL getParameter("+t+")! (error: "+e+")")}}break;default:return Re(1280),void S("GL_INVALID_ENUM in glGet"+i+"v: Native code calling glGet"+i+"v("+t+") and it returns "+r+" of type "+typeof r+"!")}switch(i){case 1:i=n,U[e>>2]=i,U[e+4>>2]=(i-U[e>>2])/4294967296;break;case 0:G[e>>2]=n;break;case 2:W[e>>2]=n;break;case 4:B[e>>0]=n?1:0}}else Re(1281)}function ze(t){var e=I(t)+1,i=ci(e);return O(t,D,i,e),i}function je(t){return"]"==t.slice(-1)&&t.lastIndexOf("[")}function He(t){return 0==(t-=5120)?B:1==t?D:2==t?L:4==t?G:6==t?W:5==t||28922==t||28520==t||30779==t||30782==t?U:N}function $e(t,e,i,n,r){t=He(t);var a=31-Math.clz32(t.BYTES_PER_ELEMENT),o=Ie;return t.subarray(r>>a,r+n*(i*({5:3,6:4,8:2,29502:3,29504:4,26917:2,26918:2,29846:3,29847:4}[e-6402]||1)*(1<<a)+o-1&-o)>>a)}function Ve(t){var e=ri.If;if(e){var i=e.Oe[t];return"number"==typeof i&&(e.Oe[t]=i=ri.getUniformLocation(e,e.xf[t]+(0<i?"["+i+"]":""))),i}Re(1282)}var qe=[],Ye=[],Xe={};function Ke(){if(!Qe){var t,e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:f||"./this.program"};for(t in Xe)void 0===Xe[t]?delete e[t]:e[t]=Xe[t];var i=[];for(t in e)i.push(t+"="+e[t]);Qe=i}return Qe}var Qe,Je=[null,[],[]];function Ze(t){return 0==t%4&&(0!=t%100||0==t%400)}var ti=[31,29,31,30,31,30,31,31,30,31,30,31],ei=[31,28,31,30,31,30,31,31,30,31,30,31];wt=e.InternalError=bt("InternalError");for(var ii=Array(256),ni=0;256>ni;++ni)ii[ni]=String.fromCharCode(ni);At=ii,Pt=e.BindingError=bt("BindingError"),Wt.prototype.isAliasOf=function(t){if(!(this instanceof Wt&&t instanceof Wt))return!1;var e=this.Md.Yd.Td,i=this.Md.Vd,n=t.Md.Yd.Td;for(t=t.Md.Vd;e.je;)i=e.Pe(i),e=e.je;for(;n.je;)t=n.Pe(t),n=n.je;return e===n&&i===t},Wt.prototype.clone=function(){if(this.Md.Vd||Mt(this),this.Md.Ne)return this.Md.count.value+=1,this;var t=Ut,e=Object,i=e.create,n=Object.getPrototypeOf(this),r=this.Md;return(t=t(i.call(e,n,{Md:{value:{count:r.count,Ge:r.Ge,Ne:r.Ne,Vd:r.Vd,Yd:r.Yd,ae:r.ae,ge:r.ge}}}))).Md.count.value+=1,t.Md.Ge=!1,t},Wt.prototype.delete=function(){this.Md.Vd||Mt(this),this.Md.Ge&&!this.Md.Ne&&Et("Object already scheduled for deletion"),Ft(this),Ot(this.Md),this.Md.Ne||(this.Md.ae=void 0,this.Md.Vd=void 0)},Wt.prototype.isDeleted=function(){return!this.Md.Vd},Wt.prototype.deleteLater=function(){return this.Md.Vd||Mt(this),this.Md.Ge&&!this.Md.Ne&&Et("Object already scheduled for deletion"),Bt.push(this),1===Bt.length&&Lt&&Lt(Dt),this.Md.Ge=!0,this},e.getInheritedInstanceCount=function(){return Object.keys(Nt).length},e.getLiveInheritedInstances=function(){var t,e=[];for(t in Nt)Nt.hasOwnProperty(t)&&e.push(Nt[t]);return e},e.flushPendingDeletes=Dt,e.setDelayFunction=function(t){Lt=t,Bt.length&&Lt&&Lt(Dt)},Xt.prototype.Rf=function(t){return this.wf&&(t=this.wf(t)),t},Xt.prototype.qf=function(t){this.me&&this.me(t)},Xt.prototype.argPackAdvance=8,Xt.prototype.readValueFromPointer=ft,Xt.prototype.deleteObject=function(t){null!==t&&t.delete()},Xt.prototype.fromWireType=function(t){function e(){return this.Ue?Gt(this.Td.He,{Yd:this.bg,Vd:i,ge:this,ae:t}):Gt(this.Td.He,{Yd:this,Vd:t})}var i=this.Rf(t);if(!i)return this.qf(t),null;var n=function(t,e){for(void 0===e&&Et("ptr should not be undefined");t.je;)e=t.Pe(e),t=t.je;return Nt[e]}(this.Td,i);if(void 0!==n)return 0===n.Md.count.value?(n.Md.Vd=i,n.Md.ae=t,n.clone()):(n=n.clone(),this.qf(t),n);if(n=this.Td.Qf(i),!(n=Rt[n]))return e.call(this);n=this.Te?n.Gf:n.pointerType;var r=It(i,this.Td,n.Td);return null===r?e.call(this):this.Ue?Gt(n.Td.He,{Yd:n,Vd:r,ge:this,ae:t}):Gt(n.Td.He,{Yd:n,Vd:r})},Jt=e.UnboundTypeError=bt("UnboundTypeError"),e.count_emval_handles=function(){for(var t=0,e=5;e<re.length;++e)void 0!==re[e]&&++t;return t},e.get_first_emval=function(){for(var t=5;t<re.length;++t)if(void 0!==re[t])return re[t];return null};for(var ri,ai=0;32>ai;++ai)Ge.push(Array(ai));var oi=new Float32Array(288);for(ai=0;288>ai;++ai)qe[ai]=oi.subarray(0,ai+1);var si=new Int32Array(288);for(ai=0;288>ai;++ai)Ye[ai]=si.subarray(0,ai+1);var li={V:function(){return 0},Bb:function(){},Db:function(){return 0},yb:function(){},zb:function(){},W:function(){},Ab:function(){},D:function(t){var e=ut[t];delete ut[t];var i=e.hf,n=e.me,r=e.tf;_t([t],r.map((t=>t.Uf)).concat(r.map((t=>t.gg))),(t=>{var a={};return r.forEach(((e,i)=>{var n=t[i],o=e.Sf,s=e.Tf,l=t[i+r.length],c=e.fg,h=e.hg;a[e.Mf]={read:t=>n.fromWireType(o(s,t)),write:(t,e)=>{var i=[];c(h,t,l.toWireType(i,e)),dt(i)}}})),[{name:e.name,fromWireType:function(t){var e,i={};for(e in a)i[e]=a[e].read(t);return n(t),i},toWireType:function(t,e){for(var r in a)if(!(r in e))throw new TypeError('Missing field:  "'+r+'"');var o=i();for(r in a)a[r].write(o,e[r]);return null!==t&&t.push(n,o),o},argPackAdvance:8,readValueFromPointer:ft,fe:n}]}))},qb:function(){},Hb:function(t,e,i,n,r){var a=Ct(i);kt(t,{name:e=Tt(e),fromWireType:function(t){return!!t},toWireType:function(t,e){return e?n:r},argPackAdvance:8,readValueFromPointer:function(t){if(1===i)var n=B;else if(2===i)n=L;else{if(4!==i)throw new TypeError("Unknown boolean type size: "+e);n=G}return this.fromWireType(n[t>>a])},fe:null})},p:function(t,e,i,n,r,a,o,s,l,c,h,u,d){h=Tt(h),a=Qt(r,a),s&&(s=Qt(o,s)),c&&(c=Qt(l,c)),d=Qt(u,d);var f=yt(h);jt(f,(function(){te("Cannot construct "+h+" due to unbound types",[n])})),_t([t,e,i],n?[n]:[],(function(e){if(e=e[0],n)var i=e.Td,r=i.He;else r=Wt.prototype;e=vt(f,(function(){if(Object.getPrototypeOf(this)!==o)throw new Pt("Use 'new' to construct "+h);if(void 0===l.pe)throw new Pt(h+" has no accessible constructor");var t=l.pe[arguments.length];if(void 0===t)throw new Pt("Tried to invoke ctor of "+h+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(l.pe).toString()+") parameters instead!");return t.apply(this,arguments)}));var o=Object.create(r,{constructor:{value:e}});e.prototype=o;var l=new Ht(h,e,o,d,i,a,s,c);i=new Xt(h,l,!0,!1,!1),r=new Xt(h+"*",l,!1,!1,!1);var u=new Xt(h+" const*",l,!1,!0,!1);return Rt[t]={pointerType:r,Gf:u},Kt(f,e),[i,r,u]}))},i:function(t,e,i,n,r,a,o){var s=ie(i,n);e=Tt(e),a=Qt(r,a),_t([],[t],(function(t){function n(){te("Cannot call "+r+" due to unbound types",s)}var r=(t=t[0]).name+"."+e;e.startsWith("@@")&&(e=Symbol[e.substring(2)]);var l=t.Td.constructor;return void 0===l[e]?(n.Ee=i-1,l[e]=n):(zt(l,e,r),l[e].$d[i-1]=n),_t([],s,(function(t){return t=[t[0],null].concat(t.slice(1)),t=ee(r,t,null,a,o),void 0===l[e].$d?(t.Ee=i-1,l[e]=t):l[e].$d[i-1]=t,[]})),[]}))},F:function(t,e,i,n,r,a){0<e||at();var o=ie(e,i);r=Qt(n,r),_t([],[t],(function(t){var i="constructor "+(t=t[0]).name;if(void 0===t.Td.pe&&(t.Td.pe=[]),void 0!==t.Td.pe[e-1])throw new Pt("Cannot register multiple constructors with identical number of parameters ("+(e-1)+") for class '"+t.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return t.Td.pe[e-1]=()=>{te("Cannot construct "+t.name+" due to unbound types",o)},_t([],o,(function(n){return n.splice(1,0,null),t.Td.pe[e-1]=ee(i,n,null,r,a),[]})),[]}))},b:function(t,e,i,n,r,a,o,s){var l=ie(i,n);e=Tt(e),a=Qt(r,a),_t([],[t],(function(t){function n(){te("Cannot call "+r+" due to unbound types",l)}var r=(t=t[0]).name+"."+e;e.startsWith("@@")&&(e=Symbol[e.substring(2)]),s&&t.Td.cg.push(e);var c=t.Td.He,h=c[e];return void 0===h||void 0===h.$d&&h.className!==t.name&&h.Ee===i-2?(n.Ee=i-2,n.className=t.name,c[e]=n):(zt(c,e,r),c[e].$d[i-2]=n),_t([],l,(function(n){return n=ee(r,n,t,a,o),void 0===c[e].$d?(n.Ee=i-2,c[e]=n):c[e].$d[i-2]=n,[]})),[]}))},u:function(t,i,n){t=Tt(t),_t([],[i],(function(i){return i=i[0],e[t]=i.fromWireType(n),[]}))},Gb:function(t,e){kt(t,{name:e=Tt(e),fromWireType:function(t){var e=oe(t);return ae(t),e},toWireType:function(t,e){return se(e)},argPackAdvance:8,readValueFromPointer:ft,fe:null})},o:function(t,e,i,n){function r(){}i=Ct(i),e=Tt(e),r.values={},kt(t,{name:e,constructor:r,fromWireType:function(t){return this.constructor.values[t]},toWireType:function(t,e){return e.value},argPackAdvance:8,readValueFromPointer:le(e,i,n),fe:null}),jt(e,r)},f:function(t,e,i){var n=ce(t,"enum");e=Tt(e),t=n.constructor,n=Object.create(n.constructor.prototype,{value:{value:i},constructor:{value:vt(n.name+"_"+e,(function(){}))}}),t.values[i]=n,t[e]=n},Z:function(t,e,i){i=Ct(i),kt(t,{name:e=Tt(e),fromWireType:function(t){return t},toWireType:function(t,e){return e},argPackAdvance:8,readValueFromPointer:ue(e,i),fe:null})},y:function(t,e,i,n,r,a){var o=ie(e,i);t=Tt(t),r=Qt(n,r),jt(t,(function(){te("Cannot call "+t+" due to unbound types",o)}),e-1),_t([],o,(function(i){return i=[i[0],null].concat(i.slice(1)),Kt(t,ee(t,i,null,r,a),e-1),[]}))},H:function(t,e,i,n,r){e=Tt(e),-1===r&&(r=4294967295),r=Ct(i);var a=t=>t;if(0===n){var o=32-8*i;a=t=>t<<o>>>o}i=e.includes("unsigned")?function(t,e){return e>>>0}:function(t,e){return e},kt(t,{name:e,fromWireType:a,toWireType:i,argPackAdvance:8,readValueFromPointer:de(e,r,0!==n),fe:null})},x:function(t,e,i){function n(t){var e=U;return new r(R,e[1+(t>>=2)],e[t])}var r=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][e];kt(t,{name:i=Tt(i),fromWireType:n,argPackAdvance:8,readValueFromPointer:n},{Wf:!0})},t:function(t,e,i,n,r,a,o,s,l,c,h,u){i=Tt(i),a=Qt(r,a),s=Qt(o,s),c=Qt(l,c),u=Qt(h,u),_t([t],[e],(function(t){return t=t[0],[new Xt(i,t.Td,!1,!1,!0,t,n,a,s,c,u)]}))},Y:function(t,e){var i="std::string"===(e=Tt(e));kt(t,{name:e,fromWireType:function(t){var e=U[t>>2],n=t+4;if(i)for(var r=n,a=0;a<=e;++a){var o=n+a;if(a==e||0==D[o]){if(r=F(r,o-r),void 0===s)var s=r;else s+=String.fromCharCode(0),s+=r;r=o+1}}else{for(s=Array(e),a=0;a<e;++a)s[a]=String.fromCharCode(D[n+a]);s=s.join("")}return hi(t),s},toWireType:function(t,e){e instanceof ArrayBuffer&&(e=new Uint8Array(e));var n="string"==typeof e;n||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int8Array||Et("Cannot pass non-string to std::string");var r=i&&n?I(e):e.length,a=ci(4+r+1),o=a+4;if(U[a>>2]=r,i&&n)O(e,D,o,r+1);else if(n)for(n=0;n<r;++n){var s=e.charCodeAt(n);255<s&&(hi(o),Et("String has UTF-16 code units that do not fit in 8 bits")),D[o+n]=s}else for(n=0;n<r;++n)D[o+n]=e[n];return null!==t&&t.push(hi,a),a},argPackAdvance:8,readValueFromPointer:ft,fe:function(t){hi(t)}})},Q:function(t,e,i){if(i=Tt(i),2===e)var n=H,r=$,a=V,o=()=>N,s=1;else 4===e&&(n=q,r=Y,a=X,o=()=>U,s=2);kt(t,{name:i,fromWireType:function(t){for(var i,r=U[t>>2],a=o(),l=t+4,c=0;c<=r;++c){var h=t+4+c*e;c!=r&&0!=a[h>>s]||(l=n(l,h-l),void 0===i?i=l:(i+=String.fromCharCode(0),i+=l),l=h+e)}return hi(t),i},toWireType:function(t,n){"string"!=typeof n&&Et("Cannot pass non-string to C++ string type "+i);var o=a(n),l=ci(4+o+e);return U[l>>2]=o>>s,r(n,l+4,o+e),null!==t&&t.push(hi,l),l},argPackAdvance:8,readValueFromPointer:ft,fe:function(t){hi(t)}})},E:function(t,e,i,n,r,a){ut[t]={name:Tt(e),hf:Qt(i,n),me:Qt(r,a),tf:[]}},g:function(t,e,i,n,r,a,o,s,l,c){ut[t].tf.push({Mf:Tt(e),Uf:i,Sf:Qt(n,r),Tf:a,gg:o,fg:Qt(s,l),hg:c})},Ib:function(t,e){kt(t,{Yf:!0,name:e=Tt(e),argPackAdvance:0,fromWireType:function(){},toWireType:function(){}})},Fb:function(){return!0},sb:function(){throw 1/0},G:function(t,e,i){t=oe(t),e=ce(e,"emval::as");var n=[],r=se(n);return U[i>>2]=r,e.toWireType(n,t)},M:function(t,e,i,n,r){t=me[t],e=oe(e),i=pe(i);var a=[];return U[n>>2]=se(a),t(e,i,a,r)},z:function(t,e,i,n){(t=me[t])(e=oe(e),i=pe(i),null,n)},e:ae,L:function(t){return 0===t?se(ge()):(t=pe(t),se(ge()[t]))},v:function(t,e){var i=function(t,e){for(var i=Array(t),n=0;n<t;++n)i[n]=ce(U[e+4*n>>2],"parameter "+n);return i}(t,e),n=i[0];e=n.name+"_$"+i.slice(1).map((function(t){return t.name})).join("_")+"$";var r=ve[e];if(void 0!==r)return r;var a=Array(t-1);return r=function(t){var e=me.length;return me.push(t),e}(((e,r,o,s)=>{for(var l=0,c=0;c<t-1;++c)a[c]=i[c+1].readValueFromPointer(s+l),l+=i[c+1].argPackAdvance;for(e=e[r].apply(e,a),c=0;c<t-1;++c)i[c+1].Jf&&i[c+1].Jf(a[c]);if(!n.Yf)return n.toWireType(o,e)})),ve[e]=r},I:function(t,e){return t=oe(t),e=oe(e),se(t[e])},r:function(t){4<t&&(re[t].jf+=1)},N:function(t,e,i,n){t=oe(t);var r=be[e];return r||(r=function(t){var e=Array(t+1);return function(i,n,r){e[0]=i;for(var a=0;a<t;++a){var o=ce(U[n+4*a>>2],"parameter "+a);e[a+1]=o.readValueFromPointer(r),r+=o.argPackAdvance}return i=new(i.bind.apply(i,e)),se(i)}}(e),be[e]=r),r(t,i,n)},J:function(){return se([])},h:function(t){return se(pe(t))},C:function(){return se({})},mb:function(t){return!(t=oe(t))},B:function(t){dt(oe(t)),ae(t)},k:function(t,e,i){t=oe(t),e=oe(e),i=oe(i),t[e]=i},j:function(t,e){return t=(t=ce(t,"_emval_take_value")).readValueFromPointer(e),se(t)},ub:function(){return-52},vb:function(){},a:function(){at("")},Eb:ye,bd:function(t){ri.activeTexture(t)},cd:function(t,e){ri.attachShader(_e[t],Pe[e])},ca:function(t,e,i){ri.bindAttribLocation(_e[t],e,F(i))},da:function(t,e){35051==t?ri.df=e:35052==t&&(ri.Fe=e),ri.bindBuffer(t,Se[e])},ba:function(t,e){ri.bindFramebuffer(t,Ce[e])},fc:function(t,e){ri.bindRenderbuffer(t,Ae[e])},Rb:function(t,e){ri.bindSampler(t,Me[e])},ea:function(t,e){ri.bindTexture(t,Te[e])},zc:function(t){ri.bindVertexArray(Ee[t])},Cc:function(t){ri.bindVertexArray(Ee[t])},fa:function(t,e,i,n){ri.blendColor(t,e,i,n)},ga:function(t){ri.blendEquation(t)},ha:function(t,e){ri.blendFunc(t,e)},$b:function(t,e,i,n,r,a,o,s,l,c){ri.blitFramebuffer(t,e,i,n,r,a,o,s,l,c)},ia:function(t,e,i,n){2<=Le.version?i&&e?ri.bufferData(t,D,n,i,e):ri.bufferData(t,e,n):ri.bufferData(t,i?D.subarray(i,i+e):e,n)},ja:function(t,e,i,n){2<=Le.version?i&&ri.bufferSubData(t,e,D,n,i):ri.bufferSubData(t,e,D.subarray(n,n+i))},gc:function(t){return ri.checkFramebufferStatus(t)},T:function(t){ri.clear(t)},aa:function(t,e,i,n){ri.clearColor(t,e,i,n)},X:function(t){ri.clearStencil(t)},kb:function(t,e,i,n){return ri.clientWaitSync(xe[t],e,(i>>>0)+4294967296*n)},ka:function(t,e,i,n){ri.colorMask(!!t,!!e,!!i,!!n)},la:function(t){ri.compileShader(Pe[t])},ma:function(t,e,i,n,r,a,o,s){2<=Le.version?ri.Fe||!o?ri.compressedTexImage2D(t,e,i,n,r,a,o,s):ri.compressedTexImage2D(t,e,i,n,r,a,D,s,o):ri.compressedTexImage2D(t,e,i,n,r,a,s?D.subarray(s,s+o):null)},na:function(t,e,i,n,r,a,o,s,l){2<=Le.version?ri.Fe||!s?ri.compressedTexSubImage2D(t,e,i,n,r,a,o,s,l):ri.compressedTexSubImage2D(t,e,i,n,r,a,o,D,l,s):ri.compressedTexSubImage2D(t,e,i,n,r,a,o,l?D.subarray(l,l+s):null)},Zb:function(t,e,i,n,r){ri.copyBufferSubData(t,e,i,n,r)},oa:function(t,e,i,n,r,a,o,s){ri.copyTexSubImage2D(t,e,i,n,r,a,o,s)},pa:function(){var t=Be(_e),e=ri.createProgram();return e.name=t,e.Xe=e.Ve=e.We=0,e.lf=1,_e[t]=e,t},qa:function(t){var e=Be(Pe);return Pe[e]=ri.createShader(t),e},ra:function(t){ri.cullFace(t)},sa:function(t,e){for(var i=0;i<t;i++){var n=G[e+4*i>>2],r=Se[n];r&&(ri.deleteBuffer(r),r.name=0,Se[n]=null,n==ri.df&&(ri.df=0),n==ri.Fe&&(ri.Fe=0))}},hc:function(t,e){for(var i=0;i<t;++i){var n=G[e+4*i>>2],r=Ce[n];r&&(ri.deleteFramebuffer(r),r.name=0,Ce[n]=null)}},ta:function(t){if(t){var e=_e[t];e?(ri.deleteProgram(e),e.name=0,_e[t]=null):Re(1281)}},ic:function(t,e){for(var i=0;i<t;i++){var n=G[e+4*i>>2],r=Ae[n];r&&(ri.deleteRenderbuffer(r),r.name=0,Ae[n]=null)}},Sb:function(t,e){for(var i=0;i<t;i++){var n=G[e+4*i>>2],r=Me[n];r&&(ri.deleteSampler(r),r.name=0,Me[n]=null)}},ua:function(t){if(t){var e=Pe[t];e?(ri.deleteShader(e),Pe[t]=null):Re(1281)}},_b:function(t){if(t){var e=xe[t];e?(ri.deleteSync(e),e.name=0,xe[t]=null):Re(1281)}},va:function(t,e){for(var i=0;i<t;i++){var n=G[e+4*i>>2],r=Te[n];r&&(ri.deleteTexture(r),r.name=0,Te[n]=null)}},Ac:function(t,e){for(var i=0;i<t;i++){var n=G[e+4*i>>2];ri.deleteVertexArray(Ee[n]),Ee[n]=null}},Dc:function(t,e){for(var i=0;i<t;i++){var n=G[e+4*i>>2];ri.deleteVertexArray(Ee[n]),Ee[n]=null}},wa:function(t){ri.depthMask(!!t)},xa:function(t){ri.disable(t)},ya:function(t){ri.disableVertexAttribArray(t)},za:function(t,e,i){ri.drawArrays(t,e,i)},xc:function(t,e,i,n){ri.drawArraysInstanced(t,e,i,n)},vc:function(t,e,i,n,r){ri.rf.drawArraysInstancedBaseInstanceWEBGL(t,e,i,n,r)},tc:function(t,e){for(var i=Ge[t],n=0;n<t;n++)i[n]=G[e+4*n>>2];ri.drawBuffers(i)},Aa:function(t,e,i,n){ri.drawElements(t,e,i,n)},yc:function(t,e,i,n,r){ri.drawElementsInstanced(t,e,i,n,r)},wc:function(t,e,i,n,r,a,o){ri.rf.drawElementsInstancedBaseVertexBaseInstanceWEBGL(t,e,i,n,r,a,o)},nc:function(t,e,i,n,r,a){ri.drawElements(t,n,r,a)},Ba:function(t){ri.enable(t)},Ca:function(t){ri.enableVertexAttribArray(t)},Xb:function(t,e){return(t=ri.fenceSync(t,e))?(e=Be(xe),t.name=e,xe[e]=t,e):0},Da:function(){ri.finish()},Ea:function(){ri.flush()},jc:function(t,e,i,n){ri.framebufferRenderbuffer(t,e,i,Ae[n])},kc:function(t,e,i,n,r){ri.framebufferTexture2D(t,e,i,Te[n],r)},Fa:function(t){ri.frontFace(t)},Ga:function(t,e){Ue(t,e,"createBuffer",Se)},lc:function(t,e){Ue(t,e,"createFramebuffer",Ce)},mc:function(t,e){Ue(t,e,"createRenderbuffer",Ae)},Tb:function(t,e){Ue(t,e,"createSampler",Me)},Ha:function(t,e){Ue(t,e,"createTexture",Te)},Bc:function(t,e){Ue(t,e,"createVertexArray",Ee)},Ec:function(t,e){Ue(t,e,"createVertexArray",Ee)},bc:function(t){ri.generateMipmap(t)},Ia:function(t,e,i){i?G[i>>2]=ri.getBufferParameter(t,e):Re(1281)},Ja:function(){var t=ri.getError()||Ne;return Ne=0,t},Ka:function(t,e){We(t,e,2)},cc:function(t,e,i,n){((t=ri.getFramebufferAttachmentParameter(t,e,i))instanceof WebGLRenderbuffer||t instanceof WebGLTexture)&&(t=0|t.name),G[n>>2]=t},O:function(t,e){We(t,e,0)},La:function(t,e,i,n){null===(t=ri.getProgramInfoLog(_e[t]))&&(t="(unknown error)"),e=0<e&&n?O(t,D,n,e):0,i&&(G[i>>2]=e)},Ma:function(t,e,i){if(i)if(t>=we)Re(1281);else if(t=_e[t],35716==e)null===(t=ri.getProgramInfoLog(t))&&(t="(unknown error)"),G[i>>2]=t.length+1;else if(35719==e){if(!t.Xe)for(e=0;e<ri.getProgramParameter(t,35718);++e)t.Xe=Math.max(t.Xe,ri.getActiveUniform(t,e).name.length+1);G[i>>2]=t.Xe}else if(35722==e){if(!t.Ve)for(e=0;e<ri.getProgramParameter(t,35721);++e)t.Ve=Math.max(t.Ve,ri.getActiveAttrib(t,e).name.length+1);G[i>>2]=t.Ve}else if(35381==e){if(!t.We)for(e=0;e<ri.getProgramParameter(t,35382);++e)t.We=Math.max(t.We,ri.getActiveUniformBlockName(t,e).length+1);G[i>>2]=t.We}else G[i>>2]=ri.getProgramParameter(t,e);else Re(1281)},dc:function(t,e,i){i?G[i>>2]=ri.getRenderbufferParameter(t,e):Re(1281)},Na:function(t,e,i,n){null===(t=ri.getShaderInfoLog(Pe[t]))&&(t="(unknown error)"),e=0<e&&n?O(t,D,n,e):0,i&&(G[i>>2]=e)},Ob:function(t,e,i,n){t=ri.getShaderPrecisionFormat(t,e),G[i>>2]=t.rangeMin,G[i+4>>2]=t.rangeMax,G[n>>2]=t.precision},Oa:function(t,e,i){i?35716==e?(null===(t=ri.getShaderInfoLog(Pe[t]))&&(t="(unknown error)"),G[i>>2]=t?t.length+1:0):35720==e?(t=ri.getShaderSource(Pe[t]),G[i>>2]=t?t.length+1:0):G[i>>2]=ri.getShaderParameter(Pe[t],e):Re(1281)},S:function(t){var e=Fe[t];if(!e){switch(t){case 7939:e=ze((e=(e=ri.getSupportedExtensions()||[]).concat(e.map((function(t){return"GL_"+t})))).join(" "));break;case 7936:case 7937:case 37445:case 37446:(e=ri.getParameter(t))||Re(1280),e=e&&ze(e);break;case 7938:e=ri.getParameter(7938),e=ze(e=2<=Le.version?"OpenGL ES 3.0 ("+e+")":"OpenGL ES 2.0 ("+e+")");break;case 35724:var i=(e=ri.getParameter(35724)).match(/^WebGL GLSL ES ([0-9]\.[0-9][0-9]?)(?:$| .*)/);null!==i&&(3==i[1].length&&(i[1]+="0"),e="OpenGL ES GLSL ES "+i[1]+" ("+e+")"),e=ze(e);break;default:Re(1280)}Fe[t]=e}return e},jb:function(t,e){if(2>Le.version)return Re(1282),0;var i=Oe[t];return i?0>e||e>=i.length?(Re(1281),0):i[e]:7939===t?(i=(i=(i=ri.getSupportedExtensions()||[]).concat(i.map((function(t){return"GL_"+t})))).map((function(t){return ze(t)})),i=Oe[t]=i,0>e||e>=i.length?(Re(1281),0):i[e]):(Re(1280),0)},Pa:function(t,e){if(e=F(e),t=_e[t]){var i,n=t,r=n.Oe,a=n.yf;if(!r)for(n.Oe=r={},n.xf={},i=0;i<ri.getProgramParameter(n,35718);++i){var o=ri.getActiveUniform(n,i),s=o.name;o=o.size;var l=je(s);l=0<l?s.slice(0,l):s;var c=n.lf;for(n.lf+=o,a[l]=[o,c],s=0;s<o;++s)r[c]=s,n.xf[c++]=l}if(n=t.Oe,r=0,a=e,0<(i=je(e))&&(r=parseInt(e.slice(i+1))>>>0,a=e.slice(0,i)),(a=t.yf[a])&&r<a[0]&&(n[r+=a[1]]=n[r]||ri.getUniformLocation(t,e)))return r}else Re(1281);return-1},Pb:function(t,e,i){for(var n=Ge[e],r=0;r<e;r++)n[r]=G[i+4*r>>2];ri.invalidateFramebuffer(t,n)},Qb:function(t,e,i,n,r,a,o){for(var s=Ge[e],l=0;l<e;l++)s[l]=G[i+4*l>>2];ri.invalidateSubFramebuffer(t,s,n,r,a,o)},Yb:function(t){return ri.isSync(xe[t])},Qa:function(t){return(t=Te[t])?ri.isTexture(t):0},Ra:function(t){ri.lineWidth(t)},Sa:function(t){t=_e[t],ri.linkProgram(t),t.Oe=0,t.yf={}},rc:function(t,e,i,n,r,a){ri.vf.multiDrawArraysInstancedBaseInstanceWEBGL(t,G,e>>2,G,i>>2,G,n>>2,U,r>>2,a)},sc:function(t,e,i,n,r,a,o,s){ri.vf.multiDrawElementsInstancedBaseVertexBaseInstanceWEBGL(t,G,e>>2,i,G,n>>2,G,r>>2,G,a>>2,U,o>>2,s)},Ta:function(t,e){3317==t&&(Ie=e),ri.pixelStorei(t,e)},uc:function(t){ri.readBuffer(t)},Ua:function(t,e,i,n,r,a,o){if(2<=Le.version)if(ri.df)ri.readPixels(t,e,i,n,r,a,o);else{var s=He(a);ri.readPixels(t,e,i,n,r,a,s,o>>31-Math.clz32(s.BYTES_PER_ELEMENT))}else(o=$e(a,r,i,n,o))?ri.readPixels(t,e,i,n,r,a,o):Re(1280)},ec:function(t,e,i,n){ri.renderbufferStorage(t,e,i,n)},ac:function(t,e,i,n,r){ri.renderbufferStorageMultisample(t,e,i,n,r)},Ub:function(t,e,i){ri.samplerParameterf(Me[t],e,i)},Vb:function(t,e,i){ri.samplerParameteri(Me[t],e,i)},Wb:function(t,e,i){ri.samplerParameteri(Me[t],e,G[i>>2])},Va:function(t,e,i,n){ri.scissor(t,e,i,n)},Wa:function(t,e,i,n){for(var r="",a=0;a<e;++a){var o=n?G[n+4*a>>2]:-1;r+=F(G[i+4*a>>2],0>o?void 0:o)}ri.shaderSource(Pe[t],r)},Xa:function(t,e,i){ri.stencilFunc(t,e,i)},Ya:function(t,e,i,n){ri.stencilFuncSeparate(t,e,i,n)},Za:function(t){ri.stencilMask(t)},_a:function(t,e){ri.stencilMaskSeparate(t,e)},$a:function(t,e,i){ri.stencilOp(t,e,i)},ab:function(t,e,i,n){ri.stencilOpSeparate(t,e,i,n)},bb:function(t,e,i,n,r,a,o,s,l){if(2<=Le.version)if(ri.Fe)ri.texImage2D(t,e,i,n,r,a,o,s,l);else if(l){var c=He(s);ri.texImage2D(t,e,i,n,r,a,o,s,c,l>>31-Math.clz32(c.BYTES_PER_ELEMENT))}else ri.texImage2D(t,e,i,n,r,a,o,s,null);else ri.texImage2D(t,e,i,n,r,a,o,s,l?$e(s,o,n,r,l):null)},cb:function(t,e,i){ri.texParameterf(t,e,i)},db:function(t,e,i){ri.texParameterf(t,e,W[i>>2])},eb:function(t,e,i){ri.texParameteri(t,e,i)},fb:function(t,e,i){ri.texParameteri(t,e,G[i>>2])},oc:function(t,e,i,n,r){ri.texStorage2D(t,e,i,n,r)},gb:function(t,e,i,n,r,a,o,s,l){if(2<=Le.version)if(ri.Fe)ri.texSubImage2D(t,e,i,n,r,a,o,s,l);else if(l){var c=He(s);ri.texSubImage2D(t,e,i,n,r,a,o,s,c,l>>31-Math.clz32(c.BYTES_PER_ELEMENT))}else ri.texSubImage2D(t,e,i,n,r,a,o,s,null);else c=null,l&&(c=$e(s,o,r,a,l)),ri.texSubImage2D(t,e,i,n,r,a,o,s,c)},hb:function(t,e){ri.uniform1f(Ve(t),e)},ib:function(t,e,i){if(2<=Le.version)e&&ri.uniform1fv(Ve(t),W,i>>2,e);else{if(288>=e)for(var n=qe[e-1],r=0;r<e;++r)n[r]=W[i+4*r>>2];else n=W.subarray(i>>2,i+4*e>>2);ri.uniform1fv(Ve(t),n)}},Zc:function(t,e){ri.uniform1i(Ve(t),e)},_c:function(t,e,i){if(2<=Le.version)e&&ri.uniform1iv(Ve(t),G,i>>2,e);else{if(288>=e)for(var n=Ye[e-1],r=0;r<e;++r)n[r]=G[i+4*r>>2];else n=G.subarray(i>>2,i+4*e>>2);ri.uniform1iv(Ve(t),n)}},$c:function(t,e,i){ri.uniform2f(Ve(t),e,i)},ad:function(t,e,i){if(2<=Le.version)e&&ri.uniform2fv(Ve(t),W,i>>2,2*e);else{if(144>=e)for(var n=qe[2*e-1],r=0;r<2*e;r+=2)n[r]=W[i+4*r>>2],n[r+1]=W[i+(4*r+4)>>2];else n=W.subarray(i>>2,i+8*e>>2);ri.uniform2fv(Ve(t),n)}},Yc:function(t,e,i){ri.uniform2i(Ve(t),e,i)},Xc:function(t,e,i){if(2<=Le.version)e&&ri.uniform2iv(Ve(t),G,i>>2,2*e);else{if(144>=e)for(var n=Ye[2*e-1],r=0;r<2*e;r+=2)n[r]=G[i+4*r>>2],n[r+1]=G[i+(4*r+4)>>2];else n=G.subarray(i>>2,i+8*e>>2);ri.uniform2iv(Ve(t),n)}},Wc:function(t,e,i,n){ri.uniform3f(Ve(t),e,i,n)},Vc:function(t,e,i){if(2<=Le.version)e&&ri.uniform3fv(Ve(t),W,i>>2,3*e);else{if(96>=e)for(var n=qe[3*e-1],r=0;r<3*e;r+=3)n[r]=W[i+4*r>>2],n[r+1]=W[i+(4*r+4)>>2],n[r+2]=W[i+(4*r+8)>>2];else n=W.subarray(i>>2,i+12*e>>2);ri.uniform3fv(Ve(t),n)}},Uc:function(t,e,i,n){ri.uniform3i(Ve(t),e,i,n)},Tc:function(t,e,i){if(2<=Le.version)e&&ri.uniform3iv(Ve(t),G,i>>2,3*e);else{if(96>=e)for(var n=Ye[3*e-1],r=0;r<3*e;r+=3)n[r]=G[i+4*r>>2],n[r+1]=G[i+(4*r+4)>>2],n[r+2]=G[i+(4*r+8)>>2];else n=G.subarray(i>>2,i+12*e>>2);ri.uniform3iv(Ve(t),n)}},Sc:function(t,e,i,n,r){ri.uniform4f(Ve(t),e,i,n,r)},Rc:function(t,e,i){if(2<=Le.version)e&&ri.uniform4fv(Ve(t),W,i>>2,4*e);else{if(72>=e){var n=qe[4*e-1],r=W;i>>=2;for(var a=0;a<4*e;a+=4){var o=i+a;n[a]=r[o],n[a+1]=r[o+1],n[a+2]=r[o+2],n[a+3]=r[o+3]}}else n=W.subarray(i>>2,i+16*e>>2);ri.uniform4fv(Ve(t),n)}},Fc:function(t,e,i,n,r){ri.uniform4i(Ve(t),e,i,n,r)},Gc:function(t,e,i){if(2<=Le.version)e&&ri.uniform4iv(Ve(t),G,i>>2,4*e);else{if(72>=e)for(var n=Ye[4*e-1],r=0;r<4*e;r+=4)n[r]=G[i+4*r>>2],n[r+1]=G[i+(4*r+4)>>2],n[r+2]=G[i+(4*r+8)>>2],n[r+3]=G[i+(4*r+12)>>2];else n=G.subarray(i>>2,i+16*e>>2);ri.uniform4iv(Ve(t),n)}},Hc:function(t,e,i,n){if(2<=Le.version)e&&ri.uniformMatrix2fv(Ve(t),!!i,W,n>>2,4*e);else{if(72>=e)for(var r=qe[4*e-1],a=0;a<4*e;a+=4)r[a]=W[n+4*a>>2],r[a+1]=W[n+(4*a+4)>>2],r[a+2]=W[n+(4*a+8)>>2],r[a+3]=W[n+(4*a+12)>>2];else r=W.subarray(n>>2,n+16*e>>2);ri.uniformMatrix2fv(Ve(t),!!i,r)}},Ic:function(t,e,i,n){if(2<=Le.version)e&&ri.uniformMatrix3fv(Ve(t),!!i,W,n>>2,9*e);else{if(32>=e)for(var r=qe[9*e-1],a=0;a<9*e;a+=9)r[a]=W[n+4*a>>2],r[a+1]=W[n+(4*a+4)>>2],r[a+2]=W[n+(4*a+8)>>2],r[a+3]=W[n+(4*a+12)>>2],r[a+4]=W[n+(4*a+16)>>2],r[a+5]=W[n+(4*a+20)>>2],r[a+6]=W[n+(4*a+24)>>2],r[a+7]=W[n+(4*a+28)>>2],r[a+8]=W[n+(4*a+32)>>2];else r=W.subarray(n>>2,n+36*e>>2);ri.uniformMatrix3fv(Ve(t),!!i,r)}},Jc:function(t,e,i,n){if(2<=Le.version)e&&ri.uniformMatrix4fv(Ve(t),!!i,W,n>>2,16*e);else{if(18>=e){var r=qe[16*e-1],a=W;n>>=2;for(var o=0;o<16*e;o+=16){var s=n+o;r[o]=a[s],r[o+1]=a[s+1],r[o+2]=a[s+2],r[o+3]=a[s+3],r[o+4]=a[s+4],r[o+5]=a[s+5],r[o+6]=a[s+6],r[o+7]=a[s+7],r[o+8]=a[s+8],r[o+9]=a[s+9],r[o+10]=a[s+10],r[o+11]=a[s+11],r[o+12]=a[s+12],r[o+13]=a[s+13],r[o+14]=a[s+14],r[o+15]=a[s+15]}}else r=W.subarray(n>>2,n+64*e>>2);ri.uniformMatrix4fv(Ve(t),!!i,r)}},Kc:function(t){t=_e[t],ri.useProgram(t),ri.If=t},Lc:function(t,e){ri.vertexAttrib1f(t,e)},Mc:function(t,e){ri.vertexAttrib2f(t,W[e>>2],W[e+4>>2])},Nc:function(t,e){ri.vertexAttrib3f(t,W[e>>2],W[e+4>>2],W[e+8>>2])},Oc:function(t,e){ri.vertexAttrib4f(t,W[e>>2],W[e+4>>2],W[e+8>>2],W[e+12>>2])},pc:function(t,e){ri.vertexAttribDivisor(t,e)},qc:function(t,e,i,n,r){ri.vertexAttribIPointer(t,e,i,n,r)},Pc:function(t,e,i,n,r,a){ri.vertexAttribPointer(t,e,i,!!n,r,a)},Qc:function(t,e,i,n){ri.viewport(t,e,i,n)},lb:function(t,e,i,n){ri.waitSync(xe[t],e,(i>>>0)+4294967296*n)},tb:function(t){var e=D.length;if(2147483648<(t>>>=0))return!1;for(var i=1;4>=i;i*=2){var n=e*(1+.2/i);n=Math.min(n,t+100663296);var r=Math;n=Math.max(t,n),r=r.min.call(r,2147483648,n+(65536-n%65536)%65536);t:{try{E.grow(r-R.byteLength+65535>>>16),K();var a=1;break t}catch(t){}a=void 0}if(a)return!0}return!1},nb:function(){return Le?Le.Vf:0},wb:function(t,e){var i=0;return Ke().forEach((function(n,r){var a=e+i;for(r=U[t+4*r>>2]=a,a=0;a<n.length;++a)B[r++>>0]=n.charCodeAt(a);B[r>>0]=0,i+=n.length+1})),0},xb:function(t,e){var i=Ke();U[t>>2]=i.length;var n=0;return i.forEach((function(t){n+=t.length+1})),U[e>>2]=n,0},Jb:function(t){P||(e.onExit&&e.onExit(t),k=!0),m(t,new gi(t))},P:function(){return 52},ob:function(){return 52},Cb:function(){return 52},pb:function(){return 70},U:function(t,e,i,n){for(var r=0,a=0;a<i;a++){var o=U[e>>2],s=U[e+4>>2];e+=8;for(var l=0;l<s;l++){var c=D[o+l],h=Je[t];0===c||10===c?((1===t?w:S)(x(h,0)),h.length=0):h.push(c)}r+=s}return U[n>>2]=r,0},c:function(){return T},l:function(t,e){var i=pi();try{return ht(t)(e)}catch(t){if(mi(i),t!==t+0)throw t;fi(1,0)}},s:function(t,e,i){var n=pi();try{return ht(t)(e,i)}catch(t){if(mi(n),t!==t+0)throw t;fi(1,0)}},m:function(t,e,i,n){var r=pi();try{return ht(t)(e,i,n)}catch(t){if(mi(r),t!==t+0)throw t;fi(1,0)}},K:function(t,e,i,n,r){var a=pi();try{return ht(t)(e,i,n,r)}catch(t){if(mi(a),t!==t+0)throw t;fi(1,0)}},Nb:function(t,e,i,n,r,a){var o=pi();try{return ht(t)(e,i,n,r,a)}catch(t){if(mi(o),t!==t+0)throw t;fi(1,0)}},$:function(t,e,i,n,r,a,o){var s=pi();try{return ht(t)(e,i,n,r,a,o)}catch(t){if(mi(s),t!==t+0)throw t;fi(1,0)}},_:function(t,e,i,n,r,a,o,s,l,c){var h=pi();try{return ht(t)(e,i,n,r,a,o,s,l,c)}catch(t){if(mi(h),t!==t+0)throw t;fi(1,0)}},R:function(t){var e=pi();try{ht(t)()}catch(t){if(mi(e),t!==t+0)throw t;fi(1,0)}},q:function(t,e){var i=pi();try{ht(t)(e)}catch(t){if(mi(i),t!==t+0)throw t;fi(1,0)}},A:function(t,e,i){var n=pi();try{ht(t)(e,i)}catch(t){if(mi(n),t!==t+0)throw t;fi(1,0)}},n:function(t,e,i,n){var r=pi();try{ht(t)(e,i,n)}catch(t){if(mi(r),t!==t+0)throw t;fi(1,0)}},w:function(t,e,i,n,r){var a=pi();try{ht(t)(e,i,n,r)}catch(t){if(mi(a),t!==t+0)throw t;fi(1,0)}},Mb:function(t,e,i,n,r,a){var o=pi();try{ht(t)(e,i,n,r,a)}catch(t){if(mi(o),t!==t+0)throw t;fi(1,0)}},Kb:function(t,e,i,n,r,a,o){var s=pi();try{ht(t)(e,i,n,r,a,o)}catch(t){if(mi(s),t!==t+0)throw t;fi(1,0)}},Lb:function(t,e,i,n,r,a,o,s,l,c){var h=pi();try{ht(t)(e,i,n,r,a,o,s,l,c)}catch(t){if(mi(h),t!==t+0)throw t;fi(1,0)}},d:function(t){T=t},rb:function(t,e,i,n){return function(t,e,i,n){function r(t,e,i){for(t="number"==typeof t?t.toString():t||"";t.length<e;)t=i[0]+t;return t}function a(t,e){return r(t,e,"0")}function o(t,e){function i(t){return 0>t?-1:0<t?1:0}var n;return 0===(n=i(t.getFullYear()-e.getFullYear()))&&0===(n=i(t.getMonth()-e.getMonth()))&&(n=i(t.getDate()-e.getDate())),n}function s(t){switch(t.getDay()){case 0:return new Date(t.getFullYear()-1,11,29);case 1:return t;case 2:return new Date(t.getFullYear(),0,3);case 3:return new Date(t.getFullYear(),0,2);case 4:return new Date(t.getFullYear(),0,1);case 5:return new Date(t.getFullYear()-1,11,31);case 6:return new Date(t.getFullYear()-1,11,30)}}function l(t){var e=t.qe;for(t=new Date(new Date(t.re+1900,0,1).getTime());0<e;){var i=t.getMonth(),n=(Ze(t.getFullYear())?ti:ei)[i];if(!(e>n-t.getDate())){t.setDate(t.getDate()+e);break}e-=n-t.getDate()+1,t.setDate(1),11>i?t.setMonth(i+1):(t.setMonth(0),t.setFullYear(t.getFullYear()+1))}return i=new Date(t.getFullYear()+1,0,4),e=s(new Date(t.getFullYear(),0,4)),i=s(i),0>=o(e,t)?0>=o(i,t)?t.getFullYear()+1:t.getFullYear():t.getFullYear()-1}var c=G[n+40>>2];for(var h in n={qg:G[n>>2],pg:G[n+4>>2],Ye:G[n+8>>2],kf:G[n+12>>2],Ze:G[n+16>>2],re:G[n+20>>2],ke:G[n+24>>2],qe:G[n+28>>2],wg:G[n+32>>2],og:G[n+36>>2],rg:c?F(c):""},i=F(i),c={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})i=i.replace(new RegExp(h,"g"),c[h]);var u="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),d="January February March April May June July August September October November December".split(" ");for(h in c={"%a":function(t){return u[t.ke].substring(0,3)},"%A":function(t){return u[t.ke]},"%b":function(t){return d[t.Ze].substring(0,3)},"%B":function(t){return d[t.Ze]},"%C":function(t){return a((t.re+1900)/100|0,2)},"%d":function(t){return a(t.kf,2)},"%e":function(t){return r(t.kf,2," ")},"%g":function(t){return l(t).toString().substring(2)},"%G":function(t){return l(t)},"%H":function(t){return a(t.Ye,2)},"%I":function(t){return 0==(t=t.Ye)?t=12:12<t&&(t-=12),a(t,2)},"%j":function(t){for(var e=0,i=0;i<=t.Ze-1;e+=(Ze(t.re+1900)?ti:ei)[i++]);return a(t.kf+e,3)},"%m":function(t){return a(t.Ze+1,2)},"%M":function(t){return a(t.pg,2)},"%n":function(){return"\n"},"%p":function(t){return 0<=t.Ye&&12>t.Ye?"AM":"PM"},"%S":function(t){return a(t.qg,2)},"%t":function(){return"\t"},"%u":function(t){return t.ke||7},"%U":function(t){return a(Math.floor((t.qe+7-t.ke)/7),2)},"%V":function(t){var e=Math.floor((t.qe+7-(t.ke+6)%7)/7);if(2>=(t.ke+371-t.qe-2)%7&&e++,e)53==e&&(4==(i=(t.ke+371-t.qe)%7)||3==i&&Ze(t.re)||(e=1));else{e=52;var i=(t.ke+7-t.qe-1)%7;(4==i||5==i&&Ze(t.re%400-1))&&e++}return a(e,2)},"%w":function(t){return t.ke},"%W":function(t){return a(Math.floor((t.qe+7-(t.ke+6)%7)/7),2)},"%y":function(t){return(t.re+1900).toString().substring(2)},"%Y":function(t){return t.re+1900},"%z":function(t){var e=0<=(t=t.og);return t=Math.abs(t)/60,(e?"+":"-")+String("0000"+(t/60*100+t%60)).slice(-4)},"%Z":function(t){return t.rg},"%%":function(){return"%"}},i=i.replace(/%%/g,"\0\0"),c)i.includes(h)&&(i=i.replace(new RegExp(h,"g"),c[h](n)));return h=function(t){var e=Array(I(t)+1);return O(t,e,0,e.length),e}(i=i.replace(/\0\0/g,"%")),h.length>e?0:(B.set(h,t),h.length-1)}(t,e,i,n)}};!function(){function t(t){e.asm=t.exports,E=e.asm.dd,K(),Q=e.asm.gd,Z.unshift(e.asm.ed),nt--,e.monitorRunDependencies&&e.monitorRunDependencies(nt),0==nt&&rt&&(t=rt,rt=null,t())}function i(e){t(e.instance)}function n(t){return function(){if(!A&&(g||y)){if("function"==typeof fetch&&!it.startsWith("file://"))return fetch(it,{credentials:"same-origin"}).then((function(t){if(!t.ok)throw"failed to load wasm binary file at '"+it+"'";return t.arrayBuffer()})).catch((function(){return lt()}));if(s)return new Promise((function(t,e){s(it,(function(e){t(new Uint8Array(e))}),e)}))}return Promise.resolve().then((function(){return lt()}))}().then((function(t){return WebAssembly.instantiate(t,a)})).then((function(t){return t})).then(t,(function(t){S("failed to asynchronously prepare wasm: "+t),at(t)}))}var a={a:li};if(nt++,e.monitorRunDependencies&&e.monitorRunDependencies(nt),e.instantiateWasm)try{return e.instantiateWasm(a,t)}catch(t){return S("Module.instantiateWasm callback failed with error: "+t),!1}(A||"function"!=typeof WebAssembly.instantiateStreaming||ot()||it.startsWith("file://")||v||"function"!=typeof fetch?n(i):fetch(it,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,a).then(i,(function(t){return S("wasm streaming compile failed: "+t),S("falling back to ArrayBuffer instantiation"),n(i)}))}))).catch(r)}(),e.___wasm_call_ctors=function(){return(e.___wasm_call_ctors=e.asm.ed).apply(null,arguments)};var ci=e._malloc=function(){return(ci=e._malloc=e.asm.fd).apply(null,arguments)},hi=e._free=function(){return(hi=e._free=e.asm.hd).apply(null,arguments)},ui=e.___getTypeName=function(){return(ui=e.___getTypeName=e.asm.id).apply(null,arguments)};e.___embind_register_native_and_builtin_types=function(){return(e.___embind_register_native_and_builtin_types=e.asm.jd).apply(null,arguments)};var di,fi=e._setThrew=function(){return(fi=e._setThrew=e.asm.kd).apply(null,arguments)},pi=e.stackSave=function(){return(pi=e.stackSave=e.asm.ld).apply(null,arguments)},mi=e.stackRestore=function(){return(mi=e.stackRestore=e.asm.md).apply(null,arguments)};function gi(t){this.name="ExitStatus",this.message="Program terminated with exit("+t+")",this.status=t}function yi(){function t(){if(!di&&(di=!0,e.calledRun=!0,!k)){if(ct(Z),n(e),e.onRuntimeInitialized&&e.onRuntimeInitialized(),e.postRun)for("function"==typeof e.postRun&&(e.postRun=[e.postRun]);e.postRun.length;){var t=e.postRun.shift();tt.unshift(t)}ct(tt)}}if(!(0<nt)){if(e.preRun)for("function"==typeof e.preRun&&(e.preRun=[e.preRun]);e.preRun.length;)et();ct(J),0<nt||(e.setStatus?(e.setStatus("Running..."),setTimeout((function(){setTimeout((function(){e.setStatus("")}),1),t()}),1)):t())}}if(e.dynCall_viji=function(){return(e.dynCall_viji=e.asm.nd).apply(null,arguments)},e.dynCall_vijiii=function(){return(e.dynCall_vijiii=e.asm.od).apply(null,arguments)},e.dynCall_viiiiij=function(){return(e.dynCall_viiiiij=e.asm.pd).apply(null,arguments)},e.dynCall_jiiiijiiiii=function(){return(e.dynCall_jiiiijiiiii=e.asm.qd).apply(null,arguments)},e.dynCall_viiij=function(){return(e.dynCall_viiij=e.asm.rd).apply(null,arguments)},e.dynCall_jii=function(){return(e.dynCall_jii=e.asm.sd).apply(null,arguments)},e.dynCall_vij=function(){return(e.dynCall_vij=e.asm.td).apply(null,arguments)},e.dynCall_iiij=function(){return(e.dynCall_iiij=e.asm.ud).apply(null,arguments)},e.dynCall_iiiij=function(){return(e.dynCall_iiiij=e.asm.vd).apply(null,arguments)},e.dynCall_viij=function(){return(e.dynCall_viij=e.asm.wd).apply(null,arguments)},e.dynCall_ji=function(){return(e.dynCall_ji=e.asm.xd).apply(null,arguments)},e.dynCall_iij=function(){return(e.dynCall_iij=e.asm.yd).apply(null,arguments)},e.dynCall_jiiiii=function(){return(e.dynCall_jiiiii=e.asm.zd).apply(null,arguments)},e.dynCall_jiiiiii=function(){return(e.dynCall_jiiiiii=e.asm.Ad).apply(null,arguments)},e.dynCall_jiiiiji=function(){return(e.dynCall_jiiiiji=e.asm.Bd).apply(null,arguments)},e.dynCall_iijj=function(){return(e.dynCall_iijj=e.asm.Cd).apply(null,arguments)},e.dynCall_iiiji=function(){return(e.dynCall_iiiji=e.asm.Dd).apply(null,arguments)},e.dynCall_iiji=function(){return(e.dynCall_iiji=e.asm.Ed).apply(null,arguments)},e.dynCall_iijjiii=function(){return(e.dynCall_iijjiii=e.asm.Fd).apply(null,arguments)},e.dynCall_vijjjii=function(){return(e.dynCall_vijjjii=e.asm.Gd).apply(null,arguments)},e.dynCall_jiji=function(){return(e.dynCall_jiji=e.asm.Hd).apply(null,arguments)},e.dynCall_viijii=function(){return(e.dynCall_viijii=e.asm.Id).apply(null,arguments)},e.dynCall_iiiiij=function(){return(e.dynCall_iiiiij=e.asm.Jd).apply(null,arguments)},e.dynCall_iiiiijj=function(){return(e.dynCall_iiiiijj=e.asm.Kd).apply(null,arguments)},e.dynCall_iiiiiijj=function(){return(e.dynCall_iiiiiijj=e.asm.Ld).apply(null,arguments)},rt=function t(){di||yi(),di||(rt=t)},e.run=yi,e.preInit)for("function"==typeof e.preInit&&(e.preInit=[e.preInit]);0<e.preInit.length;)e.preInit.pop()();return yi(),t.ready});t.exports=n}(S);class A{constructor(t){this.startTime=NaN,this.stopTime=NaN,this.stopped=!0,this.cumulativeElapsed=NaN,this.name=t}static now(){return window.performance.now()}static start(t){let e=this._timers.filter((e=>e.name===t)).find(Boolean);if(void 0===e)e=new A(t),e.cumulativeElapsed=0,this._timers.push(e);else if(0==e.stopped)throw new Error(`can't start timer. timer with name ${t} is already started`);e.startTime=window.performance.now(),e.stopped=!1}static stop(t){const e=this._timers.filter((e=>e.name===t)).find(Boolean);if(void 0===e)throw new Error(`can't stop timer. timer with name ${t} does not exist`);if(!0===e.stopped)throw new Error(`can't stop timer. timer with name ${t} is already stopped`);e.stopTime=window.performance.now(),e.cumulativeElapsed=e.cumulativeElapsed+e.stopTime-e.startTime,e.stopped=!0}static restart(t){const e=this._timers.filter((e=>e.name===t)).find(Boolean);if(void 0===e)throw new Error(`can't restart timer. timer with name ${t} does not exist`);e.startTime=window.performance.now(),e.cumulativeElapsed=0,e.stopped=!1}static elapsed(t){const e=this._timers.filter((e=>e.name===t)).find(Boolean);if(void 0===e)throw new Error(`can't get elapsed time. timer with name ${t} does not exist`);return e.stopped?e.cumulativeElapsed:e.cumulativeElapsed+window.performance.now()-e.startTime}static remove(t){if(void 0===this._timers.filter((e=>e.name===t)).find(Boolean))throw new Error(`can't remove timer. timer with name ${t} does not exist`);this._timers=this._timers.filter((e=>e.name!=t))}static removeAll(){this._timers=new Array}static exists(t){return this._timers.some((e=>e.name===t))}}A._timers=new Array;class T{static generate(){try{return crypto.randomUUID()}catch(t){let e;try{e=()=>crypto.getRandomValues(new Uint8Array(1))[0]}catch(t){e=()=>Math.floor(256*Math.random())}return(1e7.toString()+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(t=>(Number(t)^e()&15>>Number(t)/4).toString(16)))}}}!function(t){t.topToTopOf="topToTopOf",t.topToBottomOf="topToBottomOf",t.bottomToTopOf="bottomToTopOf",t.bottomToBottomOf="bottomToBottomOf",t.startToStartOf="startToStartOf",t.startToEndOf="startToEndOf",t.endToEndOf="endToEndOf",t.endToStartOf="endToStartOf"}(g||(g={}));class P{constructor(t,e){this.verticalConstraint=!1,this.focalEntityMinimum=!1,this.alterEntityMinimum=!1,this.verticalTypes=[g.topToTopOf,g.topToBottomOf,g.bottomToTopOf,g.bottomToBottomOf],this.focalEntityMinimumTypes=[g.topToTopOf,g.topToBottomOf,g.startToStartOf,g.startToEndOf],this.alterEntityMinimumTypes=[g.topToTopOf,g.bottomToTopOf,g.startToStartOf,g.endToStartOf],this.type=t,this.alterEntity=e,this.verticalTypes.includes(t)?(this.verticalConstraint=!0,this.focalEntityMinimumTypes.includes(t)?this.focalEntityMinimum=!0:this.focalEntityMinimum=!1,this.alterEntityMinimumTypes.includes(t)?this.alterEntityMinimum=!0:this.alterEntityMinimum=!1):(this.verticalConstraint=!1,this.focalEntityMinimumTypes.includes(t)?this.focalEntityMinimum=!0:this.focalEntityMinimum=!1,this.alterEntityMinimumTypes.includes(t)?this.alterEntityMinimum=!0:this.alterEntityMinimum=!1)}}function E(t,e){t.isDrawable&&function(t,e){e.anchorPoint&&(t.anchorPoint=e.anchorPoint),e.zPosition&&(t.zPosition=e.zPosition)}(t,e),t.isText&&function(t,e){e.text&&(t.text=e.text),e.fontName&&(t.fontName=e.fontName),e.fontColor&&(t.fontColor=e.fontColor),e.fontSize&&(t.fontSize=e.fontSize)}(t,e)}!function(t){t.Entity="Entity",t.Scene="Scene",t.Sprite="Sprite",t.Label="Label",t.TextLine="TextLine",t.Shape="Shape",t.Composite="Composite"}(y||(y={}));class k{constructor(t={}){this.type=y.Entity,this.isDrawable=!1,this.isShape=!1,this.isText=!1,this.position={x:0,y:0},this.scale=1,this.isUserInteractionEnabled=!1,this.hidden=!1,this.layout={},this.children=new Array,this.absolutePosition={x:0,y:0},this.size={width:0,height:0},this.absoluteScale=1,this.actions=new Array,this.originalActions=new Array,this.eventListeners=new Array,this.uuid=T.generate(),this.needsInitialization=!0,this.userData={},this.loopMessages=new Set,this.pressed=!1,this.pressedInHitArea=!1,this.toString=()=>this.name!==this.uuid?`"${this.name}" (${this.type}, ${this.uuid})`:`"${this.type} (${this.uuid})`,void 0===t.name?this.name=this.uuid:this.name=t.name,t.position&&(this.position=t.position),t.scale&&(this.scale=t.scale),t.isUserInteractionEnabled&&(this.isUserInteractionEnabled=t.isUserInteractionEnabled),t.hidden&&(this.hidden=t.hidden),t.layout&&(this.layout=t.layout)}initialize(){throw new Error("initialize() called in abstract base class Entity.")}get game(){const t=e=>{if(e.parent)return e.parent.type===y.Scene?e.parent:t(e.parent);throw new Error(`Entity ${this} has not been added to a scene.`)};return t(this).game}addChild(t){if(t.type==y.Scene)throw new Error("A scene cannot be the child of an entity. A scene can only be added to a game object");if(t.parent=this,this.children.map((t=>t.name)).includes(t.name))throw new Error(`Cannot add child entity ${t.toString()} to parent entity ${this.toString()}. A child with name "${t.name}" already exists on parent.`);this.children.push(t)}removeAllChildren(){for(;this.children.length;)this.children.pop()}removeChild(t){if(!this.children.includes(t))throw new Error(`cannot remove entity ${t} from parent ${this} because the entity is not currently a child of the parent`);this.children=this.children.filter((e=>e!==t))}removeChildren(t){t.forEach((t=>{if(!this.children.includes(t))throw new Error(`cannot remove entity ${t} from parent ${this} because the entity is not currently a child of the parent`)})),this.children=this.children.filter((e=>!t.includes(e)))}descendant(t){const e=this.descendants.filter((e=>e.name===t)).find(Boolean);if(void 0===e)throw new Error(`descendant with name ${t} not found on parent ${this.toString()}`);return e}get descendants(){function t(e,i){i.push(e),e.children.forEach((e=>t(e,i)))}const e=new Array;return this.children.forEach((i=>t(i,e))),e}onTapDown(t,e=!0){this.addEventListener(i.TapDown,t,e)}onTapUp(t,e=!0){this.addEventListener(i.TapUp,t,e)}onTapUpAny(t,e=!0){this.addEventListener(i.TapUpAny,t,e)}onTapLeave(t,e=!0){this.addEventListener(i.TapLeave,t,e)}onPointerDown(t,e=!0){this.addEventListener(i.PointerDown,t,e)}onPointerUp(t,e=!0){this.addEventListener(i.PointerUp,t,e)}onPointerMove(t,e=!0){this.addEventListener(i.PointerMove,t,e)}addEventListener(t,e,i){const n={type:t,entityUuid:this.uuid,callback:e};i&&(this.eventListeners=this.eventListeners.filter((t=>!(t.entityUuid===n.entityUuid&&t.type===n.type)))),this.eventListeners.push(n)}parseLayoutConstraints(t,e){const i=new Array;return Object.values(g).forEach((n=>{if(void 0!==t[n]){let r,a="";if(t[n]instanceof k)r=t[n];else{const i=t[n];r=e.filter((t=>t.name===i)).find(Boolean),a=`. sibling entity named "${i}" has not been added to the game object`}if(void 0===r)throw new Error("could not find sibling entity for constraint"+a);const o=new P(n,r);i.push(o)}})),i}calculateYFromConstraint(t,e,i,n){let r=t.alterEntity.absolutePosition.y;return t.alterEntityMinimum?t.alterEntity.type!==y.Scene&&(r-=.5*t.alterEntity.size.height*n):t.alterEntity.type!==y.Scene?r+=.5*t.alterEntity.size.height*n:r+=t.alterEntity.size.height*n,t.focalEntityMinimum?(r+=.5*this.size.height*n,r+=e*n):(r-=.5*this.size.height*n,r-=i*n),r}calculateXFromConstraint(t,e,i,n){let r=t.alterEntity.absolutePosition.x;return t.alterEntityMinimum?t.alterEntity.type!==y.Scene&&(r-=.5*t.alterEntity.size.width*n):t.alterEntity.type!==y.Scene?r+=.5*t.alterEntity.size.width*n:r+=t.alterEntity.size.width*n,t.focalEntityMinimum?(r+=.5*this.size.width*n,r+=e*n):(r-=.5*this.size.width*n,r-=i*n),r}update(){var t,e,i,n,a,o,s,l,c,h,u,d,f,p,m,v;if(this.needsInitialization&&(this.initialize(),this.needsInitialization=!1),void 0===this.parent)this.absolutePosition.x=this.position.x*this.scale,this.absolutePosition.y=this.position.y*this.scale,this.absoluteScale=this.scale;else if(this.absoluteScale=this.parent.absoluteScale*this.scale,void 0===(null===(t=this.layout)||void 0===t?void 0:t.constraints))this.absolutePosition.x=this.parent.absolutePosition.x+this.position.x*this.parent.absoluteScale,this.absolutePosition.y=this.parent.absolutePosition.y+this.position.y*this.parent.absoluteScale;else{const t=null!==(n=null===(i=null===(e=this.layout)||void 0===e?void 0:e.constraints)||void 0===i?void 0:i.horizontalBias)&&void 0!==n?n:.5,r=null!==(s=null===(o=null===(a=this.layout)||void 0===a?void 0:a.constraints)||void 0===o?void 0:o.verticalBias)&&void 0!==s?s:.5,g=null!==(c=null===(l=this.layout)||void 0===l?void 0:l.marginTop)&&void 0!==c?c:0,y=null!==(u=null===(h=this.layout)||void 0===h?void 0:h.marginBottom)&&void 0!==u?u:0,b=null!==(f=null===(d=this.layout)||void 0===d?void 0:d.marginStart)&&void 0!==f?f:0,w=null!==(m=null===(p=this.layout)||void 0===p?void 0:p.marginEnd)&&void 0!==m?m:0,S=this.parseLayoutConstraints(null===(v=this.layout)||void 0===v?void 0:v.constraints,this.parentSceneAsEntity.descendants),_=this.parent.absoluteScale,C=S.filter((t=>t.verticalConstraint)).map((t=>this.calculateYFromConstraint(t,g,y,_)));0===C.length||(1===C.length?this.absolutePosition.y=C[0]:2===C.length&&(this.absolutePosition.y=Math.min(C[0],C[1])+r*Math.abs(C[0]-C[1])));const A=S.filter((t=>!t.verticalConstraint)).map((t=>this.calculateXFromConstraint(t,b,w,_)));0===A.length||(1===A.length?this.absolutePosition.x=A[0]:2===A.length&&(this.absolutePosition.x=Math.min(A[0],A[1])+t*Math.abs(A[0]-A[1])))}const b=this.actions.filter((t=>t.runDuringTransition&&!t.completed)),w=this.actions.filter((t=>!t.runDuringTransition&&!t.completed));b.length>0?(b.forEach((t=>{-1===t.runStartTime&&(t.runStartTime=Globals.now)})),b.forEach((t=>r.evaluateAction(t,this,Globals.now,Globals.deltaTime)))):w.length>0&&(w.forEach((t=>{-1===t.runStartTime&&(t.runStartTime=Globals.now)})),w.forEach((t=>r.evaluateAction(t,this,Globals.now,Globals.deltaTime))));const S=new Map;this.children.forEach((t=>{var e;S.set(t.uuid,function(t,e){const i=new Array;return void 0===e||Object.values(g).forEach((n=>{if(void 0!==e[n]){let r,a="";if(e[n]instanceof k)r=e[n];else{const i=e[n];let o;o=t.type===y.Scene?t.descendants:t.parentSceneAsEntity.descendants,r=o.filter((t=>t.name===i)).find(Boolean),void 0===r&&(a=`. sibling entity named "${i}" has not been added to the game object`)}if(void 0===r)throw new Error("error getting uuid of sibling contraint"+a);r!==t&&i.push(r.uuid)}})),i}(this,null===(e=t.layout)||void 0===e?void 0:e.constraints))}));const _=this.findTopologicalSort(S);if(_.length>0){const t=_.reverse(),e=new Array;t.forEach((t=>{const i=this.children.filter((e=>e.uuid===t)).find(Boolean);if(void 0===i)throw new Error("error in dag topological sort");e.push(i)})),e.forEach((t=>t.update()))}else this.children.forEach((t=>t.update()))}drawChildren(t){this.children.filter((t=>!t.hidden&&t.isDrawable)).map((t=>t)).sort(((t,e)=>t.zPosition-e.zPosition)).forEach((e=>e.draw(t)))}run(t,e){this.actions.push(...t.initialize(this,e)),this.originalActions=this.actions.filter((t=>!1===t.runDuringTransition)).map((t=>r.cloneAction(t,e)))}removeAction(t){this.actions=this.actions.filter((e=>e.key!==t))}removeAllActions(){for(;this.actions.length;)this.actions.pop()}getEntityOptions(){return{name:this.name,position:this.position,scale:this.scale,isUserInteractionEnabled:this.isUserInteractionEnabled,hidden:this.hidden}}getDrawableOptions(){if(!this.isDrawable)throw new Error("getDrawableOptions() called object that is not IDrawable");return{anchorPoint:this.anchorPoint,zPosition:this.zPosition}}getTextOptions(){if(!this.isText)throw new Error("getTextOptions() called object that is not IText");return{text:this.text,fontName:this.fontName,fontColor:this.fontColor,fontSize:this.fontSize}}get canvasKit(){let t;return t=this.type===y.Scene?this:this.parentSceneAsEntity,t.game.canvasKit}get parentSceneAsEntity(){if(this.type===y.Scene)throw new Error(`Entity ${this} is a scene and cannot have a parent scene`);if(this.parent&&this.parent.type===y.Scene)return this.parent;if(this.parent)return this.parent.parentSceneAsEntity;throw new Error(`Entity ${this} has not been added to a scene`)}findTopologicalSort(t){var e;const i=[],n=new Map;t.forEach(((t,e)=>{n.has(e)||n.set(e,0),t.forEach((t=>{n.has(t)?n.set(t,n.get(t)+1):n.set(t,1)}))}));const r=[];for(n.forEach(((t,e)=>{0==t&&r.push(e)}));r.length>0;){const a=r.shift();if(void 0===a)throw"bad";i.push(a),t.has(a)&&(null===(e=t.get(a))||void 0===e||e.forEach((t=>{if(n.has(t)&&n.get(t)>0){const e=n.get(t)-1;n.set(t,e),0==e&&r.push(t)}})))}return i}}class M extends k{constructor(t={}){super(t),this.type=y.Composite,this.compositeType="<compositeType>",this.isDrawable=!0,this.anchorPoint={x:.5,y:.5},this.zPosition=0,E(this,t)}initialize(){}dispose(){}update(){super.update()}draw(t){super.drawChildren(t)}}class x{}x.Transparent=[0,0,0,0],x.MediumVioletRed=[199,21,133,1],x.DeepPink=[255,20,147,1],x.PaleVioletRed=[219,112,147,1],x.HotPink=[255,105,180,1],x.LightPink=[255,182,193,1],x.Pink=[255,192,203,1],x.DarkRed=[139,0,0,1],x.Red=[255,0,0,1],x.Firebrick=[178,34,34,1],x.Crimson=[220,20,60,1],x.IndianRed=[205,92,92,1],x.LightCoral=[240,128,128,1],x.Salmon=[250,128,114,1],x.DarkSalmon=[233,150,122,1],x.LightSalmon=[255,160,122,1],x.OrangeRed=[255,69,0,1],x.Tomato=[255,99,71,1],x.DarkOrange=[255,140,0,1],x.Coral=[255,127,80,1],x.Orange=[255,165,0,1],x.DarkKhaki=[189,183,107,1],x.Gold=[255,215,0,1],x.Khaki=[240,230,140,1],x.PeachPuff=[255,218,185,1],x.Yellow=[255,255,0,1],x.PaleGoldenrod=[238,232,170,1],x.Moccasin=[255,228,181,1],x.PapayaWhip=[255,239,213,1],x.LightGoldenrodYellow=[250,250,210,1],x.LemonChiffon=[255,250,205,1],x.LightYellow=[255,255,224,1],x.Maroon=[128,0,0,1],x.Brown=[165,42,42,1],x.SaddleBrown=[139,69,19,1],x.Sienna=[160,82,45,1],x.Chocolate=[210,105,30,1],x.DarkGoldenrod=[184,134,11,1],x.Peru=[205,133,63,1],x.RosyBrown=[188,143,143,1],x.Goldenrod=[218,165,32,1],x.SandyBrown=[244,164,96,1],x.Tan=[210,180,140,1],x.Burlywood=[222,184,135,1],x.Wheat=[245,222,179,1],x.NavajoWhite=[255,222,173,1],x.Bisque=[255,228,196,1],x.BlanchedAlmond=[255,235,205,1],x.Cornsilk=[255,248,220,1],x.DarkGreen=[0,100,0,1],x.Green=[0,128,0,1],x.DarkOliveGreen=[85,107,47,1],x.ForestGreen=[34,139,34,1],x.SeaGreen=[46,139,87,1],x.Olive=[128,128,0,1],x.OliveDrab=[107,142,35,1],x.MediumSeaGreen=[60,179,113,1],x.LimeGreen=[50,205,50,1],x.Lime=[0,255,0,1],x.SpringGreen=[0,255,127,1],x.MediumSpringGreen=[0,250,154,1],x.DarkSeaGreen=[143,188,143,1],x.MediumAquamarine=[102,205,170,1],x.YellowGreen=[154,205,50,1],x.LawnGreen=[124,252,0,1],x.Chartreuse=[127,255,0,1],x.LightGreen=[144,238,144,1],x.GreenYellow=[173,255,47,1],x.PaleGreen=[152,251,152,1],x.Teal=[0,128,128,1],x.DarkCyan=[0,139,139,1],x.LightSeaGreen=[32,178,170,1],x.CadetBlue=[95,158,160,1],x.DarkTurquoise=[0,206,209,1],x.MediumTurquoise=[72,209,204,1],x.Turquoise=[64,224,208,1],x.Aqua=[0,255,255,1],x.Cyan=[0,255,255,1],x.Aquamarine=[127,255,212,1],x.PaleTurquoise=[175,238,238,1],x.LightCyan=[224,255,255,1],x.Navy=[0,0,128,1],x.DarkBlue=[0,0,139,1],x.MediumBlue=[0,0,205,1],x.Blue=[0,0,255,1],x.MidnightBlue=[25,25,112,1],x.RoyalBlue=[65,105,225,1],x.SteelBlue=[70,130,180,1],x.DodgerBlue=[30,144,255,1],x.DeepSkyBlue=[0,191,255,1],x.CornflowerBlue=[100,149,237,1],x.SkyBlue=[135,206,235,1],x.LightSkyBlue=[135,206,250,1],x.LightSteelBlue=[176,196,222,1],x.LightBlue=[173,216,230,1],x.PowderBlue=[176,224,230,1],x.Indigo=[75,0,130,1],x.Purple=[128,0,128,1],x.DarkMagenta=[139,0,139,1],x.DarkViolet=[148,0,211,1],x.DarkSlateBlue=[72,61,139,1],x.BlueViolet=[138,43,226,1],x.DarkOrchid=[153,50,204,1],x.Fuchsia=[255,0,255,1],x.Magenta=[255,0,255,1],x.SlateBlue=[106,90,205,1],x.MediumSlateBlue=[123,104,238,1],x.MediumOrchid=[186,85,211,1],x.MediumPurple=[147,112,219,1],x.Orchid=[218,112,214,1],x.Violet=[238,130,238,1],x.Plum=[221,160,221,1],x.Thistle=[216,191,216,1],x.Lavender=[230,230,250,1],x.MistyRose=[255,228,225,1],x.AntiqueWhite=[250,235,215,1],x.Linen=[250,240,230,1],x.Beige=[245,245,220,1],x.WhiteSmoke=[245,245,245,1],x.LavenderBlush=[255,240,245,1],x.OldLace=[253,245,230,1],x.AliceBlue=[240,248,255,1],x.Seashell=[255,245,238,1],x.GhostWhite=[248,248,255,1],x.Honeydew=[240,255,240,1],x.FloralWhite=[255,250,240,1],x.Azure=[240,255,255,1],x.MintCream=[245,255,250,1],x.Snow=[255,250,250,1],x.Ivory=[255,255,240,1],x.White=[255,255,255,1],x.Black=[0,0,0,1],x.DarkSlateGray=[47,79,79,1],x.DimGray=[105,105,105,1],x.SlateGray=[112,128,144,1],x.Gray=[128,128,128,1],x.LightSlateGray=[119,136,153,1],x.DarkGray=[169,169,169,1],x.Silver=[192,192,192,1],x.LightGray=[211,211,211,1],x.Gainsboro=[220,220,220,1],x.RebeccaPurple=[102,51,153,1];class F{}F.FPS_DISPLAY_TEXT_FONT_SIZE=12,F.FPS_DISPLAY_TEXT_COLOR=[0,0,0,.5],F.FPS_DISPLAY_UPDATE_INTERVAL=1e3,F.MAXIMUM_RECORDED_ACTIVITY_METRICS=32,F.FPS_METRIC_REPORT_THRESHOLD=59,F.DEFAULT_SCENE_BACKGROUND_COLOR=x.White,F.DEFAULT_SHAPE_FILL_COLOR=x.Red,F.DEFAULT_PATH_STROKE_COLOR=x.Red,F.DEFAULT_PATH_LINE_WIDTH=2,F.DEFAULT_FONT_COLOR=x.Black,F.DEFAULT_FONT_SIZE=16,F.LIMITED_FPS_RATE=5,F.FREE_ENTITIES_SCENE_NAME="__freeEntitiesScene",F.OUTGOING_SCENE_NAME="__outgoingScene",F.OUTGOING_SCENE_SPRITE_NAME="__outgoingSceneSprite",F.OUTGOING_SCENE_IMAGE_NAME="__outgoingSceneSnapshot",function(t){t[t.MatchConstraint=0]="MatchConstraint"}(v||(v={}));class O extends k{constructor(t={}){super(t),this.type=y.Sprite,this.isDrawable=!0,this.anchorPoint={x:.5,y:.5},this.zPosition=0,this._imageName="",E(this,t),t.imageName&&(this.imageName=t.imageName)}initialize(){const t=this.parentSceneAsEntity.game.session;if(!t)throw new Error("activity is undefined");const e=t.imageManager,i=this.parentSceneAsEntity.game.uuid;if(this.loadedImage=e.getLoadedImage(i,this._imageName),!this.loadedImage)throw new Error(`could not create sprite. the image named ${this._imageName} has not been loaded`);this.size.width=this.loadedImage.width,this.size.height=this.loadedImage.height,this.needsInitialization=!1}dispose(){var t;d.Dispose([null===(t=this.loadedImage)||void 0===t?void 0:t.image])}set imageName(t){this._imageName=t,this.needsInitialization=!0}get imageName(){return this._imageName}duplicate(t){const e=new O(Object.assign(Object.assign(Object.assign({},this.getEntityOptions()),this.getDrawableOptions()),{imageName:this.imageName,name:t}));return this.children.length>0&&(e.children=this.children.map((t=>{const i=t.duplicate();return i.parent=e,i}))),e}update(){super.update()}draw(t){if(!this.hidden){if(this.loadedImage){t.save();const e=Globals.canvasScale/this.absoluteScale;t.scale(1/e,1/e);const i=(this.absolutePosition.x-this.size.width*this.anchorPoint.x*this.absoluteScale)*e,n=(this.absolutePosition.y-this.size.height*this.anchorPoint.y*this.absoluteScale)*e;t.drawImage(this.loadedImage.image,i,n),t.restore()}super.drawChildren(t)}}warmup(t){if(this.initialize(),!this.loadedImage)throw new Error(`warmup Sprite entity ${this.toString()}: image not loaded.`);t.drawImage(this.loadedImage.image,0,0),this.children.forEach((e=>{e.isDrawable&&e.warmup(t)}))}}class I extends k{constructor(t={}){super(t),this.type=y.Scene,this.isDrawable=!0,this.anchorPoint={x:0,y:0},this.zPosition=0,this._backgroundColor=F.DEFAULT_SCENE_BACKGROUND_COLOR,this._active=!1,this._transitioning=!1,E(this,t),t.backgroundColor&&(this.backgroundColor=t.backgroundColor)}initialize(){this.scale=Globals.rootScale,this.size.width=this.game.canvasCssWidth,this.size.height=this.game.canvasCssHeight,this.backgroundPaint=new this.canvasKit.Paint,this.backgroundPaint.setColor(this.canvasKit.Color(this.backgroundColor[0],this.backgroundColor[1],this.backgroundColor[2],this.backgroundColor[3])),this.backgroundPaint.setStyle(this.canvasKit.PaintStyle.Fill),this.needsInitialization=!1}dispose(){d.Dispose([this.backgroundPaint])}set game(t){this._game=t}get game(){if(void 0===this._game)throw new Error(`Scene ${this} has not been added to a game.`);return this._game}get backgroundColor(){return this._backgroundColor}set backgroundColor(t){this._backgroundColor=t,this.needsInitialization=!0}duplicate(t){const e=new I(Object.assign(Object.assign(Object.assign({},this.getEntityOptions()),this.getDrawableOptions()),{backgroundColor:this.backgroundColor,name:t}));return e.game=this.game,this.children.length>0&&(e.children=this.children.map((t=>{const i=t.duplicate();return i.parent=e,i}))),e}onSetup(t){this._setupCallback=t}onAppear(t){this._appearCallback=t}draw(t){t.save();const e=Globals.canvasScale/this.absoluteScale;t.scale(1/e,1/e);const i=this.canvasKit.RRectXY(this.canvasKit.LTRBRect(this.position.x*e*Globals.rootScale,this.position.y*e*Globals.rootScale,(this.position.x+this.size.width)*e*Globals.rootScale,(this.position.y+this.size.height)*e*Globals.rootScale),0,0);if(!this.backgroundPaint)throw new Error(`in Scene ${this}, background paint is undefined.`);t.drawRRect(i,this.backgroundPaint),t.restore(),super.drawChildren(t)}warmup(t){this.initialize(),this.children.forEach((e=>{e.isDrawable&&e.warmup(t)}))}}class R{static slide(t){var e;return new D(t.direction,t.duration,null!==(e=t.easing)&&void 0!==e?e:n.linear)}static none(){return new B}}class B extends R{constructor(){super(),this.type=b.None,this.duration=NaN,this.easing=n.none}}class D extends R{constructor(t,e,i){super(),this.type=b.Slide,this.direction=t,this.duration=e,this.easing=i}}!function(t){t.Slide="Slide",t.None="None"}(b||(b={})),function(t){t.Up="Up",t.Down="Down",t.Right="Right",t.Left="Left"}(w||(w={}));class L{constructor(t,e){this.scene=t,this.transition=e}}const N={type:"object",description:"Information about the user's device.",properties:{userAgent:{type:"string",description:"The user agent string returned by navigator.userAgent."},devicePixelRatio:{type:"number",description:"Ratio of physical pixels to CSS pixels."},screen:{type:"object",description:"Screen information returned by window.screen.",properties:{availHeight:{type:"number",description:"Height of screen, in pixels, excluding UI features."},availWidth:{type:"number",description:"Width of screen, in pixels, excluding UI features."},colorDepth:{type:"number",description:"Color depth of screen."},height:{type:"number",description:"Height of screen, in pixels"},width:{type:"number",description:"Width of screen, in pixels."},orientation:{type:"object",description:"Information about the device's orientation.",properties:{type:{type:"string",description:"The orientation type (ScreenOrientation.type)."},angle:{type:"number",description:"The orientation angle (ScreenOrientation.angle)."}}},pixelDepth:{type:"number",description:"Pixel depth of screen."}}},webGlRenderer:{type:"string",description:"WebGL driver vendor and renderer. Taken from WEBGL_debug_renderer_info."}}};class G{static getRendererString(){const t=document.createElement("canvas");t.id="webgl-renderer-info-canvas",t.height=0,t.width=0,t.hidden=!0,document.body.appendChild(t);const e=t.getContext("webgl");let i="no webgl context";if(!e)return i;const n=e.getExtension("WEBGL_debug_renderer_info");return i=null!=n?String(e.getParameter(n.UNMASKED_VENDOR_WEBGL))+", "+String(e.getParameter(n.UNMASKED_RENDERER_WEBGL)):"no debug renderer info",t.remove(),i}static dispose(){const t=document.getElementById("webgl-renderer-info-canvas");t&&t.remove()}}class U{constructor(t){var e;this.locale="",this.fallbackLocale="en",this.environmentLocale=this.getEnvironmentLocale(),this.options=t,this._translations=null!==(e=this.mergeAdditionalTranslations(t.translations,t.additionalTranslations))&&void 0!==e?e:{},"auto"===t.locale.toLowerCase()?(this.locale=this.environmentLocale,this.locale||(t.fallbackLocale?(this.fallbackLocale=t.fallbackLocale,console.warn(`auto locale requested, but environment cannot provide locale. Using fallback locale ${t.fallbackLocale}`)):console.warn('auto locale requested, but environment cannot provide locale. Defaulting to "en".'))):(this.locale=t.locale,t.fallbackLocale&&(this.fallbackLocale=t.fallbackLocale))}static makeLocalizationParameters(){return JSON.parse(JSON.stringify({locale:{type:["string","null"],default:null,description:'Locale to use for localization, or "auto" to request from the environment.'},fallback_locale:{type:["string","null"],default:null,description:'Locale to use if requested locale translation is not availble, or if "auto" locale was requested and environment cannot provide a locale.'},missing_translation_font_color:{type:["array","null"],default:null,description:"Font color for strings that are missing translation and use the fallback locale or untranslated string, [r,g,b,a].",items:{type:"number"}},translations:{type:["object","null"],default:null,description:"Additional translations for localization."}}))}t(t,e=!1){var i,n;return e?null===(i=this._translations[this.fallbackLocale])||void 0===i?void 0:i[t]:null===(n=this._translations[this.locale])||void 0===n?void 0:n[t]}get translations(){return this._translations}set translations(t){this._translations=t}getEnvironmentLocale(){return navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.language}mergeAdditionalTranslations(t,e){if(!t&&!e)return;if(!e)return t;if(!t)return e;const i={},n=new Array;for(const r in t)n.push(r),i[r]=Object.assign(Object.assign({},t[r]),e[r]);for(const t in e)n.includes(t)||(i[t]=e[t]);return i}}var W,z,j;!function(t){t[t.Center=0]="Center",t[t.Left=1]="Left",t[t.Right=2]="Right"}(W||(W={}));class H extends k{constructor(t={}){super(t),this.type=y.Label,this.isDrawable=!0,this.isText=!0,this.anchorPoint={x:.5,y:.5},this.zPosition=0,this._text="",this._fontColor=F.DEFAULT_FONT_COLOR,this._fontSize=F.DEFAULT_FONT_SIZE,this._horizontalAlignmentMode=W.Center,this._translatedText="",E(this,t),t.horizontalAlignmentMode&&(this.horizontalAlignmentMode=t.horizontalAlignmentMode),void 0!==t.preferredMaxLayoutWidth&&(this.preferredMaxLayoutWidth=t.preferredMaxLayoutWidth),t.backgroundColor&&(this.backgroundColor=t.backgroundColor)}initialize(){var t,e,i;let n=this.canvasKit.TextAlign.Center;switch(this.horizontalAlignmentMode){case W.Center:n=this.canvasKit.TextAlign.Center;break;case W.Left:n=this.canvasKit.TextAlign.Left;break;case W.Right:n=this.canvasKit.TextAlign.Right;break;default:throw new Error("unknown horizontalAlignmentMode")}this.text||(this.text="");let r,a=this.canvasKit.Color(this.fontColor[0],this.fontColor[1],this.fontColor[2],this.fontColor[3]);const o=this.parentSceneAsEntity.game.i18n;if(o){let t=o.t(this.text);if(void 0===t){const e=o.t(this.text,!0);t=void 0===e?this.text:e,o.options.missingTranslationFontColor&&(a=this.canvasKit.Color(o.options.missingTranslationFontColor[0],o.options.missingTranslationFontColor[1],o.options.missingTranslationFontColor[2],o.options.missingTranslationFontColor[3]))}this._translatedText=t,r=this._translatedText,""===this._translatedText&&console.warn(`warning: empty translated text in label "${this.name}"`)}else r=this.text,this._translatedText="",""===this.text&&console.warn(`warning: empty text in label "${this.name}"`);this.paraStyle=new this.canvasKit.ParagraphStyle({textStyle:{color:a,backgroundColor:this.backgroundColor?this.canvasKit.Color(this.backgroundColor[0],this.backgroundColor[1],this.backgroundColor[2],this.backgroundColor[3]):void 0,fontFamilies:this.fontName?[this.fontName]:void 0,fontSize:this.fontSize*Globals.canvasScale},textAlign:n});const s=this.parentSceneAsEntity.game.session;if(!s)throw new Error("session is undefined");const l=s.fontManager;if(void 0===l.fontMgr)throw new Error("no fonts loaded");this.builder=this.canvasKit.ParagraphBuilder.Make(this.paraStyle,l.fontMgr),this.builder.addText(r),this.paragraph=this.builder.build();const c=null!==(t=this.preferredMaxLayoutWidth)&&void 0!==t?t:Globals.canvasCssWidth;let h=c;if(0===c||0===this.layout.width){if(void 0===this.parent)throw new Error("width is set to match parent, but entity has no parent");const t=null!==(e=this.layout.marginStart)&&void 0!==e?e:0,n=null!==(i=this.layout.marginEnd)&&void 0!==i?i:0;h=this.parent.size.width-(t+n)}this.paragraph.layout(h*Globals.canvasScale),0===c||0===this.layout.width?this.size.width=h:(this.paragraph.layout(Math.ceil(this.paragraph.getLongestLine())),this.size.width=this.paragraph.getMaxWidth()/Globals.canvasScale),this.size.height=this.paragraph.getHeight()/Globals.canvasScale,this.needsInitialization=!1}dispose(){d.Dispose([this.paragraph,this.builder])}get text(){return this._text}set text(t){this._text=t,this.needsInitialization=!0}get translatedText(){return this._translatedText}get fontName(){return this._fontName}set fontName(t){this._fontName=t,this.needsInitialization=!0}get fontColor(){return this._fontColor}set fontColor(t){this._fontColor=t,this.needsInitialization=!0}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize=t,this.needsInitialization=!0}get horizontalAlignmentMode(){return this._horizontalAlignmentMode}set horizontalAlignmentMode(t){this._horizontalAlignmentMode=t,this.needsInitialization=!0}get preferredMaxLayoutWidth(){return this._preferredMaxLayoutWidth}set preferredMaxLayoutWidth(t){this._preferredMaxLayoutWidth=t,this.needsInitialization=!0}get backgroundColor(){return this._backgroundColor}set backgroundColor(t){this._backgroundColor=t,this.needsInitialization=!0}duplicate(t){const e=new H(Object.assign(Object.assign(Object.assign(Object.assign({},this.getEntityOptions()),this.getDrawableOptions()),this.getTextOptions()),{horizontalAlignmentMode:this.horizontalAlignmentMode,preferredMaxLayoutWidth:this.preferredMaxLayoutWidth,backgroundColor:this.backgroundColor,name:t}));return this.children.length>0&&(e.children=this.children.map((t=>{const i=t.duplicate();return i.parent=e,i}))),e}update(){super.update()}draw(t){if(this.parent&&""!==this.text){t.save();const e=Globals.canvasScale/this.absoluteScale;t.scale(1/e,1/e);const i=(this.absolutePosition.x-this.size.width*this.anchorPoint.x*this.absoluteScale)*e,n=(this.absolutePosition.y-this.size.height*this.anchorPoint.y*this.absoluteScale)*e;if(void 0===this.paragraph)throw new Error("no paragraph");t.drawParagraph(this.paragraph,i,n),t.restore()}super.drawChildren(t)}warmup(t){if(0===Object.keys(this.layout).length){if(this.initialize(),!this.paragraph)throw new Error(`warmup Label entity ${this.toString()}: paragraph is undefined`);t.drawParagraph(this.paragraph,0,0)}}}class ${static SingleFromRange(t,e){return Math.floor(Math.random()*(e-t+1))+t}static FromRangeWithoutReplacement(t,e,i){if(t>i-e+1)throw new Error(`number of requested draws (n = ${t}) is greater than number of integers in range [ ${e}, ${i}]`);const n=new Array;for(let r=0;r<t;r++){const r=$.SingleFromRange(e,i);n.includes(r)?t++:n.push(r)}return n}static FromGridWithoutReplacement(t,e,i,n){const r=new Array,a=e*i-1,o=this.FromRangeWithoutReplacement(t,0,a);let s=0,l=NaN;for(;s<t;){const t=o[s]%i,e=(o[s]-t)/i;if(void 0===n||n(e,t))r.push({row:e,column:t}),s++;else{do{l=this.FromRangeWithoutReplacement(1,0,a)[0]}while(o.includes(l));o[s]=l}}return r}}!function(t){t.Undefined="Undefined",t.Rectangle="Rectangle",t.Circle="Circle",t.Path="Path"}(z||(z={}));class V extends k{constructor(t={}){if(super(t),this.type=y.Shape,this.isDrawable=!0,this.isShape=!0,this.anchorPoint={x:.5,y:.5},this.zPosition=0,this.shapeType=z.Undefined,this.cornerRadius=0,this._fillColor=F.DEFAULT_SHAPE_FILL_COLOR,E(this,t),void 0!==t.path&&(this.path=t.path,this.size.width=t.path.size.width,this.size.height=t.path.size.height,this.strokeColor||(this.strokeColor=F.DEFAULT_PATH_STROKE_COLOR),this.lineWidth||(this.lineWidth=F.DEFAULT_PATH_LINE_WIDTH),this.shapeType=z.Path,t.circleOfRadius||t.rect))throw new Error("Shape must specify only one of: path, circleOfRadius, or rect");if(void 0!==t.circleOfRadius&&(this.circleOfRadius=t.circleOfRadius,this.shapeType=z.Circle,t.path||t.rect))throw new Error("Shape must specify only one of: path, circleOfRadius, or rect");t.rect&&(this.rect=t.rect,t.rect.size?(this.size.width=t.rect.size.width,this.size.height=t.rect.size.height):void 0!==t.rect.width&&void 0!==t.rect.height&&(this.size.width=t.rect.width,this.size.height=t.rect.height),t.rect.origin?this.position=t.rect.origin:void 0!==t.rect.x&&void 0!==t.rect.y&&(this.position={x:t.rect.x,y:t.rect.y}),this.shapeType=z.Rectangle),t.cornerRadius&&(this.cornerRadius=t.cornerRadius),t.fillColor&&(this.fillColor=t.fillColor),t.strokeColor&&(this.strokeColor=t.strokeColor),t.lineWidth&&(this.lineWidth=t.lineWidth),t.strokeColor&&void 0===t.lineWidth&&console.warn(`warning: for entity ${this}, strokeColor = ${t.strokeColor} but lineWidth is undefined. In normal usage, both would be set or both would be undefined.`),void 0===t.strokeColor&&t.lineWidth&&console.warn(`warning: for entity ${this}, lineWidth = ${t.lineWidth} but strokeColor is undefined. In normal usage, both would be set or both would be undefined.`)}initialize(){if(this.fillColor){const t=this.canvasKit;this.fillColorPaint=new t.Paint,this.fillColorPaint.setColor(t.Color(this.fillColor[0],this.fillColor[1],this.fillColor[2],this.fillColor[3])),this.fillColorPaint.setStyle(t.PaintStyle.Fill),this.fillColorPaint.setAntiAlias(!0)}if(this.strokeColor){const t=this.canvasKit;this.strokeColorPaint=new t.Paint,this.strokeColorPaint.setColor(t.Color(this.strokeColor[0],this.strokeColor[1],this.strokeColor[2],this.strokeColor[3])),this.strokeColorPaint.setStyle(t.PaintStyle.Stroke),this.strokeColorPaint.setAntiAlias(!0)}this.needsInitialization=!1}dispose(){d.Dispose([this.strokeColorPaint,this.fillColorPaint])}get fillColor(){return this._fillColor}set fillColor(t){this._fillColor=t,this.needsInitialization=!0}get strokeColor(){return this._strokeColor}set strokeColor(t){this._strokeColor=t,this.needsInitialization=!0}duplicate(t){const e=new V(Object.assign(Object.assign(Object.assign({},this.getEntityOptions()),this.getDrawableOptions()),{shapeType:this.shapeType,circleOfRadius:this.circleOfRadius,rect:this.rect,cornerRadius:this.cornerRadius,fillColor:this.fillColor,strokeColor:this.strokeColor,lineWidth:this.lineWidth,name:t}));return this.children.length>0&&(e.children=this.children.map((t=>{const i=t.duplicate();return i.parent=e,i}))),e}update(){super.update()}draw(t){t.save();const e=Globals.canvasScale/this.absoluteScale;if(t.scale(1/e,1/e),this.shapeType===z.Path&&this.path){const i=(this.absolutePosition.x-this.anchorPoint.x*this.size.width*this.absoluteScale)*e,n=(this.absolutePosition.y-this.anchorPoint.y*this.size.height*this.absoluteScale)*e;if(this.strokeColor&&this.strokeColorPaint&&this.lineWidth){this.strokeColorPaint.setStrokeWidth(this.lineWidth*e);for(const r of this.path.subpaths){const a=r.flat();for(let r=0;r<a.length-1;r++)t.drawLine(i+a[r].x*e,n+a[r].y*e,i+a[r+1].x*e,n+a[r+1].y*e,this.strokeColorPaint)}}}if(this.shapeType===z.Circle&&void 0!==this.circleOfRadius){const i=this.absolutePosition.x*e,n=this.absolutePosition.y*e,r=this.circleOfRadius*this.absoluteScale*e;this.fillColor&&this.fillColorPaint&&t.drawCircle(i,n,r,this.fillColorPaint),this.strokeColor&&this.strokeColorPaint&&this.lineWidth&&(this.strokeColorPaint.setStrokeWidth(this.lineWidth*e),t.drawCircle(i,n,r,this.strokeColorPaint))}if(this.shapeType===z.Rectangle){const i=this.canvasKit.RRectXY(this.canvasKit.LTRBRect((this.absolutePosition.x-this.anchorPoint.x*this.size.width*this.absoluteScale)*e,(this.absolutePosition.y-this.anchorPoint.y*this.size.height*this.absoluteScale)*e,(this.absolutePosition.x+this.size.width*this.absoluteScale-this.anchorPoint.x*this.size.width*this.absoluteScale)*e,(this.absolutePosition.y+this.size.height*this.absoluteScale-this.anchorPoint.y*this.size.height*this.absoluteScale)*e),this.cornerRadius*e,this.cornerRadius*e);this.fillColor&&this.fillColorPaint&&t.drawRRect(i,this.fillColorPaint),this.strokeColor&&this.strokeColorPaint&&this.lineWidth&&(this.strokeColorPaint.setStrokeWidth(this.lineWidth*e),t.drawRRect(i,this.strokeColorPaint))}t.restore(),super.drawChildren(t)}warmup(t){this.initialize(),this.children.forEach((e=>{e.isDrawable&&e.warmup(t)}))}}class q extends M{constructor(t){if(super(t),this.compositeType="grid",this.rows=0,this.columns=0,this.gridBackgroundColor=[0,0,233,.25],this.gridLineColor=x.Red,this.gridLineWidth=1,this.gridChildren=new Array,!t.size)throw new Error("grid size must be specified");if(this.size=t.size,!t.rows)throw new Error("rows must be specified");if(!(t.rows>=1))throw new Error("rows must be at least 1");if(this.rows=t.rows,!t.columns)throw new Error("columns must be specified");if(!(t.columns>=1))throw new Error("columns must be at least 1");this.columns=t.columns,t.backgroundColor&&(this.gridBackgroundColor=t.backgroundColor),t.gridLineColor&&(this.gridLineColor=t.gridLineColor),t.gridLineWidth&&(this.gridLineWidth=t.gridLineWidth),this.cellWidth=this.size.width/this.columns,this.cellHeight=this.size.height/this.rows}initialize(){super.removeAllChildren(),this.gridBackground=new V({name:"_"+this.name+"-gridBackground",rect:{size:this.size},fillColor:this.gridBackgroundColor,strokeColor:this.gridLineColor,lineWidth:this.gridLineWidth,isUserInteractionEnabled:this.isUserInteractionEnabled}),this.addChild(this.gridBackground),this.gridBackground.isUserInteractionEnabled=this.isUserInteractionEnabled;for(let t=1;t<this.columns;t++){const e=new V({name:"_"+this.name+"-gridVerticalLine-"+t,rect:{size:{width:this.gridLineWidth,height:this.size.height},origin:{x:-this.size.width/2+this.cellWidth*t,y:0}},fillColor:this.gridLineColor});this.gridBackground.addChild(e)}for(let t=1;t<this.rows;t++){const e=new V({name:"_"+this.name+"-gridHorizontalLine-"+t,rect:{size:{width:this.size.width,height:this.gridLineWidth},origin:{x:0,y:-this.size.height/2+this.cellHeight*t}},fillColor:this.gridLineColor});this.gridBackground.addChild(e)}this.gridChildren&&this.gridChildren.forEach((t=>{if(!this.cellWidth||!this.cellHeight||!this.gridBackground)throw new Error("cellWidth, cellHeight, or gridBackground undefined or null");const e=-this.size.width/2+this.cellWidth/2+t.column*this.cellWidth,i=-this.size.height/2+this.cellHeight/2+t.row*this.cellHeight;t.entity.position={x:e,y:i},this.gridBackground.addChild(t.entity)})),this.needsInitialization=!1}dispose(){}duplicate(t){const e=new q(Object.assign(Object.assign(Object.assign({},this.getEntityOptions()),this.getDrawableOptions()),{rows:this.rows,columns:this.columns,size:this.size,backgroundColor:this.gridBackgroundColor,gridLineWidth:this.gridLineWidth,gridLineColor:this.gridLineColor,name:t}));return this.children.length>0&&(e.children=this.children.map((t=>{const i=t.duplicate();return i.parent=e,i}))),e}update(){super.update()}draw(t){super.drawChildren(t)}warmup(t){this.initialize(),this.children.filter((t=>t.isDrawable)).forEach((e=>{e.warmup(t)}))}removeAllChildren(){if(0!==this.gridChildren.length){for(;this.gridChildren.length;)this.gridChildren.pop();this.needsInitialization=!0}}addAtCell(t,e,i){(e<0||e>=this.rows||i<0||i>=this.columns)&&console.warn(`warning: addAtCell() requested to add entity at row ${e}, column ${i}. This is outside the bounds of grid ${this.name}, which is size ${this.rows}x${this.columns}. Note that addAtCell() uses zero-based indexing. AddAtCell() will proceed, but may draw entities outside the grid`),this.gridChildren.push({entity:t,row:e,column:i}),this.needsInitialization=!0}removeAllAtCell(t,e){this.gridChildren=this.gridChildren.filter((i=>i.row!=t&&i.column!=e)),this.needsInitialization=!0}removeChild(t){if(!this.gridBackground)throw new Error("gridBackground is null or undefined");this.gridBackground.removeChild(t),this.gridChildren=this.gridChildren.filter((e=>e.entity!=t)),this.needsInitialization=!0}}class Y extends M{constructor(t){super(t),this.compositeType="button",this._backgroundColor=x.Black,this.size={width:200,height:50},this.cornerRadius=9,this.fontSize=20,this.text="",this._fontColor=x.White,t.text&&(this.text=t.text),t.size&&(this.size=t.size),t.cornerRadius&&(this.cornerRadius=t.cornerRadius),t.fontSize&&(this.fontSize=t.fontSize),t.fontColor&&(this.fontColor=t.fontColor),t.backgroundColor&&(this.backgroundColor=t.backgroundColor)}initialize(){this.removeAllChildren(),this.backgroundPaint=new this.canvasKit.Paint,this.backgroundPaint.setColor(this.canvasKit.Color(this.backgroundColor[0],this.backgroundColor[1],this.backgroundColor[2],this.backgroundColor[3])),this.backgroundPaint.setStyle(this.canvasKit.PaintStyle.Fill);const t=new V({rect:{size:this.size},cornerRadius:this.cornerRadius,fillColor:this._backgroundColor});this.addChild(t);const e=new H({text:this.text,fontSize:this.fontSize,fontColor:this.fontColor});t.addChild(e),this.needsInitialization=!1}dispose(){d.Dispose([this.backgroundPaint])}get backgroundColor(){return this._backgroundColor}set backgroundColor(t){this._backgroundColor=t,this.needsInitialization=!0}get fontColor(){return this._fontColor}set fontColor(t){this._fontColor=t,this.needsInitialization=!0}duplicate(t){const e=new Y(Object.assign(Object.assign(Object.assign(Object.assign({},this.getEntityOptions()),this.getDrawableOptions()),this.getTextOptions()),{size:this.size,cornerRadius:this.cornerRadius,backgroundColor:this.backgroundColor,fontColor:this.fontColor,name:t}));return this.children.length>0&&(e.children=this.children.map((t=>{const i=t.duplicate();return i.parent=e,i}))),e}update(){super.update()}draw(t){super.drawChildren(t)}warmup(t){this.initialize(),this.children.filter((t=>t.isDrawable)).forEach((e=>{e.warmup(t)}))}}!function(t){t.Dismiss="Dismiss",t.Positive="Positive",t.Negative="Negative"}(j||(j={}));const X=n.sinusoidalInOut;class K extends class{static Create(t){return new Array}}{static Create(t){const e=new Array;return t.instructionScenes.forEach(((i,n)=>{var r,a,o,s,l,c,h,u,d,f,p,m,g,y,b,S,_,C,A,T,P,E,k,M,F,B,D,L,N,G,U,z,j,$,V;const q=null!==(a=null!==(r=i.nextSceneTransition)&&void 0!==r?r:t.nextSceneTransition)&&void 0!==a?a:R.slide({direction:w.Left,duration:500,easing:X}),K=null!==(s=null!==(o=i.backSceneTransition)&&void 0!==o?o:t.backSceneTransition)&&void 0!==s?s:R.slide({direction:w.Right,duration:500,easing:X}),Q=null!==(c=null!==(l=i.backButtonText)&&void 0!==l?l:t.backButtonText)&&void 0!==c?c:"Back",J=null!==(u=null!==(h=i.nextButtonText)&&void 0!==h?h:t.nextButtonText)&&void 0!==u?u:"Next",Z=null!==(f=null!==(d=i.backButtonWidth)&&void 0!==d?d:t.backButtonWidth)&&void 0!==f?f:125,tt=null!==(m=null!==(p=i.nextButtonWidth)&&void 0!==p?p:t.nextButtonWidth)&&void 0!==m?m:125,et=null!==(y=null!==(g=i.backButtonHeight)&&void 0!==g?g:t.backButtonHeight)&&void 0!==y?y:50,it=null!==(S=null!==(b=i.nextButtonHeight)&&void 0!==b?b:t.nextButtonHeight)&&void 0!==S?S:50,nt=null!==(_=i.backgroundColor)&&void 0!==_?_:t.backgroundColor,rt=null===(C=i.imageAboveText)||void 0===C||C,at=null!==(A=i.imageMarginTop)&&void 0!==A?A:0,ot=null!==(T=i.imageMarginBottom)&&void 0!==T?T:0,st=null!==(P=i.textMarginStart)&&void 0!==P?P:48,lt=null!==(E=i.textMarginEnd)&&void 0!==E?E:48,ct=null!==(k=i.textAlignmentMode)&&void 0!==k?k:W.Left,ht=null!==(M=i.textFontSize)&&void 0!==M?M:16,ut=null!==(F=i.titleFontSize)&&void 0!==F?F:16,dt=null!==(B=i.titleMarginTop)&&void 0!==B?B:48,ft=null!==(L=null!==(D=i.backButtonBackgroundColor)&&void 0!==D?D:t.backButtonBackgroundColor)&&void 0!==L?L:x.Black,pt=null!==(G=null!==(N=i.backButtonFontColor)&&void 0!==N?N:t.backButtonFontColor)&&void 0!==G?G:x.White,mt=null!==(z=null!==(U=i.nextButtonBackgroundColor)&&void 0!==U?U:t.nextButtonBackgroundColor)&&void 0!==z?z:x.Black,gt=null!==($=null!==(j=i.nextButtonFontColor)&&void 0!==j?j:t.nextButtonFontColor)&&void 0!==$?$:x.White,yt=null!==(V=t.sceneNamePrefix)&&void 0!==V?V:"instructions",vt=new I({name:yt+"-"+(n+1).toString().padStart(2,"0"),backgroundColor:nt});let bt,wt;if(void 0!==i.title&&(bt=new H({text:i.title,fontSize:ut,layout:{marginTop:dt,constraints:{topToTopOf:vt,startToStartOf:vt,endToEndOf:vt}}}),vt.addChild(bt)),void 0!==i.text&&(wt=new H({text:i.text,preferredMaxLayoutWidth:v.MatchConstraint,horizontalAlignmentMode:ct,fontSize:ht,layout:{marginStart:st,marginEnd:lt,constraints:{topToTopOf:vt,bottomToBottomOf:vt,startToStartOf:vt,endToEndOf:vt,verticalBias:i.textVerticalBias}}}),vt.addChild(wt)),void 0!==i.imageName){let t;t=new O(void 0!==wt?rt?{imageName:i.imageName,layout:{marginBottom:ot,constraints:{bottomToTopOf:wt,startToStartOf:vt,endToEndOf:vt}}}:{imageName:i.imageName,layout:{marginTop:at,constraints:{topToBottomOf:wt,startToStartOf:vt,endToEndOf:vt}}}:{imageName:i.imageName,layout:{constraints:{topToTopOf:vt,bottomToBottomOf:vt,verticalBias:i.imageVerticalBias,startToStartOf:vt,endToEndOf:vt}}}),vt.addChild(t)}if(n>0){const t=new Y({text:Q,fontColor:pt,backgroundColor:ft,size:{width:Z,height:et},layout:{marginStart:32,marginBottom:80,constraints:{bottomToBottomOf:vt,startToStartOf:vt}}});t.isUserInteractionEnabled=!0,t.onTapDown((()=>{vt.game.presentScene(yt+"-"+(n+1-1).toString().padStart(2,"0"),K)})),vt.addChild(t)}const St=new Y({name:"nextButton",text:J,fontColor:gt,backgroundColor:mt,size:{width:tt,height:it},layout:{marginEnd:32,marginBottom:80,constraints:{bottomToBottomOf:vt,endToEndOf:vt}}});St.isUserInteractionEnabled=!0,n!==t.instructionScenes.length-1?St.onTapDown((()=>{vt.game.presentScene(yt+"-"+(n+1+1).toString().padStart(2,"0"),q)})):void 0!==t.postInstructionsScene?St.onTapDown((()=>{var e;vt.game.presentScene(null!==(e=t.postInstructionsScene)&&void 0!==e?e:"",q)})):St.onTapDown((()=>{const t=vt.game.scenes.indexOf(vt);if(-1===t)console.warn("warning: postInstructionsScene is not defined, and next scene cannot be determined.");else{const e=t+1;e<vt.game.scenes.length?vt.game.presentScene(vt.game.scenes[e],q):console.warn("warning: postInstructionsScene is not defined, and there is no next scene to present.")}})),vt.addChild(St),e.push(vt)})),e}}class Q extends class{constructor(t){var i,n;this.type=e.Game,this.uuid=T.generate(),this.beginTimestamp=NaN,this.beginIso8601Timestamp="",this.gameMetrics=new Array,this.stepCount=0,this.steppingNow=0,this.data={trials:new Array},this.trialIndex=0,this.drawnFrames=0,this.lastFpsUpdate=0,this.nextFpsUpdate=0,this.fpsRate=0,this.animationFramesRequested=0,this.limitFps=!1,this.unitTesting=!1,this.gameStopRequested=!1,this.webGlRendererInfo="",this.canvasCssWidth=0,this.canvasCssHeight=0,this.scenes=new Array,this.freeEntitiesScene=new I({name:F.FREE_ENTITIES_SCENE_NAME,backgroundColor:[255,255,255,0]}),this.incomingSceneTransitions=new Array,this.automaticTrialSchema={session_uuid:{type:"string",format:"uuid",description:"Unique identifier for all activities in this administration of the session."},activity_uuid:{type:"string",format:"uuid",description:"Unique identifier for all trials in this administration of the activity."},activity_id:{type:"string",description:"Identifier of the activity."},activity_version:{type:"string",description:"Version of the activity."}},this.snapshots=new Array,this.options=t,this.name=t.name,this.id=t.id,this.freeEntitiesScene.game=this,this.freeEntitiesScene.needsInitialization=!0,this.fpsMetricReportThreshold=null!==(i=t.fpsMetricReportThreshold)&&void 0!==i?i:F.FPS_METRIC_REPORT_THRESHOLD,this.maximumRecordedActivityMetrics=null!==(n=t.maximumRecordedActivityMetrics)&&void 0!==n?n:F.MAXIMUM_RECORDED_ACTIVITY_METRICS,this.addLocalizationParametersToGameParameters()}addLocalizationParametersToGameParameters(){this.options.parameters=Object.assign(Object.assign({},this.options.parameters),U.makeLocalizationParameters())}init(){if(this.isLocalizationRequested()){const t=this.getLocalizationOptionsFromGameParameters();this.i18n=new U(t)}}getLocalizationOptionsFromGameParameters(){return{locale:this.getParameter("locale"),fallbackLocale:this.getParameterOrFallback("fallback_locale",void 0),missingTranslationFontColor:this.getParameterOrFallback("missing_translation_font_color",void 0),additionalTranslations:this.getParameterOrFallback("translations",void 0),translations:this.options.translations}}isLocalizationRequested(){const t=this.getParameterOrFallback("locale",void 0);if(""===t)throw new Error("Empty string in locale. Leave locale undefined or null to prevent localization.");return null!=t}setParameters(t){const{parameters:e}=this.options;Object.keys(t).forEach((i=>{e&&i in e?this.options.parameters&&this.options.parameters[i]&&(this.options.parameters[i].default=t[i]):console.warn(`game ${this.options.name} does not have a parameter named ${i}. attempt to set parameter ${i} to value ${t[i]} will be ignored`)}))}get canvasKit(){if(!this._canvasKit)throw new Error("canvaskit is undefined");return this._canvasKit}set canvasKit(t){this._canvasKit=t}get session(){if(!this._session)throw new Error("session is undefined");return this._session}set session(t){this._session=t}addFreeEntity(t){this.freeEntitiesScene.addChild(t)}removeFreeEntity(t){if("string"==typeof t){if(!this.freeEntitiesScene.children.map((t=>t.name)).includes(t))throw new Error(`cannot remove free entity named "${t}" because it is not currently part of the game's free entities. `);this.freeEntitiesScene.children=this.freeEntitiesScene.children.filter((e=>e.name!==t))}else{if(!this.freeEntitiesScene.children.includes(t))throw new Error(`cannot remove free entity "${t.toString()}" because it is not currently part of the game's free entities. `);this.freeEntitiesScene.children=this.freeEntitiesScene.children.filter((e=>e!==t))}}removeAllFreeEntities(){for(;this.freeEntitiesScene.children.length;)this.freeEntitiesScene.children.pop()}get freeEntities(){return this.freeEntitiesScene.children}addScene(t){t.game=this,t.needsInitialization=!0,this.scenes.push(t)}addScenes(t){t.forEach((t=>{this.addScene(t)}))}removeScene(t){if(t instanceof I){if(!this.scenes.includes(t))throw new Error(`cannot remove scene ${t} from game because the scene is not currently added to the game`);this.scenes=this.scenes.filter((e=>e!==t))}else{if(!this.scenes.map((t=>t.name)).includes(t))throw new Error(`cannot remove scene named "${t}" from game because the scene is not currently added to the game`);this.scenes=this.scenes.filter((e=>e.name!==t))}}presentScene(t,e=R.none()){let i;if("string"==typeof t){if(i=this.scenes.filter((e=>e.name===t)).find(Boolean),void 0===i)throw new Error(`scene ${t} not found`)}else{if(!this.scenes.some((e=>e===t)))throw new Error(`scene ${t} exists, but it has not been added to the game object`);i=t}i.initialize(),i.needsInitialization=!1;const n=new L(i,e);this.incomingSceneTransitions.push(n),void 0!==i.game.bodyBackgroundColor?document.body.style.backgroundColor=`rgb(${i.game.bodyBackgroundColor[0]},${i.game.bodyBackgroundColor[1]},${i.game.bodyBackgroundColor[2]},${i.game.bodyBackgroundColor[3]})`:document.body.style.backgroundColor=`rgb(${i.backgroundColor[0]},${i.backgroundColor[1]},${i.backgroundColor[2]},${i.backgroundColor[3]})`}getParameter(t){if(void 0!==this.options.parameters&&Object.keys(this.options.parameters).includes(t))return this.options.parameters[t].default;throw new Error(`game parameter ${t} not found`)}getParameterOrFallback(t,e){return void 0!==this.options.parameters&&Object.keys(this.options.parameters).includes(t)?this.options.parameters[t].default:e}hasParameter(t){return!(void 0===this.options.parameters||!Object.keys(this.options.parameters).includes(t))}start(t){var e,n,r;const a=this.options;let o;if(this.unitTesting=null!==(e=a._unitTesting)&&void 0!==e&&e,this.setupHtmlCanvases(a.canvasId,a.width,a.height,a.stretch),this.showFps=null!==(n=a.showFps)&&void 0!==n&&n,this.bodyBackgroundColor=a.bodyBackgroundColor,this.initData(),this.setupCanvasKitSurface(),this.setupFpsFont(),this.setupCanvasDomEventHandlers(),void 0!==t){if(t instanceof I){if(o=t,!this.scenes.includes(o))throw new Error(`cannot start game. scene named "${t}" has not been added to the game object`)}else if(o=this.scenes.filter((e=>e.name===t)).find(Boolean),void 0===o)throw new Error(`cannot start game. scene named "${t}" has not been added to the game object`)}else if(o=this.scenes.find(Boolean),void 0===o)throw new Error("cannot start game. no scenes have been added to the game object");if(this.presentScene(o),void 0===this.surface)throw new Error("CanvasKit surface is undefined");this.warmupShaders(this.surface),this.beginTimestamp=A.now(),this.beginIso8601Timestamp=(new Date).toISOString(),this.options.timeStepping?(this.addTimeSteppingControlsToDom(),this.updateTimeSteppingOutput()):this.removeTimeSteppingControlsFromDom(),this.surface.requestAnimationFrame(this.loop.bind(this)),(null===(r=this.session.options.activityCallbacks)||void 0===r?void 0:r.onActivityLifecycle)&&this.session.options.activityCallbacks.onActivityLifecycle({type:i.ActivityStart,target:this})}addTimeSteppingControlsToDom(){if(document.getElementById("m2c2kit-time-stepping-div"))return;const t=document.getElementsByTagName("body")[0];if(t){const e=document.createElement("div");e.id="m2c2kit-time-stepping-div",t.prepend(e);const i=document.createElement("button");i.id="1-step-advance",i.title="advance 1 step (16.667 ms)",i.innerText=">",i.style.marginRight="4px",e.appendChild(i),i.addEventListener("click",this.advanceStepsHandler.bind(this));const n=document.createElement("button");n.id="55-step-advance",n.title="advance 55 steps (916.667 ms)",n.innerText=">>",n.style.marginRight="4px",e.appendChild(n),n.addEventListener("click",this.advanceStepsHandler.bind(this));const r=document.createElement("input");r.id="time-stepping-steps-input",r.title="steps",r.style.width="40px",r.style.marginRight="4px",r.setAttribute("readonly","true"),e.appendChild(r);const a=document.createElement("input");a.id="time-stepping-now-input",a.title="milliseconds",a.style.width="80px",a.style.marginRight="4px",a.setAttribute("readonly","true"),e.appendChild(a)}}updateTimeSteppingOutput(){const t=document.getElementById("time-stepping-steps-input");t&&(t.value=this.stepCount.toString());const e=document.getElementById("time-stepping-now-input");e&&(e.value=this.steppingNow.toFixed(2))}advanceStepsHandler(t){var e,i;"1-step-advance"===(null===(e=null==t?void 0:t.target)||void 0===e?void 0:e.id)?(this.steppingNow=this.steppingNow+16.66666666666667,this.stepCount=this.stepCount+1):"55-step-advance"===(null===(i=null==t?void 0:t.target)||void 0===i?void 0:i.id)&&(this.steppingNow=this.steppingNow+916.666666666667,this.stepCount=this.stepCount+55),this.updateTimeSteppingOutput()}removeTimeSteppingControlsFromDom(){const t=document.getElementById("m2c2kit-time-stepping-div");t&&t.remove()}warmupShaders(t){const e=t.getCanvas(),i=new this.canvasKit.Paint;i.setColor(this.canvasKit.Color(255,255,255,1)),[...this.scenes,this.freeEntitiesScene].forEach((t=>t.children.forEach((t=>{t.isDrawable&&t.warmup(e)}))));const n=this.entities.filter((t=>t.type===y.Sprite)).map((t=>t.imageName)),r=this.session.imageManager.loadedImages[this.uuid];r&&Object.keys(r).forEach((t=>{if(!n.includes(t)){const i=r[t].image;e.drawImage(i,0,0)}}));const a=this.canvasKit.RRectXY(this.canvasKit.LTRBRect(0,0,t.width(),t.height()),0,0);e.drawRRect(a,i)}stop(){this.currentScene&&(this.currentScene._active=!1),this.gameStopRequested=!0,this.dispose()}dispose(){this.entities.filter((t=>t.isDrawable)).forEach((t=>t.dispose()))}initData(){var t;this.trialIndex=0,this.data={trials:new Array};const e=null!==(t=this.options.trialSchema)&&void 0!==t?t:{},i=Object.entries(e);for(const[t,e]of i)if(void 0!==e.type&&!this.propertySchemaDataTypeIsValid(e.type))throw new Error(`invalid schema. variable ${t} is type ${e.type}. type must be number, string, boolean, object, or array`)}propertySchemaDataTypeIsValid(t){const e=["string","number","integer","object","array","boolean","null"];if("string"==typeof t)return e.includes(t);let i=!0;if(!Array.isArray(t))throw new Error(`Invalid data type: ${t}`);return t.forEach((t=>{e.includes(t)||(i=!1)})),i}getDeviceMetadata(){const t=window.screen;return t.orientation?{userAgent:navigator.userAgent,devicePixelRatio:window.devicePixelRatio,screen:{availHeight:t.availHeight,availWidth:t.availWidth,colorDepth:t.colorDepth,height:t.height,orientation:{type:t.orientation.type,angle:t.orientation.angle},pixelDepth:t.pixelDepth,width:t.width},webGlRenderer:this.webGlRendererInfo}:{userAgent:navigator.userAgent,devicePixelRatio:window.devicePixelRatio,screen:{availHeight:t.availHeight,availWidth:t.availWidth,colorDepth:t.colorDepth,height:t.height,pixelDepth:t.pixelDepth,width:t.width},webGlRenderer:this.webGlRendererInfo}}addTrialData(t,e){if(!this.options.trialSchema)throw new Error("no trial schema were provided in GameOptions. cannot add trial data");if(this.data.trials.length<this.trialIndex+1){const t={},e=Object.entries(this.options.trialSchema);for(const[i]of e)t[i]=null;this.data.trials.push(Object.assign(Object.assign({session_uuid:this.session.uuid,activity_uuid:this.uuid,activity_id:this.options.id,activity_version:this.options.version},t),{device_metadata:this.getDeviceMetadata()}))}if(!(t in this.options.trialSchema))throw new Error(`trial variable ${t} not defined in schema`);let i;i=Array.isArray(this.options.trialSchema[t].type)?this.options.trialSchema[t].type:[this.options.trialSchema[t].type];let n=typeof e;if("object"===n&&"[object Array]"===Object.prototype.toString.call(e)&&(n="array"),null==e&&(n="null"),!(i.includes(n)||"number"===n&&Number.isInteger(e)&&i.includes("integer")))throw new Error(`type for variable ${t} (value: ${e}) is "${n}". Based on schema for this variable, expected type was "${i}"`);this.data.trials[this.trialIndex][t]=e}trialComplete(){var t,e,n;this.trialIndex++,(null===(t=this.session.options.activityCallbacks)||void 0===t?void 0:t.onActivityResults)&&this.session.options.activityCallbacks.onActivityResults({type:i.ActivityData,target:this,newData:this.data.trials[this.trialIndex-1],newDataSchema:this.makeNewGameDataSchema(),data:this.data,dataSchema:this.makeGameDataSchema(),activityConfiguration:this.makeGameActivityConfiguration(null!==(e=this.options.parameters)&&void 0!==e?e:{}),activityConfigurationSchema:this.makeGameActivityConfigurationSchema(null!==(n=this.options.parameters)&&void 0!==n?n:{}),activityMetrics:this.gameMetrics})}makeNewGameDataSchema(){return{description:`A single trial and metadata from the assessment ${this.name}.`,$comment:`Activity identifier: ${this.options.id}, version: ${this.options.version}.`,$schema:"https://json-schema.org/draft/2019-09/schema",type:"object",properties:Object.assign(Object.assign(Object.assign({},this.automaticTrialSchema),this.options.trialSchema),{device_metadata:N})}}makeGameDataSchema(){return{description:`All trials and metadata from the assessment ${this.name}.`,$comment:`Activity identifier: ${this.options.id}, version: ${this.options.version}.`,$schema:"https://json-schema.org/draft/2019-09/schema",type:"object",required:["trials"],properties:{trials:{type:"array",items:{$ref:"#/$defs/trial"},description:"All trials from the assessment."}},$defs:{trial:{type:"object",properties:Object.assign(Object.assign(Object.assign({},this.automaticTrialSchema),this.options.trialSchema),{device_metadata:N})}}}}makeGameActivityConfiguration(t){const e=u(JSON.parse(JSON.stringify(t)),["locale","fallback_locale","missing_translation_font_color","translations"]);for(const t in e)for(const i in e[t])"default"==i&&(e[t]=e[t][i]);return e}makeGameActivityConfigurationSchema(t){const e=u(JSON.parse(JSON.stringify(t)),["locale","fallback_locale","missing_translation_font_color","translations"]);for(const t in e){if(!("type"in e[t])&&"value"in e[t]){const i=typeof e[t].default;"bigint"!==i&&"function"!==i&&"symbol"!==i&&"undefined"!==i&&(e[t].type=i)}for(const i in e[t])"default"==i&&delete e[t][i]}return{description:`activity configuration from the assessment ${this.name}`,type:"object",properties:e}}end(){var t,e,n;(null===(t=this.session.options.activityCallbacks)||void 0===t?void 0:t.onActivityLifecycle)&&this.session.options.activityCallbacks.onActivityLifecycle({type:i.ActivityEnd,target:this,results:{data:this.data,dataSchema:this.makeGameDataSchema(),activityConfiguration:this.makeGameActivityConfiguration(null!==(e=this.options.parameters)&&void 0!==e?e:{}),activityConfigurationSchema:this.makeGameActivityConfigurationSchema(null!==(n=this.options.parameters)&&void 0!==n?n:{}),activityMetrics:this.gameMetrics}})}cancel(){var t,e,n;(null===(t=this.session.options.activityCallbacks)||void 0===t?void 0:t.onActivityLifecycle)&&this.session.options.activityCallbacks.onActivityLifecycle({type:i.ActivityCancel,target:this,results:{data:this.data,dataSchema:this.makeGameDataSchema(),activityConfiguration:this.makeGameActivityConfiguration(null!==(e=this.options.parameters)&&void 0!==e?e:{}),activityConfigurationSchema:this.makeGameActivityConfigurationSchema(null!==(n=this.options.parameters)&&void 0!==n?n:{}),activityMetrics:this.gameMetrics}})}setupHtmlCanvases(t,e,i,n){let r;if(Globals.canvasScale=Math.round(100*window.devicePixelRatio)/100,void 0===t){const t=document.getElementsByTagName("canvas");let e=new Array;for(let i=0;i<t.length;i++)e.push(t[i]);if(e=e.filter((t=>"m2c2kitscratchcanvas"!==t.id)),0===e.length)throw new Error("no html canvas tag was found in the html");e.length>1&&console.warn("warning: more than one html canvas was found.");const i=e.filter((t=>"m2c2kit-canvas"===t.id))[0];i?(r=i,e.length>1&&console.log("using canvas with id 'm2c2kit-canvas'")):(r=t[0],e.length>1&&console.log("using first canvas"))}else if(r=document.getElementById(t),void 0===r)throw new Error(`could not find canvas HTML element with id "${t}"`);if(n||window.innerWidth<e||window.innerHeight<i){const t=i/e,n=window.innerHeight/window.innerWidth;Globals.rootScale=n<t?window.innerHeight/i:window.innerWidth/e}r.style.width=Globals.rootScale*e+"px",r.style.height=Globals.rootScale*i+"px",r.width=Globals.rootScale*e*Globals.canvasScale,r.height=Globals.rootScale*i*Globals.canvasScale,this.htmlCanvas=r,this.canvasCssWidth=e,this.canvasCssHeight=i,Globals.canvasCssWidth=e,Globals.canvasCssHeight=i}setupCanvasKitSurface(){if(void 0===this.htmlCanvas)throw new Error("main html canvas is undefined");try{this.webGlRendererInfo=G.getRendererString()}catch(t){this.webGlRendererInfo="err",G.dispose()}const t=this.canvasKit.MakeWebGLCanvasSurface(this.htmlCanvas);if(null===t)throw new Error("could not make CanvasKit surface from canvas HTML element");this.surface=t,console.log(" CanvasKit surface is backed by "+(this.surface.reportBackendTypeIsGPU()?"GPU":"CPU")),this.surface.getCanvas().scale(Globals.canvasScale,Globals.canvasScale)}setupFpsFont(){this.fpsTextFont=new this.canvasKit.Font(null,F.FPS_DISPLAY_TEXT_FONT_SIZE*Globals.canvasScale),this.fpsTextPaint=new this.canvasKit.Paint,this.fpsTextPaint.setColor(this.canvasKit.Color(F.FPS_DISPLAY_TEXT_COLOR[0],F.FPS_DISPLAY_TEXT_COLOR[1],F.FPS_DISPLAY_TEXT_COLOR[2],F.FPS_DISPLAY_TEXT_COLOR[3])),this.fpsTextPaint.setAntiAlias(!0)}setupCanvasDomEventHandlers(){if(void 0===this.htmlCanvas)throw new Error("main html canvas is undefined");this.htmlCanvas.addEventListener("pointerdown",this.htmlCanvasPointerDownHandler.bind(this)),this.htmlCanvas.addEventListener("pointerup",this.htmlCanvasPointerUpHandler.bind(this)),this.htmlCanvas.addEventListener("pointermove",this.htmlCanvasPointerMoveHandler.bind(this)),this.htmlCanvas.addEventListener("touchstart",(t=>{t.preventDefault()}))}loop(t){var e;if(this.gameStopRequested){if(void 0===this.surface)throw new Error("CanvasKit surface is undefined");this.surface.deleteLater()}else{if(this.animationFramesRequested++,!this.limitFps||this.animationFramesRequested%Math.round(60/F.LIMITED_FPS_RATE)==0){if(void 0===this.currentScene&&0===this.incomingSceneTransitions.length)throw new Error("Can not run game without a current or incoming scene");for(this.updateGameTime(),this.handleIncomingSceneTransitions(this.incomingSceneTransitions),this.update(),this.draw(t);this.snapshots.length>0;)null===(e=this.snapshots.shift())||void 0===e||e.delete();this.snapshots.push(this.takeCurrentSceneSnapshot()),this.freeEntitiesScene.draw(t),this.pendingScreenshot&&(this.handlePendingScreenshot(this.pendingScreenshot),this.pendingScreenshot=void 0)}if(this.priorUpdateTime=Globals.now,void 0===this.surface)throw new Error("CanvasKit surface is undefined");this.surface.requestAnimationFrame(this.loop.bind(this))}}updateGameTime(){this.options.timeStepping?Globals.now=this.steppingNow:Globals.now=performance.now(),this.priorUpdateTime?Globals.deltaTime=Globals.now-this.priorUpdateTime:Globals.deltaTime=0}handleIncomingSceneTransitions(t){if(0!==t.length&&(this.snapshots.length>0||t[0].transition.type===b.None)){const e=t.shift();if(void 0===e)throw new Error("no incoming scene transition");const i=e.scene,n=e.transition;if(n.type===b.None)return this.currentScene&&(this.currentScene._active=!1),this.currentScene=i,this.currentScene._active=!0,i._setupCallback&&i._setupCallback(i),void(i._appearCallback&&i._appearCallback(i));if(this.currentSceneSnapshot=this.snapshots.shift(),!this.currentSceneSnapshot)throw new Error("No snapshop available for outgoing scene");const r=this.createOutgoingScene(this.currentSceneSnapshot);r._active=!0,this.currentScene&&(this.currentScene._active=!1),this.currentScene=i,this.currentScene._active=!0,i._setupCallback&&i._setupCallback(i),this.animateSceneTransition(i,n,r)}}createOutgoingScene(t){const e=new I({name:F.OUTGOING_SCENE_NAME});e.size.width=this.canvasCssWidth,e.size.height=this.canvasCssHeight,this.addScene(e);const i=new f(F.OUTGOING_SCENE_IMAGE_NAME,t,this.canvasCssWidth,this.canvasCssHeight);this.session.imageManager.addLoadedImage(i,this.uuid);const n=new O({name:F.OUTGOING_SCENE_SPRITE_NAME,imageName:F.OUTGOING_SCENE_IMAGE_NAME,position:{x:this.canvasCssWidth/Globals.rootScale/2,y:this.canvasCssHeight/Globals.rootScale/2}});return n.scale=1/Globals.rootScale,e.addChild(n),e}update(){this.scenes.filter((t=>t._active)).forEach((t=>t.update())),this.freeEntitiesScene.update()}draw(t){this.scenes.filter((t=>t._active)).forEach((e=>e.draw(t))),this.drawnFrames++,this.calculateFps(),this.showFps&&this.drawFps(t)}calculateFps(){0===this.lastFpsUpdate?(this.lastFpsUpdate=Globals.now,this.nextFpsUpdate=Globals.now+F.FPS_DISPLAY_UPDATE_INTERVAL):Globals.now>=this.nextFpsUpdate&&(this.fpsRate=this.drawnFrames/((Globals.now-this.lastFpsUpdate)/1e3),this.drawnFrames=0,this.lastFpsUpdate=Globals.now,this.nextFpsUpdate=Globals.now+F.FPS_DISPLAY_UPDATE_INTERVAL,this.gameMetrics.length<this.maximumRecordedActivityMetrics&&this.fpsRate<this.fpsMetricReportThreshold&&this.gameMetrics.push({fps:Number.parseFloat(this.fpsRate.toFixed(2)),fps_interval_ms:F.FPS_DISPLAY_UPDATE_INTERVAL,fps_report_threshold:this.fpsMetricReportThreshold,activity_type:e.Game,activity_uuid:this.uuid,iso8601_timestamp:(new Date).toISOString()}))}takeCurrentSceneSnapshot(){if(void 0===this.surface)throw new Error("CanvasKit surface is undefined");return this.surface.makeImageSnapshot()}handlePendingScreenshot(t){if(!this.surface)throw new Error("no surface");let e;if(4==t.rect.length){const i=t.rect[0]*Globals.canvasScale,n=t.rect[1]*Globals.canvasScale,r=[i,n,i+t.rect[2]*Globals.canvasScale,n+t.rect[3]*Globals.canvasScale];e=this.surface.makeImageSnapshot(r)}else e=this.surface.makeImageSnapshot();const i=e.encodeToBytes();t.promiseResolve(i)}takeScreenshot(t,e,i,n){if(!this.surface)throw new Error("no canvaskit surface. unable to take screenshot.");const r=[t,e,i,n].map((t=>t?0:1)).reduce(((t,e)=>t+e));return new Promise(((a,o)=>{switch(r){case 0:if(!(t&&e&&i&&n))return void o("missing values in arguments for takeScreenshot()");this.pendingScreenshot={rect:[t,e,i,n],promiseResolve:a};break;case 4:this.pendingScreenshot={rect:[],promiseResolve:a};break;default:o("Exactly 0 or 4 arguments must be supplied to takeScreenshot()")}}))}animateSceneTransition(t,e,i){const n=e.duration;if(t._transitioning=!0,i._transitioning=!0,e.type!==b.Slide)throw new Error("unknown transition type");switch(e.direction){case w.Left:t.position.x=t.size.width,t.run(r.sequence([r.move({point:{x:0,y:0},duration:n,easing:e.easing,runDuringTransition:!0}),r.custom({callback:()=>{t._transitioning=!1,t._appearCallback&&t._appearCallback(t),this.removeScene(F.OUTGOING_SCENE_NAME)},runDuringTransition:!0})])),i.run(r.sequence([r.move({point:{x:-i.size.width,y:0},duration:n,easing:e.easing,runDuringTransition:!0}),r.custom({callback:()=>{i._active=!1,i._transitioning=!1,this.currentSceneSnapshot&&this.currentSceneSnapshot.delete()},runDuringTransition:!0})]));break;case w.Right:t.position.x=-t.size.width,t.run(r.sequence([r.move({point:{x:0,y:0},duration:n,easing:e.easing,runDuringTransition:!0}),r.custom({callback:()=>{t._transitioning=!1,t._appearCallback&&t._appearCallback(t),this.removeScene(F.OUTGOING_SCENE_NAME)},runDuringTransition:!0})])),i.run(r.sequence([r.move({point:{x:i.size.width,y:0},duration:n,easing:e.easing,runDuringTransition:!0}),r.custom({callback:()=>{i._active=!1,i._transitioning=!1,this.currentSceneSnapshot&&this.currentSceneSnapshot.delete()},runDuringTransition:!0})]));break;case w.Up:t.position.y=t.size.height,t.run(r.sequence([r.move({point:{x:0,y:0},duration:n,easing:e.easing,runDuringTransition:!0}),r.custom({callback:()=>{t._transitioning=!1,t._appearCallback&&t._appearCallback(t),this.removeScene(F.OUTGOING_SCENE_NAME)},runDuringTransition:!0})])),i.run(r.sequence([r.move({point:{x:0,y:-i.size.height},duration:n,easing:e.easing,runDuringTransition:!0}),r.custom({callback:()=>{i._active=!1,i._transitioning=!1,this.currentSceneSnapshot&&this.currentSceneSnapshot.delete()},runDuringTransition:!0})]));break;case w.Down:t.position.y=-t.size.height,t.run(r.sequence([r.move({point:{x:0,y:0},duration:n,easing:e.easing,runDuringTransition:!0}),r.custom({callback:()=>{t._transitioning=!1,t._appearCallback&&t._appearCallback(t),this.removeScene(F.OUTGOING_SCENE_NAME)},runDuringTransition:!0})])),i.run(r.sequence([r.move({point:{x:0,y:i.size.height},duration:n,easing:e.easing,runDuringTransition:!0}),r.custom({callback:()=>{i._active=!1,i._transitioning=!1,this.currentSceneSnapshot&&this.currentSceneSnapshot.delete()},runDuringTransition:!0})]));break;default:throw new Error("unknown transition direction")}}drawFps(t){t.save();const e=Globals.canvasScale;if(t.scale(1/e,1/e),!this.fpsTextFont||!this.fpsTextPaint)throw new Error("fps font or paint is undefined");t.drawText("FPS: "+this.fpsRate.toFixed(2),0,0+F.FPS_DISPLAY_TEXT_FONT_SIZE*e,this.fpsTextPaint,this.fpsTextFont),t.restore()}createEventListener(t,e,n,r=!0){const a=this.entities.filter((t=>t.name===e));a.length>1&&console.warn(`warning: createEventListener() found more than one entity with name ${e}. Event listener will be attached to first entity found. All entities that receive tap events should be uniquely named`);const o=a.filter((t=>t.name===e)).find(Boolean);if(void 0===o)throw new Error(`could not create event listener. entity with name ${e} could not be found in the game entity tree`);if(t!==i.PointerDown)throw new Error(`could not create event listener: event type ${t} is not known`);o.onPointerDown(n,r)}get entities(){function t(e,i){i.push(e),e.children.forEach((e=>t(e,i)))}const e=new Array;return[...this.scenes,this.freeEntitiesScene].forEach((i=>t(i,e))),e}htmlCanvasPointerDownHandler(t){t.preventDefault();const e=this.currentScene;if(!e||!this.sceneCanReceiveUserInteraction(e))return;const n={target:e,type:i.PointerDown,handled:!1};this.processDomPointerDown(this.freeEntitiesScene,n,t),this.processDomPointerDown(e,n,t)}htmlCanvasPointerUpHandler(t){t.preventDefault();const e=this.currentScene;if(!e||!this.sceneCanReceiveUserInteraction(e))return;const n={target:e,type:i.PointerUp,handled:!1};this.processDomPointerUp(this.freeEntitiesScene,n,t),this.processDomPointerUp(e,n,t)}htmlCanvasPointerMoveHandler(t){t.preventDefault();const e=this.currentScene;if(!e||!this.sceneCanReceiveUserInteraction(e))return;const n={target:e,type:i.PointerMove,handled:!1};this.processDomPointerMove(this.freeEntitiesScene,n,t),this.processDomPointerMove(e,n,t)}processDomPointerDown(t,e,i){e.handled||(t.isUserInteractionEnabled&&this.IsCanvasPointWithinEntityBounds(t,i.offsetX,i.offsetY)&&(t.pressed=!0,t.pressedInHitArea=!0,this.raiseM2PointerDownEvent(t,e,i),this.raiseTapDownEvent(t,e,i)),t.children&&t.children.filter((t=>!t.hidden)).filter((t=>t.isDrawable)).sort(((t,e)=>e.zPosition-t.zPosition)).forEach((t=>this.processDomPointerDown(t,e,i))))}processDomPointerUp(t,e,i){e.handled||(t.isUserInteractionEnabled&&t.pressed&&t.pressedInHitArea?(t.pressed=!1,t.pressedInHitArea=!1,this.raiseTapUpEvent(t,e,i),this.raiseTapUpAny(t,e,i),this.raiseM2PointerUpEvent(t,e,i)):t.isUserInteractionEnabled&&t.pressed&&0==t.pressedInHitArea?(t.pressed=!1,t.pressedInHitArea=!1,this.raiseTapUpAny(t,e,i)):t.isUserInteractionEnabled&&this.IsCanvasPointWithinEntityBounds(t,i.offsetX,i.offsetY)&&(t.pressed=!1,t.pressedInHitArea=!1,this.raiseM2PointerUpEvent(t,e,i)),t.children&&t.children.filter((t=>!t.hidden)).filter((t=>t.isDrawable)).sort(((t,e)=>e.zPosition-t.zPosition)).forEach((t=>this.processDomPointerUp(t,e,i))))}processDomPointerMove(t,e,i){e.handled||(t.isUserInteractionEnabled&&t.pressed&&t.pressedInHitArea&&!this.IsCanvasPointWithinEntityBounds(t,i.offsetX,i.offsetY)&&(t.pressedInHitArea=!1,this.raiseTapLeaveEvent(t,e,i)),this.IsCanvasPointWithinEntityBounds(t,i.offsetX,i.offsetY)&&this.raiseM2PointerMoveEvent(t,e,i),t.children&&t.children.filter((t=>!t.hidden)).filter((t=>t.isDrawable)).sort(((t,e)=>e.zPosition-t.zPosition)).forEach((t=>this.processDomPointerMove(t,e,i))))}raiseM2PointerDownEvent(t,e,n){e.target=t,e.type=i.PointerDown,this.raiseEventOnListeningEntities(t,e,n)}raiseTapDownEvent(t,e,n){e.target=t,e.type=i.TapDown,this.raiseEventOnListeningEntities(t,e,n)}raiseTapLeaveEvent(t,e,n){e.target=t,e.type=i.TapLeave,this.raiseEventOnListeningEntities(t,e,n)}raiseM2PointerUpEvent(t,e,n){e.target=t,e.type=i.PointerUp,this.raiseEventOnListeningEntities(t,e,n)}raiseTapUpEvent(t,e,n){e.target=t,e.type=i.TapUp,this.raiseEventOnListeningEntities(t,e,n)}raiseTapUpAny(t,e,n){e.target=t,e.type=i.TapUpAny,this.raiseEventOnListeningEntities(t,e,n)}raiseM2PointerMoveEvent(t,e,n){e.target=t,e.type=i.PointerMove,this.raiseEventOnListeningEntities(t,e,n)}calculatePointWithinEntityFromDomPointerEvent(t,e){const i=e.offsetX,n=e.offsetY,r=this.calculateEntityAbsoluteBoundingBox(t);return{x:(i-r.xMin)/(r.xMax-r.xMin)*t.size.width,y:(n-r.yMin)/(r.yMax-r.yMin)*t.size.height}}raiseEventOnListeningEntities(t,e,n){t.eventListeners.filter((t=>t.type===e.type)).forEach((r=>{if(r.entityUuid===t.uuid)switch(e.target=t,e.type){case i.PointerDown:case i.PointerMove:case i.PointerUp:case i.TapDown:case i.TapUp:case i.TapUpAny:case i.TapLeave:e.point=this.calculatePointWithinEntityFromDomPointerEvent(t,n),e.buttons=n.buttons,r.callback(e)}}))}sceneCanReceiveUserInteraction(t){var e;return t.game===(null===(e=t.game.session)||void 0===e?void 0:e.currentActivity)&&!1===t._transitioning}IsCanvasPointWithinEntityBounds(t,e,i){if(!t.isDrawable)throw"only drawable entities can receive pointer events";if(0===t.size.width||0===t.size.height)return!1;if(t.type===y.TextLine&&isNaN(t.size.width))return!1;const n=this.calculateEntityAbsoluteBoundingBox(t);return!!(t.isUserInteractionEnabled&&e>=n.xMin&&e<=n.xMax&&i>=n.yMin&&i<=n.yMax)}calculateEntityAbsoluteBoundingBox(t){const e=t.anchorPoint,i=t.absoluteScale;return{xMin:t.absolutePosition.x-t.size.width*e.x*i,xMax:t.absolutePosition.x+t.size.width*(1-e.x)*i,yMin:t.absolutePosition.y-t.size.height*e.y*i,yMax:t.absolutePosition.y+t.size.height*(1-e.y)*i}}}{constructor(){const t={number_of_top_pairs:{default:3,type:"integer",enum:[1,2,3,4],description:"Number of pairs to be shown on top. (1-4)"},lure_percent:{default:.5,type:"number",description:"Percentage of lure trials. Number from 0 to 1. A lure trial is when the incorrect symbol pair on the bottom contains exactly one symbol that is found on the top.(1 unique symbol). A non-lure trial is when the incorrect symbol pair contains exactly zero symbols that match the top. (2 unique symbols.)"},left_correct_percent:{default:.5,type:"number",description:"Percentage of trials where the left pair is the correct answer. Number from 0 to 1."},preparation_duration_ms:{default:3e3,type:"number",description:"Duration of the preparation phase ('get ready' countdown, milliseconds). Multiples of 1000 recommended."},after_preparation_transition_duration_ms:{default:500,type:"number",description:"Duration, in milliseconds, of the slide in animation after the preparation phase."},number_of_trials:{default:5,type:"integer",description:"How many trials to run."},interstimulus_animation:{default:!0,type:"boolean",description:"Should new trials slide in from right to left?"},interstimulus_interval_duration_ms:{default:500,type:"number",description:"If interstimulus_animation == true, the duration, in milliseconds, of the slide in animation after each trial. Otherise, the duration, in milliseconds, to wait after a trial has been completed until a new trial appears."},instruction_type:{default:"long",type:"string",enum:["short","long"],description:"Type of instructions to show, 'short' or 'long'."},show_trials_complete_scene:{default:!0,type:"boolean",description:"After the final trial, should a completion scene be shown? Otherwise, the game will immediately end."},trials_complete_scene_text:{default:"You have completed all the symbol search trials",type:"string",description:"Text for scene displayed after all trials are complete."},trials_complete_scene_button_text:{default:"OK",type:"string",description:"Button text for scene displayed after all trials are complete."},show_quit_button:{type:"boolean",default:!0,description:"Should the activity quit button be shown?"},show_fps:{type:"boolean",default:!1,description:"Should the FPS be shown?"}},e=160;super({name:"Symbol Search",id:"symbol-search",version:"0.8.1",shortDescription:"Symbol Search is a test of processing speed, where participants see a row of symbol pairs at the top of the screen and match them to symbol pairs at the bottom of the screen.",longDescription:'On each trial of the symbol search task, participants saw a row of three symbol pairs at the top of the screen and were presented with two symbol pairs at the bottom of the screen. Stimuli were presented until a response was provided there was an interval of 200 msec. between each response and the following stimulus. Participants decided, as quickly as possible, which of the two pairs presented at the bottom of the screen was among the pairs at the top of the screen (see Figure 1). Participants completed 12 trials of this task. The dependent variable was median response time of correct trials. Because this task requires speeded comparisons similar to standard laboratory tests, we reasoned it would be a viable indicator of perceptual speed. SOURCE: Sliwinski, Martin J., Jacqueline A. Mogle, Jinshil Hyun, Elizabeth Munoz, Joshua M. Smyth, and Richard B. Lipton. "Reliability and validity of ambulatory cognitive assessments." Assessment 25, no. 1 (2018): 14-30.',showFps:t.show_fps.default,width:400,height:800,trialSchema:{activity_begin_iso8601_timestamp:{type:"string",format:"date-time",description:"ISO 8601 timestamp at the beginning of the game activity."},trial_begin_iso8601_timestamp:{type:["string","null"],format:"date-time",description:"ISO 8601 timestamp at the beginning of the trial. Null if trial was skipped."},trial_index:{type:["integer","null"],description:"Index of the trial within this assessment, 0-based."},trial_type:{type:["string","null"],enum:["normal","lure",null],description:"Indicates if trial was normal or lure. Null if trial was skipped."},card_configuration:{type:["object","null"],description:"Symbols used on cards. Null if trial was skipped.",properties:{top_cards_symbols:{type:"array",description:"Symbols of the top cards, starting at 0 for leftmost upper card and incrementing by 1 moving right.",items:{type:"object",properties:{top:{type:"integer",description:"Index of the top symbol within the card, 1-based."},bottom:{type:"integer",description:"Index of the bottom symbol within the card, 1-based."}}}},bottom_cards_symbols:{type:"array",description:"Symbols of the bottom cards, starting at 0 for leftmost card and incrementing by 1 moving right.",items:{type:"object",properties:{top:{type:"integer",description:"Index of the top symbol within the card, 1-based."},bottom:{type:"integer",description:"Index of the bottom symbol within the card, 1-based."}}}}}},response_time_duration_ms:{type:["number","null"],description:"Milliseconds from the beginning of the trial until a user taps a response. Null if trial was skipped."},user_response_index:{type:["integer","null"],description:"Index of user selected response, starting at 0 for leftmost card and incrementing by 1 moving right. Null if trial was skipped."},correct_response_index:{type:["integer","null"],description:"Index of correct response, starting at 0 for leftmost card and incrementing by 1 moving right. Null if trial was skipped."},quit_button_pressed:{type:"boolean",description:"Was the quit button pressed?"}},parameters:t,fontUrls:["assets/symbol-search/fonts/roboto/Roboto-Regular.ttf"],bodyBackgroundColor:x.White,images:[{imageName:"gameImage",height:340,width:255,url:"assets/symbol-search/img/gameImage.png"},{imageName:"gameImageOutlinedCards",height:340,width:255,url:"assets/symbol-search/img/gameImageOutlinedCards.png"},{imageName:"stopwatchImage",height:319,width:256,url:"assets/symbol-search/img/stopwatch.svg"},{imageName:"ssintroImage",height:186,width:336,url:"assets/symbol-search/img/ssintroImage.png"},{imageName:"ss-01",height:e,width:e,url:"assets/symbol-search/img/ss-01.svg"},{imageName:"ss-02",height:e,width:e,url:"assets/symbol-search/img/ss-02.svg"},{imageName:"ss-03",height:e,width:e,url:"assets/symbol-search/img/ss-03.svg"},{imageName:"ss-04",height:e,width:e,url:"assets/symbol-search/img/ss-04.svg"},{imageName:"ss-05",height:e,width:e,url:"assets/symbol-search/img/ss-05.svg"},{imageName:"ss-06",height:e,width:e,url:"assets/symbol-search/img/ss-06.svg"},{imageName:"ss-07",height:e,width:e,url:"assets/symbol-search/img/ss-07.svg"},{imageName:"ss-08",height:e,width:e,url:"assets/symbol-search/img/ss-08.svg"},{imageName:"ss-09",height:e,width:e,url:"assets/symbol-search/img/ss-09.svg"},{imageName:"ss-10",height:e,width:e,url:"assets/symbol-search/img/ss-10.svg"},{imageName:"ss-11",height:e,width:e,url:"assets/symbol-search/img/ss-11.svg"},{imageName:"ss-12",height:e,width:e,url:"assets/symbol-search/img/ss-12.svg"},{imageName:"ss-13",height:e,width:e,url:"assets/symbol-search/img/ss-13.svg"},{imageName:"ss-14",height:e,width:e,url:"assets/symbol-search/img/ss-14.svg"},{imageName:"ss-15",height:e,width:e,url:"assets/symbol-search/img/ss-15.svg"},{imageName:"ss-16",height:e,width:e,url:"assets/symbol-search/img/ss-16.svg"},{imageName:"ss-17",height:e,width:e,url:"assets/symbol-search/img/ss-17.svg"},{imageName:"ss-18",height:e,width:e,url:"assets/symbol-search/img/ss-18.svg"},{imageName:"ss-19",height:e,width:e,url:"assets/symbol-search/img/ss-19.svg"},{imageName:"ss-20",height:e,width:e,url:"assets/symbol-search/img/ss-20.svg"},{imageName:"ss-21",height:e,width:e,url:"assets/symbol-search/img/ss-21.svg"},{imageName:"ss-22",height:e,width:e,url:"assets/symbol-search/img/ss-22.svg"},{imageName:"ss-23",height:e,width:e,url:"assets/symbol-search/img/ss-23.svg"},{imageName:"ss-24",height:e,width:e,url:"assets/symbol-search/img/ss-24.svg"},{imageName:"circle-x",height:32,width:32,url:"assets/symbol-search/img/circle-x.svg"}]})}init(){super.init();const t=this;if(t.getParameter("show_quit_button")){const e=new O({imageName:"circle-x",position:{x:380,y:20},isUserInteractionEnabled:!0});t.addFreeEntity(e),e.onTapDown((e=>{t.removeAllFreeEntities(),e.handled=!0;const i=new I;t.addScene(i),t.presentScene(i),t.addTrialData("quit_button_pressed",!0),t.trialComplete(),t.cancel()}))}let e;const i={backgroundColor:x.White,nextButtonBackgroundColor:x.Black,backButtonBackgroundColor:x.Black,nextSceneTransition:R.slide({direction:w.Left,duration:500,easing:n.sinusoidalInOut}),backSceneTransition:R.slide({direction:w.Right,duration:500,easing:n.sinusoidalInOut})};switch(t.getParameter("instruction_type")){case"short":e=K.Create(Object.assign(Object.assign({},i),{instructionScenes:[{title:"Symbol Search",text:"Goal: Touch the set on the bottom that is exactly the same as a set above, as fast and accurately as you can.",imageName:"ssintroImage",imageAboveText:!1,imageMarginTop:12,textFontSize:24,titleFontSize:30,textVerticalBias:.25,nextButtonText:"START",nextButtonBackgroundColor:x.Green}]}));break;case"long":e=K.Create(Object.assign(Object.assign({},i),{instructionScenes:[{title:"Symbol Search",text:"You will see sets of symbols on the top and bottom of the screen.",imageName:"gameImage",imageAboveText:!1,imageMarginTop:12,textFontSize:24,titleFontSize:30,textVerticalBias:.25},{title:"Symbol Search",text:"When prompted, touch the set on the bottom that is exactly the same as a set above.",imageName:"gameImageOutlinedCards",imageAboveText:!1,imageMarginTop:12,textFontSize:24,titleFontSize:30,textVerticalBias:.25},{title:"Symbol Search",text:"Please be as fast and accurate as you can.",imageName:"stopwatchImage",imageAboveText:!1,imageMarginTop:48,textFontSize:24,titleFontSize:30,textVerticalBias:.25,nextButtonText:"START",nextButtonBackgroundColor:x.Green}]}));break;default:throw new Error(`invalid value for instruction_type: ${t.getParameter("instruction_type")}`)}e[0].onAppear((()=>{t.addTrialData("activity_begin_iso8601_timestamp",this.beginIso8601Timestamp)})),t.addScenes(e);const a=R.slide({direction:w.Left,duration:t.getParameter("interstimulus_interval_duration_ms"),easing:n.sinusoidalInOut}),o=new I;t.addScene(o);const s=new V({circleOfRadius:100,position:{x:200,y:350},fillColor:[44,90,255,1]});o.addChild(s);const l=Math.floor(t.getParameter("preparation_duration_ms")/1e3),c=new H({text:l.toString(),fontSize:50,preferredMaxLayoutWidth:200,horizontalAlignmentMode:W.Center,fontColor:[255,255,255,1]});s.addChild(c);const h=new H({text:"GET READY",fontSize:50,preferredMaxLayoutWidth:300,horizontalAlignmentMode:W.Center,position:{x:200,y:500}});o.addChild(h);const u=new Array;for(let t=l-1;t>0;t--)u.push(r.wait({duration:1e3})),u.push(r.custom({callback:()=>{c.text=t.toString()}}));u.push(r.wait({duration:1e3})),u.push(r.custom({callback:()=>{c.text="0"}})),u.push(r.custom({callback:()=>{t.presentScene(d,R.slide({direction:w.Left,duration:t.getParameter("after_preparation_transition_duration_ms"),easing:n.sinusoidalInOut}))}})),o.onAppear((()=>{o.run(r.sequence(u))}));const d=new I({name:"chooseCardScene",backgroundColor:[169,201,219,1]});t.addScene(d);const f=new V({rect:{size:{width:400,height:400}},fillColor:[166,177,181,1],position:{x:200,y:600}});d.addChild(f);const p=new H({text:"Which of these matches a pair above?",fontSize:22,preferredMaxLayoutWidth:240});d.addChild(p),p.position={x:200,y:460};const m=new H({text:"or",fontSize:22,preferredMaxLayoutWidth:240});d.addChild(m),m.position={x:200,y:580};const g=[],y=t.getParameter("number_of_trials"),v=t.getParameter("lure_percent"),b=t.getParameter("left_correct_percent"),S=t.getParameter("number_of_top_pairs"),_=Math.round(y*v),C=Math.round(y*b),T=$.FromRangeWithoutReplacement(_,0,y-1),P=$.FromRangeWithoutReplacement(C,0,y-1);for(let t=0;t<y;t++){const e=T.includes(t),i=P.includes(t);let n;n=e?$.FromRangeWithoutReplacement(2*S+1,1,24):$.FromRangeWithoutReplacement(2*S+2,1,24);const r=new Array;for(let t=0;t<S;t++){const e={top:n[2*t],bottom:n[2*t+1]};r.push(e)}const a=r[$.FromRangeWithoutReplacement(1,0,S-1)[0]];let o;if(e){const t=r.filter((t=>t!=a)).map((t=>[t.top,t.bottom])).flat();o={top:t[$.FromRangeWithoutReplacement(1,0,t.length-1)[0]],bottom:n[2*S]}}else o={top:n[2*S],bottom:n[2*S+1]};const s={top_cards_symbols:r,bottom_cards_symbols:i?[a,o]:[o,a],trial_type:e?"lure":"normal",correct_response_index:i?0:1};g.push(s)}d.onSetup((()=>{m.hidden=!1;const e=g[t.trialIndex],i=e.top_cards_symbols.length,n=e.bottom_cards_symbols.length;let o,s;switch(i){case 2:case 4:o=200;break;case 3:o=100;break;default:throw new Error("valid values for number_of_top_pairs are 2, 3, or 4 cards")}if(i>=1&&i<=3)s=new q({rows:1,columns:i,size:{width:80*i+o,height:160},position:{x:200,y:200},backgroundColor:x.Transparent,gridLineColor:x.Transparent});else{if(4!==i)throw new Error("invalid number_of_top_pairs");s=new q({rows:2,columns:2,size:{width:160+o,height:200+o},position:{x:200,y:200},backgroundColor:x.Transparent,gridLineColor:x.Transparent})}d.addChild(s);const l=new q({rows:1,columns:2,size:{width:360,height:160},position:{x:200,y:600},backgroundColor:x.Transparent,gridLineColor:x.Transparent});function c(t,e){const i=new V({rect:{size:{width:80,height:160}},fillColor:x.White,strokeColor:x.Black,lineWidth:2}),n=new O({imageName:"ss-"+t.toString().padStart(2,"0"),position:{x:0,y:-36}});i.addChild(n);const r=new O({imageName:"ss-"+e.toString().padStart(2,"0"),position:{x:0,y:36}});return i.addChild(r),i}d.addChild(l);const h=new Array;for(let t=0;t<i;t++){const n=c(e.top_cards_symbols[t].top,e.top_cards_symbols[t].bottom);h.push(n),4===i?s.addAtCell(n,Math.floor(t/2),t%2):s.addAtCell(n,0,t)}const u=new Array;for(let t=0;t<n;t++){const i=c(e.bottom_cards_symbols[t].top,e.bottom_cards_symbols[t].bottom);i.userData={index:t},u.push(i),l.addAtCell(i,0,t)}function f(t){t?u.forEach((t=>t.isUserInteractionEnabled=!0)):u.forEach((t=>t.isUserInteractionEnabled=!1))}u.forEach((i=>i.onTapDown((()=>function(i){l.hidden=!0,s.hidden=!0,m.hidden=!0,A.stop("rt"),f(!1);const n=A.elapsed("rt");A.remove("rt"),t.addTrialData("trial_type",e.trial_type),t.addTrialData("response_time_duration_ms",n),t.addTrialData("correct_response_index",e.correct_response_index),t.addTrialData("user_response_index",i.userData.index);const o=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i}(e,["correct_response_index","trial_type"]);t.addTrialData("card_configuration",o),t.addTrialData("quit_button_pressed",!1),t.addTrialData("trial_index",t.trialIndex),t.trialComplete(),t.trialIndex<t.getParameter("number_of_trials")?(m.hidden=!0,t.getParameter("interstimulus_animation")?t.presentScene(d,a):d.run(r.sequence([r.wait({duration:t.getParameter("interstimulus_interval_ms")}),r.custom({callback:()=>{t.presentScene(d)}})]))):(p.hidden=!1,t.removeFreeEntity("questionLabelFree"),t.getParameter("show_trials_complete_scene")?t.presentScene(E,a):t.end())}(i))))),d.onAppear((()=>{if(t.addTrialData("activity_begin_iso8601_timestamp",this.beginIso8601Timestamp),t.addTrialData("trial_begin_iso8601_timestamp",(new Date).toISOString()),!t.entities.map((t=>t.name)).includes("questionLabelFree")){p.hidden=!0;const e=new H({name:"questionLabelFree",text:"Which of these matches a pair above?",fontSize:22,preferredMaxLayoutWidth:240});t.addFreeEntity(e),e.position={x:200,y:460}}f(!0),A.start("rt")}))}));const E=new I;t.addScene(E);const k=new H({text:t.getParameter("trials_complete_scene_text"),position:{x:200,y:400}});E.addChild(k);const M=new Y({text:t.getParameter("trials_complete_scene_button_text"),position:{x:200,y:600},backgroundColor:x.Black});M.isUserInteractionEnabled=!0,M.onTapDown((()=>{M.isUserInteractionEnabled=!1,E.removeAllChildren(),t.end()})),E.addChild(M),E.onSetup((()=>{t.removeAllFreeEntities()}))}}export{Q as SymbolSearch};

import{Composite as t,WebColors as i,Shape as e,Label as o,CanvasKitHelpers as n,EventType as s,Easings as r,Story as l,Transition as a,TransitionDirection as d,LabelHorizontalAlignmentMode as h,Scene as c,Dimensions as u,Sprite as g}from"./m2c2kit.core.esm.min.js";class C extends t{constructor(t){if(super(t),this.compositeType="grid",this.rows=0,this.columns=0,this.gridBackgroundColor=[0,0,233,.25],this.gridLineColor=i.Red,this.gridLineWidth=1,this.gridChildren=new Array,!t.size)throw new Error("grid size must be specified");if(this.size=t.size,!t.rows)throw new Error("rows must be specified");if(!(t.rows>=1))throw new Error("rows must be at least 1");if(this.rows=t.rows,!t.columns)throw new Error("columns must be specified");if(!(t.columns>=1))throw new Error("columns must be at least 1");this.columns=t.columns,t.backgroundColor&&(this.gridBackgroundColor=t.backgroundColor),t.gridLineColor&&(this.gridLineColor=t.gridLineColor),t.gridLineWidth&&(this.gridLineWidth=t.gridLineWidth),this.cellWidth=this.size.width/this.columns,this.cellHeight=this.size.height/this.rows}initialize(){super.removeAllChildren(),this.gridBackground=new e({name:"_"+this.name+"-gridBackground",rect:{size:this.size},fillColor:this.gridBackgroundColor,strokeColor:this.gridLineColor,lineWidth:this.gridLineWidth,isUserInteractionEnabled:this.isUserInteractionEnabled}),this.addChild(this.gridBackground),this.gridBackground.isUserInteractionEnabled=this.isUserInteractionEnabled;for(let t=1;t<this.columns;t++){const i=new e({name:"_"+this.name+"-gridVerticalLine-"+t,rect:{size:{width:this.gridLineWidth,height:this.size.height},origin:{x:-this.size.width/2+this.cellWidth*t,y:0}},fillColor:this.gridLineColor});this.gridBackground.addChild(i)}for(let t=1;t<this.rows;t++){const i=new e({name:"_"+this.name+"-gridHorizontalLine-"+t,rect:{size:{width:this.size.width,height:this.gridLineWidth},origin:{x:0,y:-this.size.height/2+this.cellHeight*t}},fillColor:this.gridLineColor});this.gridBackground.addChild(i)}this.gridChildren&&this.gridChildren.forEach((t=>{if(!this.cellWidth||!this.cellHeight||!this.gridBackground)throw new Error("cellWidth, cellHeight, or gridBackground undefined or null");const i=-this.size.width/2+this.cellWidth/2+t.column*this.cellWidth,e=-this.size.height/2+this.cellHeight/2+t.row*this.cellHeight;t.entity.position={x:i,y:e},this.gridBackground.addChild(t.entity)})),this.needsInitialization=!1}dispose(){}duplicate(t){const i=new C(Object.assign(Object.assign(Object.assign({},this.getEntityOptions()),this.getDrawableOptions()),{rows:this.rows,columns:this.columns,size:this.size,backgroundColor:this.gridBackgroundColor,gridLineWidth:this.gridLineWidth,gridLineColor:this.gridLineColor,name:t}));return this.children.length>0&&(i.children=this.children.map((t=>{const e=t.duplicate();return e.parent=i,e}))),i}update(){super.update()}draw(t){super.drawChildren(t)}warmup(t){this.initialize(),this.children.filter((t=>t.isDrawable)).forEach((i=>{i.warmup(t)}))}removeAllChildren(){if(0!==this.gridChildren.length){for(;this.gridChildren.length;)this.gridChildren.pop();this.needsInitialization=!0}}addAtCell(t,i,e){(i<0||i>=this.rows||e<0||e>=this.columns)&&console.warn(`warning: addAtCell() requested to add entity at row ${i}, column ${e}. This is outside the bounds of grid ${this.name}, which is size ${this.rows}x${this.columns}. Note that addAtCell() uses zero-based indexing. AddAtCell() will proceed, but may draw entities outside the grid`),this.gridChildren.push({entity:t,row:i,column:e}),this.needsInitialization=!0}removeAllAtCell(t,i){this.gridChildren=this.gridChildren.filter((e=>e.row!=t&&e.column!=i)),this.needsInitialization=!0}removeChild(t){if(!this.gridBackground)throw new Error("gridBackground is null or undefined");this.gridBackground.removeChild(t),this.gridChildren=this.gridChildren.filter((i=>i.entity!=t)),this.needsInitialization=!0}}class m extends t{constructor(t){super(t),this.compositeType="button",this._backgroundColor=i.Black,this.size={width:200,height:50},this.cornerRadius=9,this.fontSize=20,this.text="",this._fontColor=i.White,t.text&&(this.text=t.text),t.size&&(this.size=t.size),t.cornerRadius&&(this.cornerRadius=t.cornerRadius),t.fontSize&&(this.fontSize=t.fontSize),t.fontColor&&(this.fontColor=t.fontColor),t.backgroundColor&&(this.backgroundColor=t.backgroundColor)}initialize(){this.removeAllChildren(),this.backgroundPaint=new this.canvasKit.Paint,this.backgroundPaint.setColor(this.canvasKit.Color(this.backgroundColor[0],this.backgroundColor[1],this.backgroundColor[2],this.backgroundColor[3])),this.backgroundPaint.setStyle(this.canvasKit.PaintStyle.Fill);const t=new e({rect:{size:this.size},cornerRadius:this.cornerRadius,fillColor:this._backgroundColor});this.addChild(t);const i=new o({text:this.text,fontSize:this.fontSize,fontColor:this.fontColor});t.addChild(i),this.needsInitialization=!1}dispose(){n.Dispose([this.backgroundPaint])}get backgroundColor(){return this._backgroundColor}set backgroundColor(t){this._backgroundColor=t,this.needsInitialization=!0}get fontColor(){return this._fontColor}set fontColor(t){this._fontColor=t,this.needsInitialization=!0}duplicate(t){const i=new m(Object.assign(Object.assign(Object.assign(Object.assign({},this.getEntityOptions()),this.getDrawableOptions()),this.getTextOptions()),{size:this.size,cornerRadius:this.cornerRadius,backgroundColor:this.backgroundColor,fontColor:this.fontColor,name:t}));return this.children.length>0&&(i.children=this.children.map((t=>{const e=t.duplicate();return e.parent=i,e}))),i}update(){super.update()}draw(t){super.drawChildren(t)}warmup(t){this.initialize(),this.children.filter((t=>t.isDrawable)).forEach((i=>{i.warmup(t)}))}}var p;!function(t){t.Dismiss="Dismiss",t.Positive="Positive",t.Negative="Negative"}(p||(p={}));class f extends t{constructor(t){super(t),this.compositeType="dialog",this._backgroundColor=i.White,this.cornerRadius=9,this.overlayAlpha=.5,this.contentText="",this.positiveButtonText="",this.negativeButtonText="",this.zPosition=Number.MAX_VALUE,this.hidden=!0,this._fontColor=i.White,t&&(t.overlayAlpha&&(this.overlayAlpha=t.overlayAlpha),t.messageText&&(this.contentText=t.messageText),t.positiveButtonText&&(this.positiveButtonText=t.positiveButtonText),t.negativeButtonText&&(this.negativeButtonText=t.negativeButtonText),t.size&&(this.size=t.size),t.cornerRadius&&(this.cornerRadius=t.cornerRadius),t.fontColor&&(this.fontColor=t.fontColor),t.backgroundColor&&(this.backgroundColor=t.backgroundColor))}show(){this.hidden=!1}onDialolgResult(t,i=!0){const e={type:s.CompositeCustom,entityUuid:this.uuid,callback:t};i&&(this.eventListeners=this.eventListeners.filter((t=>!(t.entityUuid===e.entityUuid&&t.type===e.type)))),this.eventListeners.push(e)}initialize(){this.removeAllChildren();const t=new e({rect:{width:Globals.canvasCssWidth,height:Globals.canvasCssHeight,x:Globals.canvasCssWidth/2,y:Globals.canvasCssHeight/2},fillColor:[0,0,0,this.overlayAlpha],zPosition:-1,isUserInteractionEnabled:!0});t.onTapDown((t=>{t.handled=!0,this.hidden=!0,this.eventListeners.length>0&&this.eventListeners.filter((t=>t.type===s.CompositeCustom)).forEach((t=>{const i={type:s.CompositeCustom,target:this,handled:!1,dialogResult:p.Dismiss};t.callback(i)}))})),this.addChild(t);const i=new e({rect:{width:300,height:150,x:Globals.canvasCssWidth/2,y:Globals.canvasCssHeight/2},cornerRadius:this.cornerRadius,fillColor:this.backgroundColor,isUserInteractionEnabled:!0});i.onTapDown((t=>{t.handled=!0})),this.addChild(i);const n=new o({text:this.contentText,fontSize:24,position:{x:200,y:360}});this.addChild(n);const r=new m({text:this.negativeButtonText,position:{x:120,y:440},size:{width:100,height:40},isUserInteractionEnabled:!0,zPosition:1});r.onTapDown((t=>{t.handled=!0,this.hidden=!0})),r.onTapDown((t=>{t.handled=!0,this.hidden=!0,this.eventListeners.length>0&&this.eventListeners.filter((t=>t.type===s.CompositeCustom)).forEach((t=>{const i={type:s.CompositeCustom,target:this,handled:!1,dialogResult:p.Negative};t.callback(i)}))}));const l=new m({text:this.positiveButtonText,position:{x:280,y:440},size:{width:100,height:40},isUserInteractionEnabled:!0,zPosition:1});l.onTapDown((t=>{t.handled=!0,this.hidden=!0,this.eventListeners.length>0&&this.eventListeners.filter((t=>t.type===s.CompositeCustom)).forEach((t=>{const i={type:s.CompositeCustom,target:this,handled:!1,dialogResult:p.Positive};t.callback(i)}))})),this.addChild(r),this.addChild(l),this.needsInitialization=!1}get backgroundColor(){return this._backgroundColor}set backgroundColor(t){this._backgroundColor=t,this.needsInitialization=!0}get fontColor(){return this._fontColor}set fontColor(t){this._fontColor=t,this.needsInitialization=!0}duplicate(t){throw new Error("duplicate not implemented")}update(){super.update()}draw(t){super.drawChildren(t)}warmup(t){this.initialize(),this.children.filter((t=>t.isDrawable)).forEach((i=>{i.warmup(t)}))}}const w=r.sinusoidalInOut;class b extends l{static Create(t){const e=new Array;return t.instructionScenes.forEach(((n,s)=>{var r,l,C,p,f,b,v,k,x,z,B,T,y,S,E,O,L,W,I,A,R,D,_,H,N,P,U,M,j,F,G,$,V,K,q;const X=null!==(l=null!==(r=n.nextSceneTransition)&&void 0!==r?r:t.nextSceneTransition)&&void 0!==l?l:a.slide({direction:d.Left,duration:500,easing:w}),J=null!==(p=null!==(C=n.backSceneTransition)&&void 0!==C?C:t.backSceneTransition)&&void 0!==p?p:a.slide({direction:d.Right,duration:500,easing:w}),Q=null!==(b=null!==(f=n.backButtonText)&&void 0!==f?f:t.backButtonText)&&void 0!==b?b:"Back",Y=null!==(k=null!==(v=n.nextButtonText)&&void 0!==v?v:t.nextButtonText)&&void 0!==k?k:"Next",Z=null!==(z=null!==(x=n.backButtonWidth)&&void 0!==x?x:t.backButtonWidth)&&void 0!==z?z:125,tt=null!==(T=null!==(B=n.nextButtonWidth)&&void 0!==B?B:t.nextButtonWidth)&&void 0!==T?T:125,it=null!==(S=null!==(y=n.backButtonHeight)&&void 0!==y?y:t.backButtonHeight)&&void 0!==S?S:50,et=null!==(O=null!==(E=n.nextButtonHeight)&&void 0!==E?E:t.nextButtonHeight)&&void 0!==O?O:50,ot=null!==(L=n.backgroundColor)&&void 0!==L?L:t.backgroundColor,nt=null===(W=n.imageAboveText)||void 0===W||W,st=null!==(I=n.imageMarginTop)&&void 0!==I?I:0,rt=null!==(A=n.imageMarginBottom)&&void 0!==A?A:0,lt=null!==(R=n.textMarginStart)&&void 0!==R?R:48,at=null!==(D=n.textMarginEnd)&&void 0!==D?D:48,dt=null!==(_=n.textAlignmentMode)&&void 0!==_?_:h.Left,ht=null!==(H=n.textFontSize)&&void 0!==H?H:16,ct=null!==(N=n.titleFontSize)&&void 0!==N?N:16,ut=null!==(P=n.titleMarginTop)&&void 0!==P?P:48,gt=null!==(M=null!==(U=n.backButtonBackgroundColor)&&void 0!==U?U:t.backButtonBackgroundColor)&&void 0!==M?M:i.Black,Ct=null!==(F=null!==(j=n.backButtonFontColor)&&void 0!==j?j:t.backButtonFontColor)&&void 0!==F?F:i.White,mt=null!==($=null!==(G=n.nextButtonBackgroundColor)&&void 0!==G?G:t.nextButtonBackgroundColor)&&void 0!==$?$:i.Black,pt=null!==(K=null!==(V=n.nextButtonFontColor)&&void 0!==V?V:t.nextButtonFontColor)&&void 0!==K?K:i.White,ft=null!==(q=t.sceneNamePrefix)&&void 0!==q?q:"instructions",wt=new c({name:ft+"-"+(s+1).toString().padStart(2,"0"),backgroundColor:ot});let bt,vt;if(void 0!==n.title&&(bt=new o({text:n.title,fontSize:ct,layout:{marginTop:ut,constraints:{topToTopOf:wt,startToStartOf:wt,endToEndOf:wt}}}),wt.addChild(bt)),void 0!==n.text&&(vt=new o({text:n.text,preferredMaxLayoutWidth:u.MatchConstraint,horizontalAlignmentMode:dt,fontSize:ht,layout:{marginStart:lt,marginEnd:at,constraints:{topToTopOf:wt,bottomToBottomOf:wt,startToStartOf:wt,endToEndOf:wt,verticalBias:n.textVerticalBias}}}),wt.addChild(vt)),void 0!==n.imageName){let t;t=new g(void 0!==vt?nt?{imageName:n.imageName,layout:{marginBottom:rt,constraints:{bottomToTopOf:vt,startToStartOf:wt,endToEndOf:wt}}}:{imageName:n.imageName,layout:{marginTop:st,constraints:{topToBottomOf:vt,startToStartOf:wt,endToEndOf:wt}}}:{imageName:n.imageName,layout:{constraints:{topToTopOf:wt,bottomToBottomOf:wt,verticalBias:n.imageVerticalBias,startToStartOf:wt,endToEndOf:wt}}}),wt.addChild(t)}if(s>0){const t=new m({text:Q,fontColor:Ct,backgroundColor:gt,size:{width:Z,height:it},layout:{marginStart:32,marginBottom:80,constraints:{bottomToBottomOf:wt,startToStartOf:wt}}});t.isUserInteractionEnabled=!0,t.onTapDown((()=>{wt.game.presentScene(ft+"-"+(s+1-1).toString().padStart(2,"0"),J)})),wt.addChild(t)}const kt=new m({name:"nextButton",text:Y,fontColor:pt,backgroundColor:mt,size:{width:tt,height:et},layout:{marginEnd:32,marginBottom:80,constraints:{bottomToBottomOf:wt,endToEndOf:wt}}});kt.isUserInteractionEnabled=!0,s!==t.instructionScenes.length-1?kt.onTapDown((()=>{wt.game.presentScene(ft+"-"+(s+1+1).toString().padStart(2,"0"),X)})):void 0!==t.postInstructionsScene?kt.onTapDown((()=>{var i;wt.game.presentScene(null!==(i=t.postInstructionsScene)&&void 0!==i?i:"",X)})):kt.onTapDown((()=>{const t=wt.game.scenes.indexOf(wt);if(-1===t)console.warn("warning: postInstructionsScene is not defined, and next scene cannot be determined.");else{const i=t+1;i<wt.game.scenes.length?wt.game.presentScene(wt.game.scenes[i],X):console.warn("warning: postInstructionsScene is not defined, and there is no next scene to present.")}})),wt.addChild(kt),e.push(wt)})),e}}export{m as Button,f as Dialog,p as DialogResult,C as Grid,b as Instructions};
